<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GPGPU-Sim: GPGPU-Sim/src/cuda-sim/instructions.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_74b709ba7733b83372455c2729542245.html">GPGPU-Sim</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_5c7e919c3bfe381df3c9c7a7ecfd98e8.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1dfabb1e958c498fcef684c7254767aa.html">cuda-sim</a>
  </div>
</div>
<div class="contents">
<h1>instructions.cc</h1><a href="instructions_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright (c) 2009-2011, Tor M. Aamodt, Wilson W.L. Fung, Ali Bakhoda,</span>
<a name="l00002"></a>00002 <span class="comment">// Jimmy Kwa, George L. Yuan</span>
<a name="l00003"></a>00003 <span class="comment">// The University of British Columbia</span>
<a name="l00004"></a>00004 <span class="comment">// All rights reserved.</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">// Redistribution and use in source and binary forms, with or without</span>
<a name="l00007"></a>00007 <span class="comment">// modification, are permitted provided that the following conditions are met:</span>
<a name="l00008"></a>00008 <span class="comment">//</span>
<a name="l00009"></a>00009 <span class="comment">// Redistributions of source code must retain the above copyright notice, this</span>
<a name="l00010"></a>00010 <span class="comment">// list of conditions and the following disclaimer.</span>
<a name="l00011"></a>00011 <span class="comment">// Redistributions in binary form must reproduce the above copyright notice, this</span>
<a name="l00012"></a>00012 <span class="comment">// list of conditions and the following disclaimer in the documentation and/or</span>
<a name="l00013"></a>00013 <span class="comment">// other materials provided with the distribution.</span>
<a name="l00014"></a>00014 <span class="comment">// Neither the name of The University of British Columbia nor the names of its</span>
<a name="l00015"></a>00015 <span class="comment">// contributors may be used to endorse or promote products derived from this</span>
<a name="l00016"></a>00016 <span class="comment">// software without specific prior written permission.</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 <span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND</span>
<a name="l00019"></a>00019 <span class="comment">// ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<a name="l00020"></a>00020 <span class="comment">// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a name="l00021"></a>00021 <span class="comment">// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<a name="l00022"></a>00022 <span class="comment">// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<a name="l00023"></a>00023 <span class="comment">// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<a name="l00024"></a>00024 <span class="comment">// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<a name="l00025"></a>00025 <span class="comment">// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<a name="l00026"></a>00026 <span class="comment">// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00027"></a>00027 <span class="comment">// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;instructions.h&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="ptx__ir_8h.html">ptx_ir.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="opcodes_8h.html">opcodes.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="ptx__sim_8h.html">ptx_sim.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;ptx.tab.h&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;fenv.h&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="cuda-math_8h.html">cuda-math.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;../abstract_hardware_model.h&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="ptx__loader_8h.html">ptx_loader.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="cuda__device__printf_8h.html">cuda_device_printf.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;../gpgpu-sim/gpu-sim.h&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;../gpgpu-sim/shader.h&quot;</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">//Jin: include device runtime for CDP</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="cuda__device__runtime_8h.html">cuda_device_runtime.h</a>&quot;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="keywordtype">unsigned</span> <a class="code" href="classptx__instruction.html#aed9140ee88f9b5c395b5e553f5b8e87e">ptx_instruction::g_num_ptx_inst_uid</a>=0;
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="ptx__ir_8h.html#a976c3d6ef402fc18967535d4bae09134">00051</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="instructions_8cc.html#a1597e561995f7994d795e77bd7b68e3a">g_opcode_string</a>[NUM_OPCODES] = {
<a name="l00052"></a>00052 <span class="preprocessor">#define OP_DEF(OP,FUNC,STR,DST,CLASSIFICATION) STR,</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span><span class="preprocessor">#define OP_W_DEF(OP,FUNC,STR,DST,CLASSIFICATION) STR,</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">#include &quot;opcodes.def&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#undef OP_DEF</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="preprocessor">#undef OP_W_DEF</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>};
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> * pI ) ;
<a name="l00060"></a>00060 <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#a6e3b760edf8ec3a5a7cf73c66d9e8e38">srcOperandModifiers</a>(<a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> opData, <a class="code" href="classoperand__info.html">operand_info</a> opInfo, <a class="code" href="classoperand__info.html">operand_info</a> dstInfo, <span class="keywordtype">unsigned</span> type, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread);
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">sign_extend</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> &amp;data, <span class="keywordtype">unsigned</span> src_size, <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst );
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">00064</a> <span class="keywordtype">void</span> <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">ptx_thread_info::set_reg</a>( <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *reg, <span class="keyword">const</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> &amp;value ) 
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066    assert( reg != NULL );
<a name="l00067"></a>00067    <span class="keywordflow">if</span>( reg-&gt;<a class="code" href="classsymbol.html#a280a3f1e3caffd94b10590dbb4259033">name</a>() == <span class="stringliteral">&quot;_&quot;</span> ) <span class="keywordflow">return</span>;
<a name="l00068"></a>00068    assert( !<a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.empty() );
<a name="l00069"></a>00069    assert( reg-&gt;<a class="code" href="classsymbol.html#ad1dda9c3576f2619d2d931bcbb196bf0">uid</a>() &gt; 0 );
<a name="l00070"></a>00070    <a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back()[ reg ] = value;
<a name="l00071"></a>00071    <span class="keywordflow">if</span> (<a class="code" href="classptx__thread__info.html#a7af792b943167e68b1998c5357ef5fa8">m_enable_debug_trace</a> ) 
<a name="l00072"></a>00072       <a class="code" href="classptx__thread__info.html#a92a60a365575a2b8a1b6bbb4a1a4abe9">m_debug_trace_regs_modified</a>.back()[ reg ] = value;
<a name="l00073"></a>00073    <a class="code" href="classptx__thread__info.html#a3f76361e51600f480b537d20300f534d">m_last_set_operand_value</a> = value;
<a name="l00074"></a>00074 }
<a name="l00075"></a>00075 
<a name="l00076"></a><a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">00076</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">ptx_thread_info::get_reg</a>( <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *reg )
<a name="l00077"></a>00077 {
<a name="l00078"></a>00078    <span class="keyword">static</span> <span class="keywordtype">bool</span> unfound_register_warned = <span class="keyword">false</span>;
<a name="l00079"></a>00079    assert( reg != NULL );
<a name="l00080"></a>00080    assert( !<a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.empty() );
<a name="l00081"></a>00081    reg_map_t::iterator regs_iter = <a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back().find(reg);
<a name="l00082"></a>00082    <span class="keywordflow">if</span> (regs_iter == <a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back().end()) {
<a name="l00083"></a>00083       assert( reg-&gt;<a class="code" href="classsymbol.html#af8da68543a752fdbd25f4b905f2ab6da">type</a>()-&gt;<a class="code" href="classtype__info.html#acf7d3f7834206cc07553246538e409b9">get_key</a>().<a class="code" href="classtype__info__key.html#ae4415cad34f996132770f7ae35cf3817">is_reg</a>() );
<a name="l00084"></a>00084       <span class="keyword">const</span> std::string &amp;name = reg-&gt;<a class="code" href="classsymbol.html#a280a3f1e3caffd94b10590dbb4259033">name</a>();
<a name="l00085"></a>00085       <span class="keywordtype">unsigned</span> call_uid = <a class="code" href="classptx__thread__info.html#aec5a821d24383dd7cf514e3b9439922a">m_callstack</a>.back().m_call_uid;
<a name="l00086"></a>00086       <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> uninit_reg;
<a name="l00087"></a>00087       uninit_reg.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0x0;
<a name="l00088"></a>00088       <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(reg, uninit_reg); <span class="comment">// give it a value since we are going to warn the user anyway</span>
<a name="l00089"></a>00089       std::string file_loc = <a class="code" href="classptx__thread__info.html#a8f0ef7c196d4cb9ea93d444941cb7c2e">get_location</a>();
<a name="l00090"></a>00090       <span class="keywordflow">if</span>( !unfound_register_warned ) {
<a name="l00091"></a>00091           printf(<span class="stringliteral">&quot;GPGPU-Sim PTX: WARNING (%s) ** reading undefined register \&apos;%s\&apos; (cuid:%u). Setting to 0X00000000. This is okay if you are simulating the native ISA&quot;</span>
<a name="l00092"></a>00092                   <span class="stringliteral">&quot;\n&quot;</span>,
<a name="l00093"></a>00093                  file_loc.c_str(), name.c_str(), call_uid );
<a name="l00094"></a>00094           unfound_register_warned = <span class="keyword">true</span>;
<a name="l00095"></a>00095       }
<a name="l00096"></a>00096       regs_iter = <a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back().find(reg);
<a name="l00097"></a>00097    }
<a name="l00098"></a>00098    <span class="keywordflow">if</span> (<a class="code" href="classptx__thread__info.html#a7af792b943167e68b1998c5357ef5fa8">m_enable_debug_trace</a> ) 
<a name="l00099"></a>00099       <a class="code" href="classptx__thread__info.html#a3bd6adc7298d26cb9b78439f6ebe5302">m_debug_trace_regs_read</a>.back()[ reg ] = regs_iter-&gt;second;
<a name="l00100"></a>00100    <span class="keywordflow">return</span> regs_iter-&gt;second;
<a name="l00101"></a>00101 }
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">00103</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">ptx_thread_info::get_operand_value</a>( <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op, <a class="code" href="classoperand__info.html">operand_info</a> dstInfo, <span class="keywordtype">unsigned</span> opType, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread, <span class="keywordtype">int</span> derefFlag )
<a name="l00104"></a>00104 {
<a name="l00105"></a>00105    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> result, tmp;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 
<a name="l00108"></a>00108    <span class="keywordflow">if</span>(op.<a class="code" href="classoperand__info.html#a10b0a76daa24e46ed1c9dbef4f603f71">get_double_operand_type</a>() == 0) {
<a name="l00109"></a>00109       <span class="keywordflow">if</span>(((opType != BB128_TYPE) &amp;&amp; (opType != BB64_TYPE) &amp;&amp; (opType != FF64_TYPE)) || (op.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() != <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca434a5fd1a70c9dcbe2de96e9c602d265">undefined_space</a>)) {
<a name="l00110"></a>00110          <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#ab1bf5df3e02f812b616891f8c2c7bf7f">is_reg</a>() ) {
<a name="l00111"></a>00111             result = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>( op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>() );
<a name="l00112"></a>00112          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#add87cd9257da2ae956ef19258a34cdc9">is_builtin</a>()) {
<a name="l00113"></a>00113             result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = <a class="code" href="classptx__thread__info.html#af1a3c760fe47aa8fce088aef405fadcf">get_builtin</a>( op.<a class="code" href="classoperand__info.html#ab9bb7538ca07cc41165241ec58934347">get_int</a>(), op.<a class="code" href="classoperand__info.html#a890e5792b2ad37850c0872bed89a3663">get_addr_offset</a>() );
<a name="l00114"></a>00114          } <span class="keywordflow">else</span>  <span class="keywordflow">if</span>(op.<a class="code" href="classoperand__info.html#a106a13aa2f58c89100dab20f3319f5fc">is_immediate_address</a>()){
<a name="l00115"></a>00115              result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = op.<a class="code" href="classoperand__info.html#a890e5792b2ad37850c0872bed89a3663">get_addr_offset</a>();
<a name="l00116"></a>00116          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#ae5388f733f2ef7965edbf9ea53d5b592">is_memory_operand</a>() ) {
<a name="l00117"></a>00117             <span class="comment">// a few options here...</span>
<a name="l00118"></a>00118             <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *sym = op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>();
<a name="l00119"></a>00119             <span class="keyword">const</span> <a class="code" href="classtype__info.html">type_info</a> *type = sym-&gt;<a class="code" href="classsymbol.html#af8da68543a752fdbd25f4b905f2ab6da">type</a>();
<a name="l00120"></a>00120             <span class="keyword">const</span> <a class="code" href="classtype__info__key.html">type_info_key</a> &amp;info = type-&gt;<a class="code" href="classtype__info.html#acf7d3f7834206cc07553246538e409b9">get_key</a>();
<a name="l00121"></a>00121 
<a name="l00122"></a>00122             <span class="keywordflow">if</span> ( info.<a class="code" href="classtype__info__key.html#ae4415cad34f996132770f7ae35cf3817">is_reg</a>() ) {
<a name="l00123"></a>00123                <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *name = op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>();
<a name="l00124"></a>00124                result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>(name).<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + op.<a class="code" href="classoperand__info.html#a890e5792b2ad37850c0872bed89a3663">get_addr_offset</a>(); 
<a name="l00125"></a>00125             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( info.<a class="code" href="classtype__info__key.html#ae1879cfd96269bd1ca2a652c92a73225">is_param_kernel</a>() ) {
<a name="l00126"></a>00126                result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = sym-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>() + op.<a class="code" href="classoperand__info.html#a890e5792b2ad37850c0872bed89a3663">get_addr_offset</a>();
<a name="l00127"></a>00127             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( info.<a class="code" href="classtype__info__key.html#aeef019e08057f701723f9a27b6b8e135">is_param_local</a>() ) {
<a name="l00128"></a>00128                result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = sym-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>() + op.<a class="code" href="classoperand__info.html#a890e5792b2ad37850c0872bed89a3663">get_addr_offset</a>();
<a name="l00129"></a>00129             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( info.<a class="code" href="classtype__info__key.html#a0aaf3f4d8ed7e0fbf51ad9a1deca5e7c">is_global</a>() ) {
<a name="l00130"></a>00130                assert( op.<a class="code" href="classoperand__info.html#a890e5792b2ad37850c0872bed89a3663">get_addr_offset</a>() == 0 );
<a name="l00131"></a>00131                result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = sym-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>();
<a name="l00132"></a>00132             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( info.<a class="code" href="classtype__info__key.html#ab7f0dd4b46c19dd2bce2573f486a5c76">is_local</a>() ) {
<a name="l00133"></a>00133                result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = sym-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>() + op.<a class="code" href="classoperand__info.html#a890e5792b2ad37850c0872bed89a3663">get_addr_offset</a>();
<a name="l00134"></a>00134             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( info.<a class="code" href="classtype__info__key.html#a641a0dd9a956e038bcb048dec5bd0aae">is_const</a>() ) {
<a name="l00135"></a>00135                result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = sym-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>() + op.<a class="code" href="classoperand__info.html#a890e5792b2ad37850c0872bed89a3663">get_addr_offset</a>();
<a name="l00136"></a>00136             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#a4c2efaf255d4e69b25fc7f9b973b8243">is_shared</a>() ) {
<a name="l00137"></a>00137                result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>()-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>() + op.<a class="code" href="classoperand__info.html#a890e5792b2ad37850c0872bed89a3663">get_addr_offset</a>();
<a name="l00138"></a>00138             } <span class="keywordflow">else</span> {
<a name="l00139"></a>00139                <span class="keyword">const</span> <span class="keywordtype">char</span> *name = op.<a class="code" href="classoperand__info.html#ae508fadcabd47ef0a361b1120a6e160d">name</a>().c_str();
<a name="l00140"></a>00140                printf(<span class="stringliteral">&quot;GPGPU-Sim PTX: ERROR ** get_operand_value : unknown memory operand type for %s\n&quot;</span>, name );
<a name="l00141"></a>00141                abort();
<a name="l00142"></a>00142             }
<a name="l00143"></a>00143 
<a name="l00144"></a>00144          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#a7f575445d398382185666bc79df440f7">is_literal</a>() ) {
<a name="l00145"></a>00145             result = op.<a class="code" href="classoperand__info.html#ad6527178d27f0b1e5fffb03bf370252c">get_literal_value</a>();
<a name="l00146"></a>00146          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#af32c93100016ff26c728919328ccb2e5">is_label</a>() ) {
<a name="l00147"></a>00147             result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>()-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>();
<a name="l00148"></a>00148          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#a4c2efaf255d4e69b25fc7f9b973b8243">is_shared</a>() ) {
<a name="l00149"></a>00149             result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>()-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>();
<a name="l00150"></a>00150          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#a6ec0c48959263417e592bacdcecff73f">is_const</a>() ) {
<a name="l00151"></a>00151             result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>()-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>();
<a name="l00152"></a>00152          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#a1ea4b5a6d2261ef1ad38da744f935aae">is_global</a>() ) {
<a name="l00153"></a>00153             result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>()-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>();
<a name="l00154"></a>00154          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#a1edb115243f7e64e5705ceab57e11b62">is_local</a>() ) {
<a name="l00155"></a>00155             result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>()-&gt;<a class="code" href="classsymbol.html#a8fc9a6e49bb901608ff0dab49538db09">get_address</a>();
<a name="l00156"></a>00156          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#a9ba168e040e6e7d6df60d616bff10677">is_function_address</a>() ) {
<a name="l00157"></a>00157             result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (size_t)op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>()-&gt;<a class="code" href="classsymbol.html#a66f4cb25e44abd7eddd7cbcfbca52e79">get_pc</a>();
<a name="l00158"></a>00158          } <span class="keywordflow">else</span> {
<a name="l00159"></a>00159             <span class="keyword">const</span> <span class="keywordtype">char</span> *name = op.<a class="code" href="classoperand__info.html#ae508fadcabd47ef0a361b1120a6e160d">name</a>().c_str();
<a name="l00160"></a>00160             printf(<span class="stringliteral">&quot;GPGPU-Sim PTX: ERROR ** get_operand_value : unknown operand type for %s\n&quot;</span>, name );
<a name="l00161"></a>00161             assert(0);
<a name="l00162"></a>00162          }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164          <span class="keywordflow">if</span>(op.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 1) 
<a name="l00165"></a>00165               result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF;
<a name="l00166"></a>00166          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(op.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 2) 
<a name="l00167"></a>00167               result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>&gt;&gt;16) &amp; 0xFFFF;
<a name="l00168"></a>00168       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opType == BB128_TYPE) {
<a name="l00169"></a>00169           <span class="comment">// b128</span>
<a name="l00170"></a>00170           result.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>.<a class="code" href="unionptx__reg__t.html#a7b2206c3a3c314ee849b330ceda021c5">lowest</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>( op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0) ).u32;
<a name="l00171"></a>00171           result.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>.<a class="code" href="unionptx__reg__t.html#ae1809553523a7eb00539f9a3abf775bf">low</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>( op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(1) ).u32;
<a name="l00172"></a>00172           result.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>.<a class="code" href="unionptx__reg__t.html#a4ef84ffc330a985ce8a4bd03802fa9c6">high</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>( op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(2) ).u32;
<a name="l00173"></a>00173           result.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>.<a class="code" href="unionptx__reg__t.html#a61d63c09f8a7e90e78b48718b199a350">highest</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>( op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(3) ).u32;
<a name="l00174"></a>00174       } <span class="keywordflow">else</span> {
<a name="l00175"></a>00175           <span class="comment">// bb64 or ff64</span>
<a name="l00176"></a>00176           result.<a class="code" href="unionptx__reg__t.html#af089e38a2f4127927c4c74045cff17ce">bits</a>.<a class="code" href="unionptx__reg__t.html#a002210a20977ffb5cb64ff84efaff199">ls</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>( op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0) ).u32;
<a name="l00177"></a>00177           result.<a class="code" href="unionptx__reg__t.html#af089e38a2f4127927c4c74045cff17ce">bits</a>.<a class="code" href="unionptx__reg__t.html#ae211f9013ffa254a2786d23ee4b330b9">ms</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>( op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(1) ).u32;
<a name="l00178"></a>00178       }
<a name="l00179"></a>00179    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (op.<a class="code" href="classoperand__info.html#a10b0a76daa24e46ed1c9dbef4f603f71">get_double_operand_type</a>() == 1) {
<a name="l00180"></a>00180       <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> firstHalf, secondHalf;
<a name="l00181"></a>00181       firstHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>( op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0) ).u64;
<a name="l00182"></a>00182       secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>( op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(1) ).u64;
<a name="l00183"></a>00183       <span class="keywordflow">if</span>(op.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 1)
<a name="l00184"></a>00184            secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF;
<a name="l00185"></a>00185       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(op.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 2)
<a name="l00186"></a>00186            secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>&gt;&gt;16) &amp; 0xFFFF;
<a name="l00187"></a>00187       result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = firstHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l00188"></a>00188    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (op.<a class="code" href="classoperand__info.html#a10b0a76daa24e46ed1c9dbef4f603f71">get_double_operand_type</a>() == 2) {
<a name="l00189"></a>00189       <span class="comment">// s[reg1 += reg2]</span>
<a name="l00190"></a>00190       <span class="comment">// reg1 is incremented after value is returned: the value returned is s[reg1]</span>
<a name="l00191"></a>00191       <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> firstHalf, secondHalf;
<a name="l00192"></a>00192       firstHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>(op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0)).u64;
<a name="l00193"></a>00193       secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>(op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(1)).u64;
<a name="l00194"></a>00194       <span class="keywordflow">if</span>(op.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 1)
<a name="l00195"></a>00195            secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF;
<a name="l00196"></a>00196       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(op.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 2)
<a name="l00197"></a>00197            secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>&gt;&gt;16) &amp; 0xFFFF;
<a name="l00198"></a>00198       result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = firstHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l00199"></a>00199       firstHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = firstHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + secondHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l00200"></a>00200       <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0),firstHalf);
<a name="l00201"></a>00201    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (op.<a class="code" href="classoperand__info.html#a10b0a76daa24e46ed1c9dbef4f603f71">get_double_operand_type</a>() == 3) {
<a name="l00202"></a>00202       <span class="comment">// s[reg += immediate]</span>
<a name="l00203"></a>00203       <span class="comment">// reg is incremented after value is returned: the value returned is s[reg]</span>
<a name="l00204"></a>00204       <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> firstHalf;
<a name="l00205"></a>00205       firstHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = <a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>(op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>()).u64;
<a name="l00206"></a>00206       result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = firstHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l00207"></a>00207       firstHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = firstHalf.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + op.<a class="code" href="classoperand__info.html#a890e5792b2ad37850c0872bed89a3663">get_addr_offset</a>();
<a name="l00208"></a>00208       <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>(),firstHalf);
<a name="l00209"></a>00209    }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> finalResult;
<a name="l00212"></a>00212    <a class="code" href="classmemory__space.html">memory_space</a> *mem = NULL;
<a name="l00213"></a>00213    <span class="keywordtype">size_t</span> size=0;
<a name="l00214"></a>00214    <span class="keywordtype">int</span> t=0;
<a name="l00215"></a>00215    finalResult.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>=0;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217    <span class="comment">//complete other cases for reading from memory, such as reading from other const memory</span>
<a name="l00218"></a>00218    <span class="keywordflow">if</span>((op.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>)&amp;&amp;(derefFlag)) {
<a name="l00219"></a>00219        <span class="comment">// global memory - g[4], g[$r0]</span>
<a name="l00220"></a>00220        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab2b214414769f3a7422e2e7a1642bf74">get_global_memory</a>();
<a name="l00221"></a>00221        <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(opType,size,t);
<a name="l00222"></a>00222        mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,size/8,&amp;finalResult.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>);
<a name="l00223"></a>00223        thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l00224"></a>00224        thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226        <span class="keywordflow">if</span>( opType == S16_TYPE || opType == S32_TYPE )
<a name="l00227"></a>00227          <a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">sign_extend</a>(finalResult,size,dstInfo);
<a name="l00228"></a>00228    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>((op.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>)&amp;&amp;(derefFlag)) {
<a name="l00229"></a>00229       <span class="comment">// shared memory - s[4], s[$r0]</span>
<a name="l00230"></a>00230        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a7c4af02df5c97e1e2d89f2475bf8df8f">m_shared_mem</a>;
<a name="l00231"></a>00231        <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(opType,size,t);
<a name="l00232"></a>00232        mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,size/8,&amp;finalResult.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>);
<a name="l00233"></a>00233        thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l00234"></a>00234        thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236        <span class="keywordflow">if</span>( opType == S16_TYPE || opType == S32_TYPE ) 
<a name="l00237"></a>00237          <a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">sign_extend</a>(finalResult,size,dstInfo);
<a name="l00238"></a>00238    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>((op.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca445236c52ac314c07392ad430f155071">const_space</a>)&amp;&amp;(derefFlag)) {
<a name="l00239"></a>00239       <span class="comment">// const memory - ce0c1[4], ce0c1[$r0]</span>
<a name="l00240"></a>00240        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab2b214414769f3a7422e2e7a1642bf74">get_global_memory</a>();
<a name="l00241"></a>00241        <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(opType,size,t);
<a name="l00242"></a>00242        mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>((result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + op.<a class="code" href="classoperand__info.html#ab0ba78d0b43f839d41a6081ee897d171">get_const_mem_offset</a>()),size/8,&amp;finalResult.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>);
<a name="l00243"></a>00243        thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l00244"></a>00244        thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca445236c52ac314c07392ad430f155071">const_space</a>;
<a name="l00245"></a>00245        <span class="keywordflow">if</span>( opType == S16_TYPE || opType == S32_TYPE )
<a name="l00246"></a>00246          <a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">sign_extend</a>(finalResult,size,dstInfo);
<a name="l00247"></a>00247    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>((op.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca133ba819812b7d97221aed15cb830967">local_space</a>)&amp;&amp;(derefFlag)) {
<a name="l00248"></a>00248       <span class="comment">// local memory - l0[4], l0[$r0]</span>
<a name="l00249"></a>00249        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a22296d84ac37c6861d88a24761506e2e">m_local_mem</a>;
<a name="l00250"></a>00250        <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(opType,size,t);
<a name="l00251"></a>00251        mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,size/8,&amp;finalResult.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>);
<a name="l00252"></a>00252        thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l00253"></a>00253        thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca133ba819812b7d97221aed15cb830967">local_space</a>;
<a name="l00254"></a>00254        <span class="keywordflow">if</span>( opType == S16_TYPE || opType == S32_TYPE ) 
<a name="l00255"></a>00255          <a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">sign_extend</a>(finalResult,size,dstInfo);
<a name="l00256"></a>00256    } <span class="keywordflow">else</span> {
<a name="l00257"></a>00257        finalResult = result;
<a name="l00258"></a>00258    }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260    <span class="keywordflow">if</span>((op.<a class="code" href="classoperand__info.html#a11558a2e5432782a641096c3d7fcb68a">get_operand_neg</a>() == <span class="keyword">true</span>)&amp;&amp;(derefFlag)) {
<a name="l00261"></a>00261       <span class="keywordflow">switch</span>( opType ) {
<a name="l00262"></a>00262       <span class="comment">// Default to f32 for now, need to add support for others</span>
<a name="l00263"></a>00263       <span class="keywordflow">case</span> S8_TYPE:
<a name="l00264"></a>00264       <span class="keywordflow">case</span> U8_TYPE:
<a name="l00265"></a>00265       <span class="keywordflow">case</span> B8_TYPE:
<a name="l00266"></a>00266          finalResult.<a class="code" href="unionptx__reg__t.html#aeb61f4c697e957e4716283c63de5a149">s8</a> = -finalResult.<a class="code" href="unionptx__reg__t.html#aeb61f4c697e957e4716283c63de5a149">s8</a>;
<a name="l00267"></a>00267          <span class="keywordflow">break</span>;
<a name="l00268"></a>00268       <span class="keywordflow">case</span> S16_TYPE:
<a name="l00269"></a>00269       <span class="keywordflow">case</span> U16_TYPE:
<a name="l00270"></a>00270       <span class="keywordflow">case</span> B16_TYPE:
<a name="l00271"></a>00271          finalResult.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = -finalResult.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>;
<a name="l00272"></a>00272          <span class="keywordflow">break</span>;
<a name="l00273"></a>00273       <span class="keywordflow">case</span> S32_TYPE:
<a name="l00274"></a>00274       <span class="keywordflow">case</span> U32_TYPE:
<a name="l00275"></a>00275       <span class="keywordflow">case</span> B32_TYPE:
<a name="l00276"></a>00276          finalResult.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = -finalResult.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l00277"></a>00277          <span class="keywordflow">break</span>;
<a name="l00278"></a>00278       <span class="keywordflow">case</span> S64_TYPE:
<a name="l00279"></a>00279       <span class="keywordflow">case</span> U64_TYPE:
<a name="l00280"></a>00280       <span class="keywordflow">case</span> B64_TYPE:
<a name="l00281"></a>00281          finalResult.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = -finalResult.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>;
<a name="l00282"></a>00282          <span class="keywordflow">break</span>;
<a name="l00283"></a>00283       <span class="keywordflow">case</span> F16_TYPE:
<a name="l00284"></a>00284          finalResult.<a class="code" href="unionptx__reg__t.html#a0b71ba26b727ecfad58b8b7a7b87b90f">f16</a> = -finalResult.<a class="code" href="unionptx__reg__t.html#a0b71ba26b727ecfad58b8b7a7b87b90f">f16</a>;
<a name="l00285"></a>00285          <span class="keywordflow">break</span>;
<a name="l00286"></a>00286       <span class="keywordflow">case</span> F32_TYPE:
<a name="l00287"></a>00287          finalResult.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = -finalResult.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>;
<a name="l00288"></a>00288          <span class="keywordflow">break</span>;
<a name="l00289"></a>00289       <span class="keywordflow">case</span> F64_TYPE:
<a name="l00290"></a>00290       <span class="keywordflow">case</span> FF64_TYPE:
<a name="l00291"></a>00291          finalResult.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = -finalResult.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>;
<a name="l00292"></a>00292          <span class="keywordflow">break</span>;
<a name="l00293"></a>00293       <span class="keywordflow">default</span>:
<a name="l00294"></a>00294          assert(0);
<a name="l00295"></a>00295       }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297    }
<a name="l00298"></a>00298 
<a name="l00299"></a>00299    <span class="keywordflow">return</span> finalResult;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 
<a name="l00303"></a><a class="code" href="instructions_8cc.html#a163d30f9ef2e7e63823553a957e87d0c">00303</a> <span class="keywordtype">unsigned</span> <a class="code" href="instructions_8cc.html#a163d30f9ef2e7e63823553a957e87d0c">get_operand_nbits</a>( <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op )
<a name="l00304"></a>00304 {
<a name="l00305"></a>00305    <span class="keywordflow">if</span> ( op.<a class="code" href="classoperand__info.html#ab1bf5df3e02f812b616891f8c2c7bf7f">is_reg</a>() ) {
<a name="l00306"></a>00306       <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *sym = op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>();
<a name="l00307"></a>00307       <span class="keyword">const</span> <a class="code" href="classtype__info.html">type_info</a> *typ = sym-&gt;<a class="code" href="classsymbol.html#af8da68543a752fdbd25f4b905f2ab6da">type</a>();
<a name="l00308"></a>00308       <a class="code" href="classtype__info__key.html">type_info_key</a> t = typ-&gt;<a class="code" href="classtype__info.html#acf7d3f7834206cc07553246538e409b9">get_key</a>();
<a name="l00309"></a>00309       <span class="keywordflow">switch</span>( t.<a class="code" href="classtype__info__key.html#a33c88d79d5b6bb80356603bb031f9ceb">scalar_type</a>() ) {
<a name="l00310"></a>00310       <span class="keywordflow">case</span> PRED_TYPE: 
<a name="l00311"></a>00311          <span class="keywordflow">return</span> 1;
<a name="l00312"></a>00312       <span class="keywordflow">case</span> B8_TYPE: <span class="keywordflow">case</span> S8_TYPE: <span class="keywordflow">case</span> U8_TYPE:
<a name="l00313"></a>00313          <span class="keywordflow">return</span> 8;
<a name="l00314"></a>00314       <span class="keywordflow">case</span> S16_TYPE: <span class="keywordflow">case</span> U16_TYPE: <span class="keywordflow">case</span> F16_TYPE: <span class="keywordflow">case</span> B16_TYPE:
<a name="l00315"></a>00315          <span class="keywordflow">return</span> 16;
<a name="l00316"></a>00316       <span class="keywordflow">case</span> S32_TYPE: <span class="keywordflow">case</span> U32_TYPE: <span class="keywordflow">case</span> F32_TYPE: <span class="keywordflow">case</span> B32_TYPE:
<a name="l00317"></a>00317          <span class="keywordflow">return</span> 32;
<a name="l00318"></a>00318       <span class="keywordflow">case</span> S64_TYPE: <span class="keywordflow">case</span> U64_TYPE: <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> B64_TYPE:
<a name="l00319"></a>00319          <span class="keywordflow">return</span> 64;
<a name="l00320"></a>00320       <span class="keywordflow">default</span>:
<a name="l00321"></a>00321          printf(<span class="stringliteral">&quot;ERROR: unknown register type\n&quot;</span>);
<a name="l00322"></a>00322          fflush(stdout);
<a name="l00323"></a>00323          abort();
<a name="l00324"></a>00324       }
<a name="l00325"></a>00325    } <span class="keywordflow">else</span> {
<a name="l00326"></a>00326       printf(<span class="stringliteral">&quot;ERROR: Need to implement get_operand_nbits() for currently unsupported operand_info type\n&quot;</span>);
<a name="l00327"></a>00327       fflush(stdout);
<a name="l00328"></a>00328       abort();
<a name="l00329"></a>00329    }
<a name="l00330"></a>00330 
<a name="l00331"></a>00331    <span class="keywordflow">return</span> 0;
<a name="l00332"></a>00332 }
<a name="l00333"></a>00333 
<a name="l00334"></a><a class="code" href="classptx__thread__info.html#a4e9d2673a65c55339ae395075cdba6cd">00334</a> <span class="keywordtype">void</span> <a class="code" href="classptx__thread__info.html#a4e9d2673a65c55339ae395075cdba6cd">ptx_thread_info::get_vector_operand_values</a>( <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op, <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>* ptx_regs, <span class="keywordtype">unsigned</span> num_elements )
<a name="l00335"></a>00335 {
<a name="l00336"></a>00336    assert( op.<a class="code" href="classoperand__info.html#a2d9731133be1063f65d792099473e426">is_vector</a>() );
<a name="l00337"></a>00337    assert( num_elements &lt;= 4 ); <span class="comment">// max 4 elements in a vector</span>
<a name="l00338"></a>00338 
<a name="l00339"></a>00339    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = num_elements - 1; idx &gt;= 0; --idx) {
<a name="l00340"></a>00340       <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *sym = NULL;
<a name="l00341"></a>00341       sym = op.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(idx);
<a name="l00342"></a>00342       <span class="keywordflow">if</span>( strcmp(sym-&gt;<a class="code" href="classsymbol.html#a280a3f1e3caffd94b10590dbb4259033">name</a>().c_str(),<span class="stringliteral">&quot;_&quot;</span>) != 0) {
<a name="l00343"></a>00343          reg_map_t::iterator reg_iter = <a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back().find(sym);
<a name="l00344"></a>00344          assert( reg_iter != <a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back().end() );
<a name="l00345"></a>00345          ptx_regs[idx] = reg_iter-&gt;second;
<a name="l00346"></a>00346       }
<a name="l00347"></a>00347    }
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a><a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">00350</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">sign_extend</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> &amp;data, <span class="keywordtype">unsigned</span> src_size, <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst )
<a name="l00351"></a>00351 {
<a name="l00352"></a>00352    <span class="keywordflow">if</span>( !dst.<a class="code" href="classoperand__info.html#ab1bf5df3e02f812b616891f8c2c7bf7f">is_reg</a>() )
<a name="l00353"></a>00353       <span class="keywordflow">return</span>;
<a name="l00354"></a>00354    <span class="keywordtype">unsigned</span> dst_size = <a class="code" href="instructions_8cc.html#a163d30f9ef2e7e63823553a957e87d0c">get_operand_nbits</a>( dst );
<a name="l00355"></a>00355    <span class="keywordflow">if</span>( src_size &gt;= dst_size ) 
<a name="l00356"></a>00356       <span class="keywordflow">return</span>;
<a name="l00357"></a>00357    <span class="comment">// src_size &lt; dst_size</span>
<a name="l00358"></a>00358    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> mask = 1;
<a name="l00359"></a>00359    mask &lt;&lt;= (src_size-1);
<a name="l00360"></a>00360    <span class="keywordflow">if</span>( (mask &amp; data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>) == 0 ) {
<a name="l00361"></a>00361       <span class="comment">// no need to sign extend</span>
<a name="l00362"></a>00362       <span class="keywordflow">return</span>;
<a name="l00363"></a>00363    }
<a name="l00364"></a>00364    <span class="comment">// need to sign extend</span>
<a name="l00365"></a>00365    mask = 1;
<a name="l00366"></a>00366    mask &lt;&lt;= dst_size-src_size;
<a name="l00367"></a>00367    mask -= 1;
<a name="l00368"></a>00368    mask &lt;&lt;= src_size;
<a name="l00369"></a>00369    data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= mask;
<a name="l00370"></a>00370 }
<a name="l00371"></a>00371 
<a name="l00372"></a><a class="code" href="classptx__thread__info.html#abd8bf0f647c883457c57195e9c0e968b">00372</a> <span class="keywordtype">void</span> <a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">ptx_thread_info::set_operand_value</a>( <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst, <span class="keyword">const</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> &amp;data, <span class="keywordtype">unsigned</span> type, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread, <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <span class="keywordtype">int</span> overflow, <span class="keywordtype">int</span> carry )
<a name="l00373"></a>00373 {
<a name="l00374"></a>00374     thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>( dst, data, type, thread, pI );
<a name="l00375"></a>00375 
<a name="l00376"></a>00376     <span class="keywordflow">if</span> (dst.<a class="code" href="classoperand__info.html#a10b0a76daa24e46ed1c9dbef4f603f71">get_double_operand_type</a>() == -2)
<a name="l00377"></a>00377     {
<a name="l00378"></a>00378         <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> predValue;
<a name="l00379"></a>00379         
<a name="l00380"></a>00380         <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *sym = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0);
<a name="l00381"></a>00381         predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (<a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back()[ sym ].u64) &amp; ~(0x0C);
<a name="l00382"></a>00382         predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= ((overflow &amp; 0x01)&lt;&lt;3);
<a name="l00383"></a>00383         predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= ((carry &amp; 0x01)&lt;&lt;2);
<a name="l00384"></a>00384 
<a name="l00385"></a>00385         <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(sym,predValue);
<a name="l00386"></a>00386     }
<a name="l00387"></a>00387     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dst.<a class="code" href="classoperand__info.html#a10b0a76daa24e46ed1c9dbef4f603f71">get_double_operand_type</a>() == 0)
<a name="l00388"></a>00388     {
<a name="l00389"></a>00389         <span class="comment">//intentionally do nothing</span>
<a name="l00390"></a>00390     }
<a name="l00391"></a>00391     <span class="keywordflow">else</span>
<a name="l00392"></a>00392     {
<a name="l00393"></a>00393         printf(<span class="stringliteral">&quot;Unexpected double destination\n&quot;</span>);
<a name="l00394"></a>00394         assert(0);
<a name="l00395"></a>00395     }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 }
<a name="l00398"></a>00398 
<a name="l00399"></a><a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">00399</a> <span class="keywordtype">void</span> <a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">ptx_thread_info::set_operand_value</a>( <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst, <span class="keyword">const</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> &amp;data, <span class="keywordtype">unsigned</span> type, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread, <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI )
<a name="l00400"></a>00400 {
<a name="l00401"></a>00401    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> dstData;
<a name="l00402"></a>00402    <a class="code" href="classmemory__space.html">memory_space</a> *mem = NULL;
<a name="l00403"></a>00403    <span class="keywordtype">size_t</span> size;
<a name="l00404"></a>00404    <span class="keywordtype">int</span> t;
<a name="l00405"></a>00405 
<a name="l00406"></a>00406    <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(type,size,t);
<a name="l00407"></a>00407 
<a name="l00408"></a>00408    <span class="comment">/*complete this section for other cases*/</span>
<a name="l00409"></a>00409    <span class="keywordflow">if</span>(dst.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca434a5fd1a70c9dcbe2de96e9c602d265">undefined_space</a>)
<a name="l00410"></a>00410    {
<a name="l00411"></a>00411       <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> setValue;
<a name="l00412"></a>00412       setValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l00413"></a>00413 
<a name="l00414"></a>00414       <span class="comment">// Double destination in set instruction ($p0|$p1) - second is negation of first</span>
<a name="l00415"></a>00415       <span class="keywordflow">if</span> (dst.<a class="code" href="classoperand__info.html#a10b0a76daa24e46ed1c9dbef4f603f71">get_double_operand_type</a>() == -1)
<a name="l00416"></a>00416       {
<a name="l00417"></a>00417           <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> setValue2;
<a name="l00418"></a>00418           <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *name1 = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0);
<a name="l00419"></a>00419           <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *name2 = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(1);
<a name="l00420"></a>00420 
<a name="l00421"></a>00421           <span class="keywordflow">if</span> ( (type==F16_TYPE)||(type==F32_TYPE)||(type==F64_TYPE)||(type==FF64_TYPE) ) {
<a name="l00422"></a>00422              setValue2.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = (setValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>==0)?1.0f:0.0f;
<a name="l00423"></a>00423           } <span class="keywordflow">else</span> {
<a name="l00424"></a>00424              setValue2.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = (setValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>==0)?0xFFFFFFFF:0;
<a name="l00425"></a>00425           }
<a name="l00426"></a>00426 
<a name="l00427"></a>00427           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(name1,setValue);
<a name="l00428"></a>00428           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(name2,setValue2);
<a name="l00429"></a>00429       }
<a name="l00430"></a>00430 
<a name="l00431"></a>00431       <span class="comment">// Double destination in cvt,shr,mul,etc. instruction ($p0|$r4) - second register operand receives data, first predicate operand</span>
<a name="l00432"></a>00432       <span class="comment">// is set as $p0=($r4!=0)</span>
<a name="l00433"></a>00433       <span class="comment">// Also for Double destination in set instruction ($p0/$r1)</span>
<a name="l00434"></a>00434       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((dst.<a class="code" href="classoperand__info.html#a10b0a76daa24e46ed1c9dbef4f603f71">get_double_operand_type</a>() == -2)||(dst.<a class="code" href="classoperand__info.html#a10b0a76daa24e46ed1c9dbef4f603f71">get_double_operand_type</a>() == -3))
<a name="l00435"></a>00435       {
<a name="l00436"></a>00436           <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> predValue;
<a name="l00437"></a>00437           <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *predName = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0);
<a name="l00438"></a>00438           <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *regName = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(1);
<a name="l00439"></a>00439           predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l00440"></a>00440 
<a name="l00441"></a>00441           <span class="keywordflow">switch</span> ( type ) {
<a name="l00442"></a>00442           <span class="keywordflow">case</span> S8_TYPE:
<a name="l00443"></a>00443               <span class="keywordflow">if</span>((setValue.<a class="code" href="unionptx__reg__t.html#aeb61f4c697e957e4716283c63de5a149">s8</a> &amp; 0x7F) == 0)
<a name="l00444"></a>00444                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00445"></a>00445               <span class="keywordflow">break</span>;
<a name="l00446"></a>00446           <span class="keywordflow">case</span> S16_TYPE:
<a name="l00447"></a>00447               <span class="keywordflow">if</span>((setValue.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> &amp; 0x7FFF) == 0)
<a name="l00448"></a>00448                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00449"></a>00449               <span class="keywordflow">break</span>;
<a name="l00450"></a>00450           <span class="keywordflow">case</span> S32_TYPE:
<a name="l00451"></a>00451               <span class="keywordflow">if</span>((setValue.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &amp; 0x7FFFFFFF) == 0)
<a name="l00452"></a>00452                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00453"></a>00453               <span class="keywordflow">break</span>;
<a name="l00454"></a>00454           <span class="keywordflow">case</span> S64_TYPE:
<a name="l00455"></a>00455               <span class="keywordflow">if</span>((setValue.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x7FFFFFFFFFFFFFFF) == 0)
<a name="l00456"></a>00456                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00457"></a>00457               <span class="keywordflow">break</span>;
<a name="l00458"></a>00458           <span class="keywordflow">case</span> U8_TYPE:
<a name="l00459"></a>00459           <span class="keywordflow">case</span> B8_TYPE:
<a name="l00460"></a>00460               <span class="keywordflow">if</span>(setValue.<a class="code" href="unionptx__reg__t.html#ae370e49ce48a8795e1214b80f807f03e">u8</a> == 0)
<a name="l00461"></a>00461                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00462"></a>00462               <span class="keywordflow">break</span>;
<a name="l00463"></a>00463           <span class="keywordflow">case</span> U16_TYPE:
<a name="l00464"></a>00464           <span class="keywordflow">case</span> B16_TYPE:
<a name="l00465"></a>00465               <span class="keywordflow">if</span>(setValue.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> == 0)
<a name="l00466"></a>00466                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00467"></a>00467               <span class="keywordflow">break</span>;
<a name="l00468"></a>00468           <span class="keywordflow">case</span> U32_TYPE:
<a name="l00469"></a>00469           <span class="keywordflow">case</span> B32_TYPE:
<a name="l00470"></a>00470               <span class="keywordflow">if</span>(setValue.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> == 0)
<a name="l00471"></a>00471                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00472"></a>00472               <span class="keywordflow">break</span>;
<a name="l00473"></a>00473           <span class="keywordflow">case</span> U64_TYPE:
<a name="l00474"></a>00474           <span class="keywordflow">case</span> B64_TYPE:
<a name="l00475"></a>00475               <span class="keywordflow">if</span>(setValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> == 0)
<a name="l00476"></a>00476                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00477"></a>00477               <span class="keywordflow">break</span>;
<a name="l00478"></a>00478           <span class="keywordflow">case</span> F16_TYPE:
<a name="l00479"></a>00479               <span class="keywordflow">if</span>(setValue.<a class="code" href="unionptx__reg__t.html#a0b71ba26b727ecfad58b8b7a7b87b90f">f16</a> == 0)
<a name="l00480"></a>00480                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00481"></a>00481               <span class="keywordflow">break</span>;
<a name="l00482"></a>00482           <span class="keywordflow">case</span> F32_TYPE:
<a name="l00483"></a>00483               <span class="keywordflow">if</span>(setValue.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> == 0)
<a name="l00484"></a>00484                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00485"></a>00485               <span class="keywordflow">break</span>;
<a name="l00486"></a>00486           <span class="keywordflow">case</span> F64_TYPE:
<a name="l00487"></a>00487           <span class="keywordflow">case</span> FF64_TYPE:
<a name="l00488"></a>00488               <span class="keywordflow">if</span>(setValue.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> == 0)
<a name="l00489"></a>00489                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1;
<a name="l00490"></a>00490               <span class="keywordflow">break</span>;
<a name="l00491"></a>00491           <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l00492"></a>00492           }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 
<a name="l00495"></a>00495           <span class="keywordflow">if</span> ( (type==S8_TYPE)||(type==S16_TYPE)||(type==S32_TYPE)||(type==S64_TYPE)||
<a name="l00496"></a>00496                (type==U8_TYPE)||(type==U16_TYPE)||(type==U32_TYPE)||(type==U64_TYPE)||
<a name="l00497"></a>00497                (type==B8_TYPE)||(type==B16_TYPE)||(type==B32_TYPE)||(type==B64_TYPE)) {
<a name="l00498"></a>00498               <span class="keywordflow">if</span>((setValue.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; (1&lt;&lt;(size-1))) != 0)
<a name="l00499"></a>00499                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1&lt;&lt;1;
<a name="l00500"></a>00500           }
<a name="l00501"></a>00501           <span class="keywordflow">if</span> ( type==F32_TYPE ) {
<a name="l00502"></a>00502               <span class="keywordflow">if</span>(setValue.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt; 0)
<a name="l00503"></a>00503                   predValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= 1&lt;&lt;1;
<a name="l00504"></a>00504           }
<a name="l00505"></a>00505 
<a name="l00506"></a>00506           <span class="keywordflow">if</span>(dst.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 1)
<a name="l00507"></a>00507           {
<a name="l00508"></a>00508               setValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = ((<a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back()[ regName ].u64) &amp; (~(0xFFFF))) + (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF);
<a name="l00509"></a>00509           }
<a name="l00510"></a>00510           <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dst.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 2)
<a name="l00511"></a>00511           {
<a name="l00512"></a>00512               setValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = ((<a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back()[ regName ].u64) &amp; (~(0xFFFF0000))) + ((data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>&lt;&lt;16) &amp; 0xFFFF0000);
<a name="l00513"></a>00513           }
<a name="l00514"></a>00514 
<a name="l00515"></a>00515           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(predName,predValue);
<a name="l00516"></a>00516           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(regName,setValue);
<a name="l00517"></a>00517       }
<a name="l00518"></a>00518       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == BB128_TYPE)
<a name="l00519"></a>00519       {
<a name="l00520"></a>00520           <span class="comment">//b128 stuff here.</span>
<a name="l00521"></a>00521           <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> setValue2, setValue3, setValue4;
<a name="l00522"></a>00522           setValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l00523"></a>00523           setValue2.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l00524"></a>00524           setValue3.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l00525"></a>00525           setValue4.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l00526"></a>00526           setValue.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>.<a class="code" href="unionptx__reg__t.html#a7b2206c3a3c314ee849b330ceda021c5">lowest</a>;
<a name="l00527"></a>00527           setValue2.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>.<a class="code" href="unionptx__reg__t.html#ae1809553523a7eb00539f9a3abf775bf">low</a>;
<a name="l00528"></a>00528           setValue3.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>.<a class="code" href="unionptx__reg__t.html#a4ef84ffc330a985ce8a4bd03802fa9c6">high</a>;
<a name="l00529"></a>00529           setValue4.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>.<a class="code" href="unionptx__reg__t.html#a61d63c09f8a7e90e78b48718b199a350">highest</a>;
<a name="l00530"></a>00530 
<a name="l00531"></a>00531           <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *name1, *name2, *name3, *name4 = NULL;
<a name="l00532"></a>00532 
<a name="l00533"></a>00533           name1 = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0);
<a name="l00534"></a>00534           name2 = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(1);
<a name="l00535"></a>00535           name3 = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(2);
<a name="l00536"></a>00536           name4 = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(3);
<a name="l00537"></a>00537 
<a name="l00538"></a>00538           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(name1,setValue);
<a name="l00539"></a>00539           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(name2,setValue2);
<a name="l00540"></a>00540           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(name3,setValue3);
<a name="l00541"></a>00541           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(name4,setValue4);
<a name="l00542"></a>00542       }
<a name="l00543"></a>00543       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == BB64_TYPE || type == FF64_TYPE)
<a name="l00544"></a>00544       {
<a name="l00545"></a>00545           <span class="comment">//ptxplus version of storing 64 bit values to registers stores to two adjacent registers</span>
<a name="l00546"></a>00546           <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> setValue2;
<a name="l00547"></a>00547           setValue.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0;
<a name="l00548"></a>00548           setValue2.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0;
<a name="l00549"></a>00549 
<a name="l00550"></a>00550           setValue.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#af089e38a2f4127927c4c74045cff17ce">bits</a>.<a class="code" href="unionptx__reg__t.html#a002210a20977ffb5cb64ff84efaff199">ls</a>;
<a name="l00551"></a>00551           setValue2.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#af089e38a2f4127927c4c74045cff17ce">bits</a>.<a class="code" href="unionptx__reg__t.html#ae211f9013ffa254a2786d23ee4b330b9">ms</a>;
<a name="l00552"></a>00552 
<a name="l00553"></a>00553           <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *name1, *name2 = NULL;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555           name1 = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0);
<a name="l00556"></a>00556           name2 = dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(1);
<a name="l00557"></a>00557 
<a name="l00558"></a>00558           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(name1,setValue);
<a name="l00559"></a>00559           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(name2,setValue2);
<a name="l00560"></a>00560       }
<a name="l00561"></a>00561       <span class="keywordflow">else</span>
<a name="l00562"></a>00562       {
<a name="l00563"></a>00563           <span class="keywordflow">if</span>(dst.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 1)
<a name="l00564"></a>00564           {
<a name="l00565"></a>00565               setValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = ((<a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back()[ dst.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>() ].u64) &amp; (~(0xFFFF))) + (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF);
<a name="l00566"></a>00566           }
<a name="l00567"></a>00567           <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dst.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 2)
<a name="l00568"></a>00568           {
<a name="l00569"></a>00569               setValue.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = ((<a class="code" href="classptx__thread__info.html#a6acc53b694455fe368e14e1d3009f251">m_regs</a>.back()[ dst.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>() ].u64) &amp; (~(0xFFFF0000))) + ((data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>&lt;&lt;16) &amp; 0xFFFF0000);
<a name="l00570"></a>00570           }
<a name="l00571"></a>00571           <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(dst.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>(),setValue);
<a name="l00572"></a>00572       }
<a name="l00573"></a>00573    }
<a name="l00574"></a>00574 
<a name="l00575"></a>00575    <span class="comment">// global memory - g[4], g[$r0]</span>
<a name="l00576"></a>00576    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dst.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>)
<a name="l00577"></a>00577    {
<a name="l00578"></a>00578        dstData = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(dst, dst, type, thread, 0);
<a name="l00579"></a>00579        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab2b214414769f3a7422e2e7a1642bf74">get_global_memory</a>();
<a name="l00580"></a>00580        <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(type,size,t);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582        mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(dstData.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,size/8,&amp;data.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>,thread,pI);
<a name="l00583"></a>00583        thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = dstData.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l00584"></a>00584        thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>;
<a name="l00585"></a>00585    }
<a name="l00586"></a>00586 
<a name="l00587"></a>00587    <span class="comment">// shared memory - s[4], s[$r0]</span>
<a name="l00588"></a>00588    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dst.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>)
<a name="l00589"></a>00589    {
<a name="l00590"></a>00590        dstData = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(dst, dst, type, thread, 0);
<a name="l00591"></a>00591        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a7c4af02df5c97e1e2d89f2475bf8df8f">m_shared_mem</a>;
<a name="l00592"></a>00592        <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(type,size,t);
<a name="l00593"></a>00593 
<a name="l00594"></a>00594        mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(dstData.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,size/8,&amp;data.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>,thread,pI);
<a name="l00595"></a>00595        thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = dstData.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l00596"></a>00596        thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>;
<a name="l00597"></a>00597    }
<a name="l00598"></a>00598 
<a name="l00599"></a>00599    <span class="comment">// local memory - l0[4], l0[$r0]</span>
<a name="l00600"></a>00600    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dst.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca133ba819812b7d97221aed15cb830967">local_space</a>)
<a name="l00601"></a>00601    {
<a name="l00602"></a>00602        dstData = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(dst, dst, type, thread, 0);
<a name="l00603"></a>00603        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a22296d84ac37c6861d88a24761506e2e">m_local_mem</a>;
<a name="l00604"></a>00604        <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(type,size,t);
<a name="l00605"></a>00605 
<a name="l00606"></a>00606        mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(dstData.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,size/8,&amp;data.<a class="code" href="unionptx__reg__t.html#adc0cbd43aeef09733ebb516bbadb3fba">u128</a>,thread,pI);
<a name="l00607"></a>00607        thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = dstData.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l00608"></a>00608        thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca133ba819812b7d97221aed15cb830967">local_space</a>;
<a name="l00609"></a>00609    }
<a name="l00610"></a>00610 
<a name="l00611"></a>00611    <span class="keywordflow">else</span>
<a name="l00612"></a>00612    {
<a name="l00613"></a>00613        printf(<span class="stringliteral">&quot;Destination stores to unknown location.&quot;</span>);
<a name="l00614"></a>00614        assert(0);
<a name="l00615"></a>00615    }
<a name="l00616"></a>00616 
<a name="l00617"></a>00617 
<a name="l00618"></a>00618 }
<a name="l00619"></a>00619 
<a name="l00620"></a><a class="code" href="classptx__thread__info.html#a63c1ce9a7e644923b52c8dcbbd58d6fc">00620</a> <span class="keywordtype">void</span> <a class="code" href="classptx__thread__info.html#a63c1ce9a7e644923b52c8dcbbd58d6fc">ptx_thread_info::set_vector_operand_values</a>( <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst, 
<a name="l00621"></a>00621                                                  <span class="keyword">const</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> &amp;data1, 
<a name="l00622"></a>00622                                                  <span class="keyword">const</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> &amp;data2, 
<a name="l00623"></a>00623                                                  <span class="keyword">const</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> &amp;data3, 
<a name="l00624"></a>00624                                                  <span class="keyword">const</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> &amp;data4 )
<a name="l00625"></a>00625 {
<a name="l00626"></a>00626    <span class="keywordtype">unsigned</span> num_elements = dst.<a class="code" href="classoperand__info.html#ac45793fc8d4cad1dfe18a3c165c9e18f">get_vect_nelem</a>(); 
<a name="l00627"></a>00627    <span class="keywordflow">if</span> (num_elements &gt; 0) {
<a name="l00628"></a>00628        <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(0), data1);
<a name="l00629"></a>00629        <span class="keywordflow">if</span> (num_elements &gt; 1) {
<a name="l00630"></a>00630            <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(1), data2);
<a name="l00631"></a>00631            <span class="keywordflow">if</span> (num_elements &gt; 2) {
<a name="l00632"></a>00632               <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(2), data3);
<a name="l00633"></a>00633               <span class="keywordflow">if</span> (num_elements &gt; 3) {
<a name="l00634"></a>00634                  <a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(dst.<a class="code" href="classoperand__info.html#a2cdaefc080b39f4802aed85a638587af">vec_symbol</a>(3), data4);
<a name="l00635"></a>00635               }
<a name="l00636"></a>00636            }
<a name="l00637"></a>00637        }
<a name="l00638"></a>00638    }
<a name="l00639"></a>00639 
<a name="l00640"></a>00640    <a class="code" href="classptx__thread__info.html#a3f76361e51600f480b537d20300f534d">m_last_set_operand_value</a> = data1;
<a name="l00641"></a>00641 }
<a name="l00642"></a>00642 
<a name="l00643"></a>00643 <span class="preprocessor">#define my_abs(a) (((a)&lt;0)?(-a):(a))</span>
<a name="l00644"></a>00644 <span class="preprocessor"></span>
<a name="l00645"></a>00645 <span class="preprocessor">#define MY_MAX_I(a,b) (a &gt; b) ? a : b</span>
<a name="l00646"></a>00646 <span class="preprocessor"></span><span class="preprocessor">#define MY_MAX_F(a,b) isNaN(a) ? b : isNaN(b) ? a : (a &gt; b) ? a : b</span>
<a name="l00647"></a>00647 <span class="preprocessor"></span>
<a name="l00648"></a>00648 <span class="preprocessor">#define MY_MIN_I(a,b) (a &lt; b) ? a : b</span>
<a name="l00649"></a>00649 <span class="preprocessor"></span><span class="preprocessor">#define MY_MIN_F(a,b) isNaN(a) ? b : isNaN(b) ? a : (a &lt; b) ? a : b</span>
<a name="l00650"></a>00650 <span class="preprocessor"></span>
<a name="l00651"></a>00651 <span class="preprocessor">#define MY_INC_I(a,b) (a &gt;= b) ? 0 : a+1</span>
<a name="l00652"></a>00652 <span class="preprocessor"></span><span class="preprocessor">#define MY_DEC_I(a,b) ((a == 0) || (a &gt; b)) ? b : a-1</span>
<a name="l00653"></a>00653 <span class="preprocessor"></span>
<a name="l00654"></a>00654 <span class="preprocessor">#define MY_CAS_I(a,b,c) (a == b) ? c : a</span>
<a name="l00655"></a>00655 <span class="preprocessor"></span>
<a name="l00656"></a>00656 <span class="preprocessor">#define MY_EXCH(a,b) b</span>
<a name="l00657"></a>00657 <span class="preprocessor"></span>
<a name="l00658"></a><a class="code" href="instructions_8cc.html#a897e014c8c021c3fa5f25a7a025d99d1">00658</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a897e014c8c021c3fa5f25a7a025d99d1">abs_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l00659"></a>00659 { 
<a name="l00660"></a>00660    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, d;
<a name="l00661"></a>00661    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l00662"></a>00662    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l00663"></a>00663 
<a name="l00664"></a>00664    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l00665"></a>00665    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l00666"></a>00666 
<a name="l00667"></a>00667 
<a name="l00668"></a>00668    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l00669"></a>00669    <span class="keywordflow">case</span> S16_TYPE: d.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l00670"></a>00670    <span class="keywordflow">case</span> S32_TYPE: d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l00671"></a>00671    <span class="keywordflow">case</span> S64_TYPE: d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l00672"></a>00672    <span class="keywordflow">case</span> U16_TYPE: d.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l00673"></a>00673    <span class="keywordflow">case</span> U32_TYPE: d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l00674"></a>00674    <span class="keywordflow">case</span> U64_TYPE: d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l00675"></a>00675    <span class="keywordflow">case</span> F32_TYPE: d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l00676"></a>00676    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l00677"></a>00677    <span class="keywordflow">default</span>:
<a name="l00678"></a>00678       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l00679"></a>00679       assert(0);
<a name="l00680"></a>00680       <span class="keywordflow">break</span>;
<a name="l00681"></a>00681    }
<a name="l00682"></a>00682 
<a name="l00683"></a>00683    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l00684"></a>00684 }
<a name="l00685"></a>00685 
<a name="l00686"></a><a class="code" href="instructions_8cc.html#adfa9b306745121dba9c9083956738202">00686</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#adfa9b306745121dba9c9083956738202">addp_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread )
<a name="l00687"></a>00687 {
<a name="l00688"></a>00688    <span class="comment">//PTXPlus add instruction with carry (carry is kept in a predicate) register</span>
<a name="l00689"></a>00689    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, src3_data, data;
<a name="l00690"></a>00690    <span class="keywordtype">int</span> overflow = 0;
<a name="l00691"></a>00691    <span class="keywordtype">int</span> carry = 0;
<a name="l00692"></a>00692 
<a name="l00693"></a>00693    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();  <span class="comment">//get operand info of sources and destination</span>
<a name="l00694"></a>00694    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>(); <span class="comment">//use them to determine that they are of type &apos;register&apos;</span>
<a name="l00695"></a>00695    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l00696"></a>00696    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src3 = pI-&gt;<a class="code" href="classptx__instruction.html#ad3166c06dcaaba2b7e6187126d3a07ed">src3</a>();
<a name="l00697"></a>00697 
<a name="l00698"></a>00698    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l00699"></a>00699    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l00700"></a>00700    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l00701"></a>00701    src3_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src3, dst, i_type, thread, 1);
<a name="l00702"></a>00702 
<a name="l00703"></a>00703    <span class="keywordtype">unsigned</span> rounding_mode = pI-&gt;<a class="code" href="classptx__instruction.html#a761267ac81a148d1bd1cd3b93643db7e">rounding_mode</a>();
<a name="l00704"></a>00704    <span class="keywordtype">int</span> orig_rm = fegetround();
<a name="l00705"></a>00705    <span class="keywordflow">switch</span> ( rounding_mode ) {
<a name="l00706"></a>00706    <span class="keywordflow">case</span> RN_OPTION: <span class="keywordflow">break</span>;
<a name="l00707"></a>00707    <span class="keywordflow">case</span> RZ_OPTION: fesetround( FE_TOWARDZERO ); <span class="keywordflow">break</span>;
<a name="l00708"></a>00708    <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l00709"></a>00709    }
<a name="l00710"></a>00710 
<a name="l00711"></a>00711    <span class="comment">//performs addition. Sets carry and overflow if needed.</span>
<a name="l00712"></a>00712    <span class="comment">//src3_data.pred&amp;0x4 is the carry flag</span>
<a name="l00713"></a>00713    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l00714"></a>00714    <span class="keywordflow">case</span> S8_TYPE:
<a name="l00715"></a>00715       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x0000000FF) + (src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x0000000FF) + (src3_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x4);
<a name="l00716"></a>00716       <span class="keywordflow">if</span>(((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80)-(src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80)) == 0) {overflow=((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80)-(data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80))==0?0:1; }
<a name="l00717"></a>00717       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x000000100)&gt;&gt;8;
<a name="l00718"></a>00718       <span class="keywordflow">break</span>;
<a name="l00719"></a>00719    <span class="keywordflow">case</span> S16_TYPE:
<a name="l00720"></a>00720       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x00000FFFF) + (src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x00000FFFF) + (src3_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x4);
<a name="l00721"></a>00721       <span class="keywordflow">if</span>(((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000)-(src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000)) == 0) {overflow=((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000)-(data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000))==0?0:1; }
<a name="l00722"></a>00722       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x000010000)&gt;&gt;16;
<a name="l00723"></a>00723       <span class="keywordflow">break</span>;
<a name="l00724"></a>00724    <span class="keywordflow">case</span> S32_TYPE:
<a name="l00725"></a>00725       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x0FFFFFFFF) + (src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x0FFFFFFFF) + (src3_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x4);
<a name="l00726"></a>00726       <span class="keywordflow">if</span>(((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000)-(src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000)) == 0) {overflow=((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000)-(data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000))==0?0:1; }
<a name="l00727"></a>00727       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x100000000)&gt;&gt;32;
<a name="l00728"></a>00728       <span class="keywordflow">break</span>;
<a name="l00729"></a>00729    <span class="keywordflow">case</span> S64_TYPE:
<a name="l00730"></a>00730       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> + src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> + (src3_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x4);
<a name="l00731"></a>00731       <span class="keywordflow">break</span>;
<a name="l00732"></a>00732    <span class="keywordflow">case</span> U8_TYPE:
<a name="l00733"></a>00733       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFF) + (src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFF) + (src3_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x4);
<a name="l00734"></a>00734       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x100)&gt;&gt;8;
<a name="l00735"></a>00735       <span class="keywordflow">break</span>;
<a name="l00736"></a>00736    <span class="keywordflow">case</span> U16_TYPE:
<a name="l00737"></a>00737       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF) + (src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF) + (src3_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x4);
<a name="l00738"></a>00738       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x10000)&gt;&gt;16;
<a name="l00739"></a>00739       <span class="keywordflow">break</span>;
<a name="l00740"></a>00740    <span class="keywordflow">case</span> U32_TYPE:
<a name="l00741"></a>00741       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFFFFFF) + (src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFFFFFF) + (src3_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x4);
<a name="l00742"></a>00742       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x100000000)&gt;&gt;32;
<a name="l00743"></a>00743       <span class="keywordflow">break</span>;
<a name="l00744"></a>00744    <span class="keywordflow">case</span> U64_TYPE:
<a name="l00745"></a>00745       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> + src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> + (src3_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x4);
<a name="l00746"></a>00746       <span class="keywordflow">break</span>;
<a name="l00747"></a>00747    <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l00748"></a>00748    <span class="keywordflow">case</span> F32_TYPE: data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = src1_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> + src2_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>; <span class="keywordflow">break</span>;
<a name="l00749"></a>00749    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> + src2_data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>; <span class="keywordflow">break</span>;
<a name="l00750"></a>00750    <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l00751"></a>00751    }
<a name="l00752"></a>00752    fesetround( orig_rm );
<a name="l00753"></a>00753 
<a name="l00754"></a>00754    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, data, i_type, thread, pI, overflow, carry  );
<a name="l00755"></a>00755 }
<a name="l00756"></a>00756 
<a name="l00757"></a><a class="code" href="instructions_8cc.html#a425c13afca8ea59cea52a310ae102bc5">00757</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a425c13afca8ea59cea52a310ae102bc5">add_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l00758"></a>00758 { 
<a name="l00759"></a>00759    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l00760"></a>00760    <span class="keywordtype">int</span> overflow = 0;
<a name="l00761"></a>00761    <span class="keywordtype">int</span> carry = 0;
<a name="l00762"></a>00762 
<a name="l00763"></a>00763    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();  <span class="comment">//get operand info of sources and destination </span>
<a name="l00764"></a>00764    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>(); <span class="comment">//use them to determine that they are of type &apos;register&apos;</span>
<a name="l00765"></a>00765    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l00766"></a>00766 
<a name="l00767"></a>00767    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l00768"></a>00768    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l00769"></a>00769    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l00770"></a>00770 
<a name="l00771"></a>00771    <span class="keywordtype">unsigned</span> rounding_mode = pI-&gt;<a class="code" href="classptx__instruction.html#a761267ac81a148d1bd1cd3b93643db7e">rounding_mode</a>();
<a name="l00772"></a>00772    <span class="keywordtype">int</span> orig_rm = fegetround();
<a name="l00773"></a>00773    <span class="keywordflow">switch</span> ( rounding_mode ) {
<a name="l00774"></a>00774    <span class="keywordflow">case</span> RN_OPTION: <span class="keywordflow">break</span>;
<a name="l00775"></a>00775    <span class="keywordflow">case</span> RZ_OPTION: fesetround( FE_TOWARDZERO ); <span class="keywordflow">break</span>;
<a name="l00776"></a>00776    <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l00777"></a>00777    }
<a name="l00778"></a>00778 
<a name="l00779"></a>00779    <span class="comment">//performs addition. Sets carry and overflow if needed.</span>
<a name="l00780"></a>00780    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l00781"></a>00781    <span class="keywordflow">case</span> S8_TYPE:
<a name="l00782"></a>00782       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x0000000FF) + (src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x0000000FF);
<a name="l00783"></a>00783       <span class="keywordflow">if</span>(((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80)-(src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80)) == 0) {overflow=((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80)-(data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80))==0?0:1; }
<a name="l00784"></a>00784       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x000000100)&gt;&gt;8;
<a name="l00785"></a>00785       <span class="keywordflow">break</span>;
<a name="l00786"></a>00786    <span class="keywordflow">case</span> S16_TYPE:
<a name="l00787"></a>00787       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x00000FFFF) + (src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x00000FFFF);
<a name="l00788"></a>00788       <span class="keywordflow">if</span>(((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000)-(src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000)) == 0) {overflow=((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000)-(data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000))==0?0:1; }
<a name="l00789"></a>00789       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x000010000)&gt;&gt;16;
<a name="l00790"></a>00790       <span class="keywordflow">break</span>;
<a name="l00791"></a>00791    <span class="keywordflow">case</span> S32_TYPE:
<a name="l00792"></a>00792       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x0FFFFFFFF) + (src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x0FFFFFFFF);
<a name="l00793"></a>00793       <span class="keywordflow">if</span>(((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000)-(src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000)) == 0) {overflow=((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000)-(data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000))==0?0:1; }
<a name="l00794"></a>00794       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x100000000)&gt;&gt;32;
<a name="l00795"></a>00795       <span class="keywordflow">break</span>;
<a name="l00796"></a>00796    <span class="keywordflow">case</span> S64_TYPE:
<a name="l00797"></a>00797       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> + src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>;
<a name="l00798"></a>00798       <span class="keywordflow">break</span>;
<a name="l00799"></a>00799    <span class="keywordflow">case</span> U8_TYPE:
<a name="l00800"></a>00800       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFF) + (src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFF);
<a name="l00801"></a>00801       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x100)&gt;&gt;8;
<a name="l00802"></a>00802       <span class="keywordflow">break</span>;
<a name="l00803"></a>00803    <span class="keywordflow">case</span> U16_TYPE:
<a name="l00804"></a>00804       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF) + (src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF);
<a name="l00805"></a>00805       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x10000)&gt;&gt;16;
<a name="l00806"></a>00806       <span class="keywordflow">break</span>;
<a name="l00807"></a>00807    <span class="keywordflow">case</span> U32_TYPE:
<a name="l00808"></a>00808       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFFFFFF) + (src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFFFFFF);
<a name="l00809"></a>00809       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x100000000)&gt;&gt;32;
<a name="l00810"></a>00810       <span class="keywordflow">break</span>;
<a name="l00811"></a>00811    <span class="keywordflow">case</span> U64_TYPE:
<a name="l00812"></a>00812       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l00813"></a>00813       <span class="keywordflow">break</span>;
<a name="l00814"></a>00814    <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l00815"></a>00815    <span class="keywordflow">case</span> F32_TYPE: data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = src1_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> + src2_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>; <span class="keywordflow">break</span>;
<a name="l00816"></a>00816    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> + src2_data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>; <span class="keywordflow">break</span>;
<a name="l00817"></a>00817    <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l00818"></a>00818    }
<a name="l00819"></a>00819    fesetround( orig_rm );
<a name="l00820"></a>00820 
<a name="l00821"></a>00821    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, data, i_type, thread, pI, overflow, carry  );
<a name="l00822"></a>00822 }
<a name="l00823"></a>00823 
<a name="l00824"></a><a class="code" href="instructions_8cc.html#a012d00bd1d9b810a55992d520b5772cb">00824</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a012d00bd1d9b810a55992d520b5772cb">addc_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l00825"></a>00825 
<a name="l00826"></a><a class="code" href="instructions_8cc.html#aeaad5814dbf231c408fd2ff5d3ead850">00826</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aeaad5814dbf231c408fd2ff5d3ead850">and_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l00827"></a>00827 { 
<a name="l00828"></a>00828    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l00829"></a>00829 
<a name="l00830"></a>00830    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l00831"></a>00831    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l00832"></a>00832    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l00833"></a>00833 
<a name="l00834"></a>00834    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l00835"></a>00835    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l00836"></a>00836    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l00837"></a>00837 
<a name="l00838"></a>00838 
<a name="l00839"></a>00839    <span class="comment">//the way ptxplus handles predicates: 1 = false and 0 = true</span>
<a name="l00840"></a>00840    <span class="keywordflow">if</span>(i_type == PRED_TYPE)
<a name="l00841"></a>00841       data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = ~(~(src1_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>) &amp; ~(src2_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>));
<a name="l00842"></a>00842    <span class="keywordflow">else</span>
<a name="l00843"></a>00843       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l00844"></a>00844 
<a name="l00845"></a>00845    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI);
<a name="l00846"></a>00846 }
<a name="l00847"></a>00847 
<a name="l00848"></a><a class="code" href="instructions_8cc.html#a1f800bb41f08f47ef33b1eb9e527a13c">00848</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a1f800bb41f08f47ef33b1eb9e527a13c">andn_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l00849"></a>00849 { 
<a name="l00850"></a>00850    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l00851"></a>00851 
<a name="l00852"></a>00852    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l00853"></a>00853    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l00854"></a>00854    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l00855"></a>00855 
<a name="l00856"></a>00856    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l00857"></a>00857    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l00858"></a>00858    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l00859"></a>00859 
<a name="l00860"></a>00860    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l00861"></a>00861    <span class="keywordflow">case</span> B16_TYPE:  src2_data.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>  = ~src2_data.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>; <span class="keywordflow">break</span>;
<a name="l00862"></a>00862    <span class="keywordflow">case</span> B32_TYPE:  src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>  = ~src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>; <span class="keywordflow">break</span>;
<a name="l00863"></a>00863    <span class="keywordflow">case</span> B64_TYPE:  src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>  = ~src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>; <span class="keywordflow">break</span>;
<a name="l00864"></a>00864    <span class="keywordflow">default</span>:
<a name="l00865"></a>00865       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l00866"></a>00866       assert(0); 
<a name="l00867"></a>00867       <span class="keywordflow">break</span>;
<a name="l00868"></a>00868    }
<a name="l00869"></a>00869 
<a name="l00870"></a>00870    data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l00871"></a>00871 
<a name="l00872"></a>00872    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI);
<a name="l00873"></a>00873 }
<a name="l00874"></a>00874 
<a name="l00875"></a><a class="code" href="instructions_8cc.html#a2ee1c50ba90613cd44a0876547942f8d">00875</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a2ee1c50ba90613cd44a0876547942f8d">bar_callback</a>( <span class="keyword">const</span> <a class="code" href="classinst__t.html">inst_t</a>* inst, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a>* thread)
<a name="l00876"></a>00876 {
<a name="l00877"></a>00877     <span class="keywordtype">unsigned</span> ctaid = thread-&gt;<a class="code" href="classptx__thread__info.html#a15095c32555716902abd3b530cd76954">get_cta_uid</a>();
<a name="l00878"></a>00878     <span class="keywordtype">unsigned</span> barid = inst-&gt;<a class="code" href="classinst__t.html#ac82fdf337c301bd93083e2c4a1d082be">bar_id</a>;
<a name="l00879"></a>00879     <span class="keywordtype">unsigned</span> value = thread-&gt;<a class="code" href="classptx__thread__info.html#ae57e7fc8161216324e756794d8a0815b">get_reduction_value</a>(ctaid,barid);
<a name="l00880"></a>00880     <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classptx__instruction.html">ptx_instruction</a>*<span class="keyword">&gt;</span>(inst);
<a name="l00881"></a>00881     <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l00882"></a>00882     <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l00883"></a>00883     data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = value;
<a name="l00884"></a>00884     thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,value, U32_TYPE, thread, pI);
<a name="l00885"></a>00885 }
<a name="l00886"></a>00886 
<a name="l00887"></a><a class="code" href="instructions_8cc.html#a7742d1c016b3e8b56d56721cfe26053d">00887</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a7742d1c016b3e8b56d56721cfe26053d">atom_callback</a>( <span class="keyword">const</span> <a class="code" href="classinst__t.html">inst_t</a>* inst, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a>* thread)
<a name="l00888"></a>00888 {
<a name="l00889"></a>00889    <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classptx__instruction.html">ptx_instruction</a>*<span class="keyword">&gt;</span>(inst);
<a name="l00890"></a>00890 
<a name="l00891"></a>00891    <span class="comment">// &quot;Decode&quot; the output type</span>
<a name="l00892"></a>00892    <span class="keywordtype">unsigned</span> to_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l00893"></a>00893    <span class="keywordtype">size_t</span> size;
<a name="l00894"></a>00894    <span class="keywordtype">int</span> t;
<a name="l00895"></a>00895    <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(to_type, size, t);
<a name="l00896"></a>00896 
<a name="l00897"></a>00897    <span class="comment">// Set up operand variables</span>
<a name="l00898"></a>00898    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;        <span class="comment">// d</span>
<a name="l00899"></a>00899    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data;   <span class="comment">// a</span>
<a name="l00900"></a>00900    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src2_data;   <span class="comment">// b</span>
<a name="l00901"></a>00901    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op_result;   <span class="comment">// temp variable to hold operation result</span>
<a name="l00902"></a>00902 
<a name="l00903"></a>00903    <span class="keywordtype">bool</span> data_ready = <span class="keyword">false</span>;
<a name="l00904"></a>00904 
<a name="l00905"></a>00905    <span class="comment">// Get operand info of sources and destination</span>
<a name="l00906"></a>00906    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();     <span class="comment">// d</span>
<a name="l00907"></a>00907    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();    <span class="comment">// a</span>
<a name="l00908"></a>00908    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();    <span class="comment">// b</span>
<a name="l00909"></a>00909 
<a name="l00910"></a>00910    <span class="comment">// Get operand values</span>
<a name="l00911"></a>00911    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, src1, to_type, thread, 1);        <span class="comment">// a</span>
<a name="l00912"></a>00912    <span class="keywordflow">if</span> (dst.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>()-&gt;<a class="code" href="classsymbol.html#af8da68543a752fdbd25f4b905f2ab6da">type</a>()){
<a name="l00913"></a>00913       src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, to_type, thread, 1);      <span class="comment">// b</span>
<a name="l00914"></a>00914    } <span class="keywordflow">else</span> {
<a name="l00915"></a>00915        <span class="comment">//This is the case whent he first argument (dest) is &apos;_&apos;</span>
<a name="l00916"></a>00916       src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, src1, to_type, thread, 1);     <span class="comment">// b</span>
<a name="l00917"></a>00917    }
<a name="l00918"></a>00918 
<a name="l00919"></a>00919    <span class="comment">// Check state space</span>
<a name="l00920"></a>00920    <a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a> effective_address = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;  
<a name="l00921"></a>00921    <a class="code" href="classmemory__space__t.html">memory_space_t</a> space = pI-&gt;<a class="code" href="classptx__instruction.html#a93c8cf0ec080e4e0b0672e9e2ff8328e">get_space</a>();
<a name="l00922"></a>00922    <span class="keywordflow">if</span> (space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca434a5fd1a70c9dcbe2de96e9c602d265">undefined_space</a>) {
<a name="l00923"></a>00923       <span class="comment">// generic space - determine space via address</span>
<a name="l00924"></a>00924       <span class="keywordflow">if</span>( <a class="code" href="cuda-sim_8cc.html#adc619997188fa5d771ace549b2700aa7">whichspace</a>(effective_address) == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a> ) {
<a name="l00925"></a>00925          effective_address = <a class="code" href="cuda-sim_8cc.html#a8f2b2d24aeb6bb7d520ee819c0c22fa5">generic_to_global</a>(effective_address);
<a name="l00926"></a>00926          space = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>;
<a name="l00927"></a>00927       } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="cuda-sim_8cc.html#adc619997188fa5d771ace549b2700aa7">whichspace</a>(effective_address) == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a> ) {
<a name="l00928"></a>00928          <span class="keywordtype">unsigned</span> smid = thread-&gt;<a class="code" href="classptx__thread__info.html#a2ea77b07de9b308b68345534238442ba">get_hw_sid</a>();
<a name="l00929"></a>00929          effective_address = <a class="code" href="cuda-sim_8cc.html#a35eba6b8cdc2d7ec759b29fa0b9f3fa1">generic_to_shared</a>(smid,effective_address);
<a name="l00930"></a>00930          space = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>;
<a name="l00931"></a>00931       } <span class="keywordflow">else</span> {
<a name="l00932"></a>00932          abort();
<a name="l00933"></a>00933       }
<a name="l00934"></a>00934    } 
<a name="l00935"></a>00935    assert( space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a> || space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a> );
<a name="l00936"></a>00936 
<a name="l00937"></a>00937    <a class="code" href="classmemory__space.html">memory_space</a> *mem = NULL;
<a name="l00938"></a>00938    <span class="keywordflow">if</span>(space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>)
<a name="l00939"></a>00939        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab2b214414769f3a7422e2e7a1642bf74">get_global_memory</a>();
<a name="l00940"></a>00940    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>)
<a name="l00941"></a>00941        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a7c4af02df5c97e1e2d89f2475bf8df8f">m_shared_mem</a>;
<a name="l00942"></a>00942    <span class="keywordflow">else</span>
<a name="l00943"></a>00943        abort();
<a name="l00944"></a>00944 
<a name="l00945"></a>00945    <span class="comment">// Copy value pointed to in operand &apos;a&apos; into register &apos;d&apos;</span>
<a name="l00946"></a>00946    <span class="comment">// (i.e. copy src1_data to dst)</span>
<a name="l00947"></a>00947    mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(effective_address,size/8,&amp;data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>);
<a name="l00948"></a>00948    <span class="keywordflow">if</span> (dst.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>()-&gt;<a class="code" href="classsymbol.html#af8da68543a752fdbd25f4b905f2ab6da">type</a>()){
<a name="l00949"></a>00949        thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, data, to_type, thread, pI);                         <span class="comment">// Write value into register &apos;d&apos;</span>
<a name="l00950"></a>00950    }
<a name="l00951"></a>00951 
<a name="l00952"></a>00952    <span class="comment">// Get the atomic operation to be performed</span>
<a name="l00953"></a>00953    <span class="keywordtype">unsigned</span> m_atomic_spec = pI-&gt;<a class="code" href="classptx__instruction.html#afa355ff0c50ffecbc7b9423fc3ef1c56">get_atomic</a>();
<a name="l00954"></a>00954 
<a name="l00955"></a>00955    <span class="keywordflow">switch</span> ( m_atomic_spec ) {
<a name="l00956"></a>00956    <span class="comment">// AND</span>
<a name="l00957"></a>00957    <span class="keywordflow">case</span> ATOMIC_AND:
<a name="l00958"></a>00958       {
<a name="l00959"></a>00959 
<a name="l00960"></a>00960          <span class="keywordflow">switch</span> ( to_type ) {
<a name="l00961"></a>00961          <span class="keywordflow">case</span> B32_TYPE:
<a name="l00962"></a>00962          <span class="keywordflow">case</span> U32_TYPE:
<a name="l00963"></a>00963             op_result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l00964"></a>00964             data_ready = <span class="keyword">true</span>;
<a name="l00965"></a>00965             <span class="keywordflow">break</span>;
<a name="l00966"></a>00966          <span class="keywordflow">case</span> S32_TYPE:
<a name="l00967"></a>00967             op_result.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &amp; src2_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l00968"></a>00968             data_ready = <span class="keyword">true</span>;
<a name="l00969"></a>00969             <span class="keywordflow">break</span>;
<a name="l00970"></a>00970          <span class="keywordflow">default</span>:
<a name="l00971"></a>00971             printf(<span class="stringliteral">&quot;Execution error: type mismatch (%x) with instruction\natom.AND only accepts b32\n&quot;</span>, to_type);
<a name="l00972"></a>00972             assert(0);
<a name="l00973"></a>00973             <span class="keywordflow">break</span>;
<a name="l00974"></a>00974          }
<a name="l00975"></a>00975 
<a name="l00976"></a>00976          <span class="keywordflow">break</span>;
<a name="l00977"></a>00977       }
<a name="l00978"></a>00978       <span class="comment">// OR</span>
<a name="l00979"></a>00979    <span class="keywordflow">case</span> ATOMIC_OR:
<a name="l00980"></a>00980       {
<a name="l00981"></a>00981 
<a name="l00982"></a>00982          <span class="keywordflow">switch</span> ( to_type ) {
<a name="l00983"></a>00983          <span class="keywordflow">case</span> B32_TYPE:
<a name="l00984"></a>00984          <span class="keywordflow">case</span> U32_TYPE:
<a name="l00985"></a>00985             op_result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> | src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l00986"></a>00986             data_ready = <span class="keyword">true</span>;
<a name="l00987"></a>00987             <span class="keywordflow">break</span>;
<a name="l00988"></a>00988          <span class="keywordflow">case</span> S32_TYPE:
<a name="l00989"></a>00989             op_result.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> | src2_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l00990"></a>00990             data_ready = <span class="keyword">true</span>;
<a name="l00991"></a>00991             <span class="keywordflow">break</span>;
<a name="l00992"></a>00992          <span class="keywordflow">default</span>:
<a name="l00993"></a>00993             printf(<span class="stringliteral">&quot;Execution error: type mismatch (%x) with instruction\natom.OR only accepts b32\n&quot;</span>, to_type);
<a name="l00994"></a>00994             assert(0);
<a name="l00995"></a>00995             <span class="keywordflow">break</span>;
<a name="l00996"></a>00996          }
<a name="l00997"></a>00997 
<a name="l00998"></a>00998          <span class="keywordflow">break</span>;
<a name="l00999"></a>00999       }
<a name="l01000"></a>01000       <span class="comment">// XOR</span>
<a name="l01001"></a>01001    <span class="keywordflow">case</span> ATOMIC_XOR:
<a name="l01002"></a>01002       {
<a name="l01003"></a>01003 
<a name="l01004"></a>01004          <span class="keywordflow">switch</span> ( to_type ) {
<a name="l01005"></a>01005          <span class="keywordflow">case</span> B32_TYPE:
<a name="l01006"></a>01006          <span class="keywordflow">case</span> U32_TYPE:
<a name="l01007"></a>01007             op_result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> ^ src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l01008"></a>01008             data_ready = <span class="keyword">true</span>;
<a name="l01009"></a>01009             <span class="keywordflow">break</span>;
<a name="l01010"></a>01010          <span class="keywordflow">case</span> S32_TYPE:
<a name="l01011"></a>01011             op_result.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> ^ src2_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l01012"></a>01012             data_ready = <span class="keyword">true</span>;
<a name="l01013"></a>01013             <span class="keywordflow">break</span>;
<a name="l01014"></a>01014          <span class="keywordflow">default</span>:
<a name="l01015"></a>01015             printf(<span class="stringliteral">&quot;Execution error: type mismatch (%x) with instruction\natom.XOR only accepts b32\n&quot;</span>, to_type);
<a name="l01016"></a>01016             assert(0);
<a name="l01017"></a>01017             <span class="keywordflow">break</span>;
<a name="l01018"></a>01018          }
<a name="l01019"></a>01019 
<a name="l01020"></a>01020          <span class="keywordflow">break</span>;
<a name="l01021"></a>01021       }
<a name="l01022"></a>01022       <span class="comment">// CAS</span>
<a name="l01023"></a>01023    <span class="keywordflow">case</span> ATOMIC_CAS:
<a name="l01024"></a>01024       {
<a name="l01025"></a>01025 
<a name="l01026"></a>01026          <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src3_data;
<a name="l01027"></a>01027          <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src3 = pI-&gt;<a class="code" href="classptx__instruction.html#ad3166c06dcaaba2b7e6187126d3a07ed">src3</a>();
<a name="l01028"></a>01028          src3_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src3, dst, to_type, thread, 1);
<a name="l01029"></a>01029 
<a name="l01030"></a>01030          <span class="keywordflow">switch</span> ( to_type ) {
<a name="l01031"></a>01031          <span class="keywordflow">case</span> B32_TYPE:
<a name="l01032"></a>01032          <span class="keywordflow">case</span> U32_TYPE:
<a name="l01033"></a>01033             op_result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = MY_CAS_I(data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, src3_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01034"></a>01034             data_ready = <span class="keyword">true</span>;
<a name="l01035"></a>01035             <span class="keywordflow">break</span>;
<a name="l01036"></a>01036          <span class="keywordflow">case</span> B64_TYPE:
<a name="l01037"></a>01037          <span class="keywordflow">case</span> U64_TYPE:
<a name="l01038"></a>01038             op_result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = MY_CAS_I(data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>, src3_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l01039"></a>01039             data_ready = <span class="keyword">true</span>;
<a name="l01040"></a>01040             <span class="keywordflow">break</span>;
<a name="l01041"></a>01041          <span class="keywordflow">case</span> S32_TYPE:
<a name="l01042"></a>01042             op_result.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = MY_CAS_I(data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>, src3_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>);
<a name="l01043"></a>01043             data_ready = <span class="keyword">true</span>;
<a name="l01044"></a>01044             <span class="keywordflow">break</span>;
<a name="l01045"></a>01045          <span class="keywordflow">default</span>:
<a name="l01046"></a>01046             printf(<span class="stringliteral">&quot;Execution error: type mismatch (%x) with instruction\natom.CAS only accepts b32 and b64\n&quot;</span>, to_type);
<a name="l01047"></a>01047             assert(0);
<a name="l01048"></a>01048             <span class="keywordflow">break</span>;
<a name="l01049"></a>01049          }
<a name="l01050"></a>01050 
<a name="l01051"></a>01051          <span class="keywordflow">break</span>;
<a name="l01052"></a>01052       }
<a name="l01053"></a>01053       <span class="comment">// EXCH</span>
<a name="l01054"></a>01054    <span class="keywordflow">case</span> ATOMIC_EXCH:
<a name="l01055"></a>01055       {
<a name="l01056"></a>01056          <span class="keywordflow">switch</span> ( to_type ) {
<a name="l01057"></a>01057          <span class="keywordflow">case</span> B32_TYPE:
<a name="l01058"></a>01058          <span class="keywordflow">case</span> U32_TYPE:
<a name="l01059"></a>01059             op_result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = MY_EXCH(data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01060"></a>01060             data_ready = <span class="keyword">true</span>;
<a name="l01061"></a>01061             <span class="keywordflow">break</span>;
<a name="l01062"></a>01062          <span class="keywordflow">case</span> B64_TYPE:
<a name="l01063"></a>01063          <span class="keywordflow">case</span> U64_TYPE:
<a name="l01064"></a>01064             op_result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = MY_EXCH(data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l01065"></a>01065             data_ready = <span class="keyword">true</span>;
<a name="l01066"></a>01066             <span class="keywordflow">break</span>;
<a name="l01067"></a>01067          <span class="keywordflow">case</span> S32_TYPE:
<a name="l01068"></a>01068             op_result.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = MY_EXCH(data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>);
<a name="l01069"></a>01069             data_ready = <span class="keyword">true</span>;
<a name="l01070"></a>01070             <span class="keywordflow">break</span>;
<a name="l01071"></a>01071          <span class="keywordflow">default</span>:
<a name="l01072"></a>01072             printf(<span class="stringliteral">&quot;Execution error: type mismatch (%x) with instruction\natom.EXCH only accepts b32\n&quot;</span>, to_type);
<a name="l01073"></a>01073             assert(0);
<a name="l01074"></a>01074             <span class="keywordflow">break</span>;
<a name="l01075"></a>01075          }
<a name="l01076"></a>01076 
<a name="l01077"></a>01077          <span class="keywordflow">break</span>;
<a name="l01078"></a>01078       }
<a name="l01079"></a>01079       <span class="comment">// ADD</span>
<a name="l01080"></a>01080    <span class="keywordflow">case</span> ATOMIC_ADD:
<a name="l01081"></a>01081       {
<a name="l01082"></a>01082 
<a name="l01083"></a>01083          <span class="keywordflow">switch</span> ( to_type ) {
<a name="l01084"></a>01084          <span class="keywordflow">case</span> U32_TYPE:
<a name="l01085"></a>01085             op_result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l01086"></a>01086             data_ready = <span class="keyword">true</span>;
<a name="l01087"></a>01087             <span class="keywordflow">break</span>;
<a name="l01088"></a>01088          <span class="keywordflow">case</span> S32_TYPE:
<a name="l01089"></a>01089             op_result.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> + src2_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l01090"></a>01090             data_ready = <span class="keyword">true</span>;
<a name="l01091"></a>01091             <span class="keywordflow">break</span>;
<a name="l01092"></a>01092          <span class="keywordflow">case</span> U64_TYPE: 
<a name="l01093"></a>01093             op_result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>; 
<a name="l01094"></a>01094             data_ready = <span class="keyword">true</span>; 
<a name="l01095"></a>01095             <span class="keywordflow">break</span>; 
<a name="l01096"></a>01096          <span class="keywordflow">case</span> F32_TYPE: 
<a name="l01097"></a>01097             op_result.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> + src2_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>; 
<a name="l01098"></a>01098             data_ready = <span class="keyword">true</span>; 
<a name="l01099"></a>01099             <span class="keywordflow">break</span>; 
<a name="l01100"></a>01100          <span class="keywordflow">default</span>:
<a name="l01101"></a>01101             printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\natom.ADD only accepts u32, s32, u64, and f32\n&quot;</span>);
<a name="l01102"></a>01102             assert(0);
<a name="l01103"></a>01103             <span class="keywordflow">break</span>;
<a name="l01104"></a>01104          }
<a name="l01105"></a>01105 
<a name="l01106"></a>01106          <span class="keywordflow">break</span>;
<a name="l01107"></a>01107       }
<a name="l01108"></a>01108       <span class="comment">// INC</span>
<a name="l01109"></a>01109    <span class="keywordflow">case</span> ATOMIC_INC:
<a name="l01110"></a>01110       {
<a name="l01111"></a>01111          <span class="keywordflow">switch</span> ( to_type ) {
<a name="l01112"></a>01112          <span class="keywordflow">case</span> U32_TYPE: 
<a name="l01113"></a>01113             op_result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = MY_INC_I(data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01114"></a>01114             data_ready = <span class="keyword">true</span>;
<a name="l01115"></a>01115             <span class="keywordflow">break</span>;
<a name="l01116"></a>01116          <span class="keywordflow">default</span>:
<a name="l01117"></a>01117             printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\natom.INC only accepts u32 and s32\n&quot;</span>);
<a name="l01118"></a>01118             assert(0);
<a name="l01119"></a>01119             <span class="keywordflow">break</span>;
<a name="l01120"></a>01120          }
<a name="l01121"></a>01121 
<a name="l01122"></a>01122          <span class="keywordflow">break</span>;
<a name="l01123"></a>01123       }
<a name="l01124"></a>01124       <span class="comment">// DEC</span>
<a name="l01125"></a>01125    <span class="keywordflow">case</span> ATOMIC_DEC:
<a name="l01126"></a>01126       {
<a name="l01127"></a>01127          <span class="keywordflow">switch</span> ( to_type ) {
<a name="l01128"></a>01128          <span class="keywordflow">case</span> U32_TYPE: 
<a name="l01129"></a>01129             op_result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = MY_DEC_I(data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01130"></a>01130             data_ready = <span class="keyword">true</span>;
<a name="l01131"></a>01131             <span class="keywordflow">break</span>;
<a name="l01132"></a>01132          <span class="keywordflow">default</span>:
<a name="l01133"></a>01133             printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\natom.DEC only accepts u32 and s32\n&quot;</span>);
<a name="l01134"></a>01134             assert(0);
<a name="l01135"></a>01135             <span class="keywordflow">break</span>;
<a name="l01136"></a>01136          }
<a name="l01137"></a>01137 
<a name="l01138"></a>01138          <span class="keywordflow">break</span>;
<a name="l01139"></a>01139       }
<a name="l01140"></a>01140       <span class="comment">// MIN</span>
<a name="l01141"></a>01141    <span class="keywordflow">case</span> ATOMIC_MIN:
<a name="l01142"></a>01142       {
<a name="l01143"></a>01143          <span class="keywordflow">switch</span> ( to_type ) {
<a name="l01144"></a>01144          <span class="keywordflow">case</span> U32_TYPE: 
<a name="l01145"></a>01145             op_result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = MY_MIN_I(data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01146"></a>01146             data_ready = <span class="keyword">true</span>;
<a name="l01147"></a>01147             <span class="keywordflow">break</span>;
<a name="l01148"></a>01148          <span class="keywordflow">case</span> S32_TYPE:
<a name="l01149"></a>01149             op_result.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = MY_MIN_I(data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>);
<a name="l01150"></a>01150             data_ready = <span class="keyword">true</span>;
<a name="l01151"></a>01151             <span class="keywordflow">break</span>;
<a name="l01152"></a>01152          <span class="keywordflow">default</span>:
<a name="l01153"></a>01153             printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\natom.MIN only accepts u32 and s32\n&quot;</span>);
<a name="l01154"></a>01154             assert(0);
<a name="l01155"></a>01155             <span class="keywordflow">break</span>;
<a name="l01156"></a>01156          }
<a name="l01157"></a>01157 
<a name="l01158"></a>01158          <span class="keywordflow">break</span>;
<a name="l01159"></a>01159       }
<a name="l01160"></a>01160       <span class="comment">// MAX</span>
<a name="l01161"></a>01161    <span class="keywordflow">case</span> ATOMIC_MAX:
<a name="l01162"></a>01162       {
<a name="l01163"></a>01163          <span class="keywordflow">switch</span> ( to_type ) {
<a name="l01164"></a>01164          <span class="keywordflow">case</span> U32_TYPE:
<a name="l01165"></a>01165             op_result.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = MY_MAX_I(data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01166"></a>01166             data_ready = <span class="keyword">true</span>;
<a name="l01167"></a>01167             <span class="keywordflow">break</span>;
<a name="l01168"></a>01168          <span class="keywordflow">case</span> S32_TYPE:
<a name="l01169"></a>01169             op_result.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = MY_MAX_I(data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>, src2_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>);
<a name="l01170"></a>01170             data_ready = <span class="keyword">true</span>;
<a name="l01171"></a>01171             <span class="keywordflow">break</span>;
<a name="l01172"></a>01172          <span class="keywordflow">default</span>:
<a name="l01173"></a>01173             printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\natom.MAX only accepts u32 and s32\n&quot;</span>);
<a name="l01174"></a>01174             assert(0);
<a name="l01175"></a>01175             <span class="keywordflow">break</span>;
<a name="l01176"></a>01176          }
<a name="l01177"></a>01177 
<a name="l01178"></a>01178          <span class="keywordflow">break</span>;
<a name="l01179"></a>01179       }
<a name="l01180"></a>01180       <span class="comment">// DEFAULT</span>
<a name="l01181"></a>01181    <span class="keywordflow">default</span>:
<a name="l01182"></a>01182       {
<a name="l01183"></a>01183          assert(0);
<a name="l01184"></a>01184          <span class="keywordflow">break</span>;
<a name="l01185"></a>01185       }
<a name="l01186"></a>01186    }
<a name="l01187"></a>01187 
<a name="l01188"></a>01188    <span class="comment">// Write operation result into  memory</span>
<a name="l01189"></a>01189    <span class="comment">// (i.e. copy src1_data to dst)</span>
<a name="l01190"></a>01190    <span class="keywordflow">if</span> ( data_ready ) {
<a name="l01191"></a>01191       mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(effective_address,size/8,&amp;op_result.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>,thread,pI);
<a name="l01192"></a>01192    } <span class="keywordflow">else</span> {
<a name="l01193"></a>01193       printf(<span class="stringliteral">&quot;Execution error: data_ready not set\n&quot;</span>);
<a name="l01194"></a>01194       assert(0);
<a name="l01195"></a>01195    }
<a name="l01196"></a>01196 }
<a name="l01197"></a>01197 
<a name="l01198"></a>01198 <span class="comment">// atom_impl will now result in a callback being called in mem_ctrl_pop (gpu-sim.c)</span>
<a name="l01199"></a><a class="code" href="instructions_8cc.html#ab253f4e5c10a9a734b6b7a4921347756">01199</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ab253f4e5c10a9a734b6b7a4921347756">atom_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread )
<a name="l01200"></a>01200 {   
<a name="l01201"></a>01201    <span class="comment">// SYNTAX</span>
<a name="l01202"></a>01202    <span class="comment">// atom.space.operation.type d, a, b[, c]; (now read in callback)</span>
<a name="l01203"></a>01203 
<a name="l01204"></a>01204    <span class="comment">// obtain memory space of the operation </span>
<a name="l01205"></a>01205    <a class="code" href="classmemory__space__t.html">memory_space_t</a> space = pI-&gt;<a class="code" href="classptx__instruction.html#a93c8cf0ec080e4e0b0672e9e2ff8328e">get_space</a>(); 
<a name="l01206"></a>01206 
<a name="l01207"></a>01207    <span class="comment">// get the memory address</span>
<a name="l01208"></a>01208    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l01209"></a>01209    <span class="comment">// const operand_info &amp;dst  = pI-&gt;dst();  // not needed for effective address calculation </span>
<a name="l01210"></a>01210    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l01211"></a>01211    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data;
<a name="l01212"></a>01212    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, src1, i_type, thread, 1);
<a name="l01213"></a>01213    <a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a> effective_address = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>; 
<a name="l01214"></a>01214 
<a name="l01215"></a>01215    <a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a> effective_address_final; 
<a name="l01216"></a>01216 
<a name="l01217"></a>01217    <span class="comment">// handle generic memory space by converting it to global </span>
<a name="l01218"></a>01218    <span class="keywordflow">if</span> ( space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca434a5fd1a70c9dcbe2de96e9c602d265">undefined_space</a> ) {
<a name="l01219"></a>01219       <span class="keywordflow">if</span>( <a class="code" href="cuda-sim_8cc.html#adc619997188fa5d771ace549b2700aa7">whichspace</a>(effective_address) == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a> ) {
<a name="l01220"></a>01220          effective_address_final = <a class="code" href="cuda-sim_8cc.html#a8f2b2d24aeb6bb7d520ee819c0c22fa5">generic_to_global</a>(effective_address);
<a name="l01221"></a>01221          space = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>;
<a name="l01222"></a>01222       } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="cuda-sim_8cc.html#adc619997188fa5d771ace549b2700aa7">whichspace</a>(effective_address) == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a> ) {
<a name="l01223"></a>01223          <span class="keywordtype">unsigned</span> smid = thread-&gt;<a class="code" href="classptx__thread__info.html#a2ea77b07de9b308b68345534238442ba">get_hw_sid</a>();
<a name="l01224"></a>01224          effective_address_final = <a class="code" href="cuda-sim_8cc.html#a35eba6b8cdc2d7ec759b29fa0b9f3fa1">generic_to_shared</a>(smid,effective_address);
<a name="l01225"></a>01225          space = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>;
<a name="l01226"></a>01226       } <span class="keywordflow">else</span> {
<a name="l01227"></a>01227          abort();
<a name="l01228"></a>01228       }
<a name="l01229"></a>01229    } <span class="keywordflow">else</span> {
<a name="l01230"></a>01230       assert( space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a> || space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a> );
<a name="l01231"></a>01231       effective_address_final = effective_address; 
<a name="l01232"></a>01232    }
<a name="l01233"></a>01233 
<a name="l01234"></a>01234    <span class="comment">// Check state space</span>
<a name="l01235"></a>01235    assert( space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a> || space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a> );
<a name="l01236"></a>01236 
<a name="l01237"></a>01237    thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = effective_address_final;
<a name="l01238"></a>01238    thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = space;
<a name="l01239"></a>01239    thread-&gt;<a class="code" href="classptx__thread__info.html#a9a76570297ea1db22fbbe07e361b7096">m_last_dram_callback</a>.<a class="code" href="structdram__callback__t.html#a0c920dd2417e7dfb45d5a65bfc213767">function</a> = <a class="code" href="instructions_8cc.html#a7742d1c016b3e8b56d56721cfe26053d">atom_callback</a>;
<a name="l01240"></a>01240    thread-&gt;<a class="code" href="classptx__thread__info.html#a9a76570297ea1db22fbbe07e361b7096">m_last_dram_callback</a>.<a class="code" href="structdram__callback__t.html#a637ad42609af2a656212438f8fe9a42e">instruction</a> = pI; 
<a name="l01241"></a>01241 }
<a name="l01242"></a>01242 
<a name="l01243"></a><a class="code" href="instructions_8cc.html#aaaf1e97f862057b0e6f0511ab4dcd7e5">01243</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aaaf1e97f862057b0e6f0511ab4dcd7e5">bar_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pIin, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread )
<a name="l01244"></a>01244 { 
<a name="l01245"></a>01245    <a class="code" href="classptx__instruction.html">ptx_instruction</a> * pI = <span class="keyword">const_cast&lt;</span><a class="code" href="classptx__instruction.html">ptx_instruction</a> *<span class="keyword">&gt;</span>(pIin);
<a name="l01246"></a>01246    <span class="keywordtype">unsigned</span> bar_op = pI-&gt;<a class="code" href="classptx__instruction.html#aad47999e0481d8951ae6265c8178ae33">barrier_op</a>();
<a name="l01247"></a>01247    <span class="keywordtype">unsigned</span> red_op = pI-&gt;<a class="code" href="classptx__instruction.html#afa355ff0c50ffecbc7b9423fc3ef1c56">get_atomic</a>();
<a name="l01248"></a>01248    <span class="keywordtype">unsigned</span> ctaid = thread-&gt;<a class="code" href="classptx__thread__info.html#a15095c32555716902abd3b530cd76954">get_cta_uid</a>();
<a name="l01249"></a>01249 
<a name="l01250"></a>01250    <span class="keywordflow">switch</span>(bar_op){
<a name="l01251"></a>01251        <span class="keywordflow">case</span> SYNC_OPTION:
<a name="l01252"></a>01252        {
<a name="l01253"></a>01253            <span class="keywordflow">if</span>(pI-&gt;<a class="code" href="classptx__instruction.html#a8c20877db07add4aacd26ce9a183fb2e">get_num_operands</a>()&gt;1){
<a name="l01254"></a>01254                <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op0 = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01255"></a>01255                <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l01256"></a>01256                <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op0_data;
<a name="l01257"></a>01257                <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op1_data;
<a name="l01258"></a>01258                op0_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(op0, op0, U32_TYPE, thread, 1);
<a name="l01259"></a>01259                op1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(op1, op1, U32_TYPE, thread, 1);
<a name="l01260"></a>01260                pI-&gt;<a class="code" href="classinst__t.html#a09d7e5e445404bc8adf99dd0c86af0d0">set_bar_id</a>(op0_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01261"></a>01261                pI-&gt;<a class="code" href="classinst__t.html#a873835c7bc183288c7e9f494662fa672">set_bar_count</a>(op1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01262"></a>01262            }<span class="keywordflow">else</span>{
<a name="l01263"></a>01263                <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op0 = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01264"></a>01264                <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op0_data;
<a name="l01265"></a>01265                op0_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(op0, op0, U32_TYPE, thread, 1);
<a name="l01266"></a>01266                pI-&gt;<a class="code" href="classinst__t.html#a09d7e5e445404bc8adf99dd0c86af0d0">set_bar_id</a>(op0_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01267"></a>01267            }
<a name="l01268"></a>01268            <span class="keywordflow">break</span>;
<a name="l01269"></a>01269        }
<a name="l01270"></a>01270        <span class="keywordflow">case</span> ARRIVE_OPTION:
<a name="l01271"></a>01271        {
<a name="l01272"></a>01272                <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op0 = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01273"></a>01273                <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l01274"></a>01274                <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op0_data;
<a name="l01275"></a>01275                <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op1_data;
<a name="l01276"></a>01276                op0_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(op0, op0, U32_TYPE, thread, 1);
<a name="l01277"></a>01277                op1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(op1, op1, U32_TYPE, thread, 1);
<a name="l01278"></a>01278                pI-&gt;<a class="code" href="classinst__t.html#a09d7e5e445404bc8adf99dd0c86af0d0">set_bar_id</a>(op0_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01279"></a>01279                pI-&gt;<a class="code" href="classinst__t.html#a873835c7bc183288c7e9f494662fa672">set_bar_count</a>(op1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01280"></a>01280            <span class="keywordflow">break</span>;
<a name="l01281"></a>01281        }
<a name="l01282"></a>01282        <span class="keywordflow">case</span> RED_OPTION:
<a name="l01283"></a>01283        {
<a name="l01284"></a>01284            <span class="keywordflow">if</span>(pI-&gt;<a class="code" href="classptx__instruction.html#a8c20877db07add4aacd26ce9a183fb2e">get_num_operands</a>()&gt;3){
<a name="l01285"></a>01285                <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l01286"></a>01286                <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l01287"></a>01287                <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op3 = pI-&gt;<a class="code" href="classptx__instruction.html#ad3166c06dcaaba2b7e6187126d3a07ed">src3</a>();
<a name="l01288"></a>01288                <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op1_data;
<a name="l01289"></a>01289                <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op2_data;
<a name="l01290"></a>01290                <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op3_data;
<a name="l01291"></a>01291                op1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(op1, op1, U32_TYPE, thread, 1);
<a name="l01292"></a>01292                op2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(op2, op2, U32_TYPE, thread, 1);
<a name="l01293"></a>01293                op3_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(op3, op3, PRED_TYPE, thread, 1);
<a name="l01294"></a>01294                op3_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>=!(op3_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x0001);
<a name="l01295"></a>01295                pI-&gt;<a class="code" href="classinst__t.html#a09d7e5e445404bc8adf99dd0c86af0d0">set_bar_id</a>(op1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01296"></a>01296                pI-&gt;<a class="code" href="classinst__t.html#a873835c7bc183288c7e9f494662fa672">set_bar_count</a>(op2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01297"></a>01297                <span class="keywordflow">switch</span>(red_op){
<a name="l01298"></a>01298                    <span class="keywordflow">case</span> ATOMIC_POPC:
<a name="l01299"></a>01299                        thread-&gt;<a class="code" href="classptx__thread__info.html#a460031dff83cce85051c4ed0056c95f7">popc_reduction</a>(ctaid,op1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,op3_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01300"></a>01300                        <span class="keywordflow">break</span>;
<a name="l01301"></a>01301                    <span class="keywordflow">case</span> ATOMIC_AND:
<a name="l01302"></a>01302                        thread-&gt;<a class="code" href="classptx__thread__info.html#a49100740f367c63a90e77633d7bedfeb">and_reduction</a>(ctaid,op1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,op3_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01303"></a>01303                        <span class="keywordflow">break</span>;
<a name="l01304"></a>01304                    <span class="keywordflow">case</span> ATOMIC_OR:
<a name="l01305"></a>01305                        thread-&gt;<a class="code" href="classptx__thread__info.html#a7ded392877f5a5a10d307947d008b88e">or_reduction</a>(ctaid,op1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,op3_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01306"></a>01306                        <span class="keywordflow">break</span>;
<a name="l01307"></a>01307                    <span class="keywordflow">default</span>:
<a name="l01308"></a>01308                        abort();
<a name="l01309"></a>01309                        <span class="keywordflow">break</span>;
<a name="l01310"></a>01310                }
<a name="l01311"></a>01311            }<span class="keywordflow">else</span>{
<a name="l01312"></a>01312                <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l01313"></a>01313                <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l01314"></a>01314                <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op1_data;
<a name="l01315"></a>01315                <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> op2_data;
<a name="l01316"></a>01316                op1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(op1, op1, U32_TYPE, thread, 1);
<a name="l01317"></a>01317                op2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(op2, op2, PRED_TYPE, thread, 1);
<a name="l01318"></a>01318                op2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>=!(op2_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x0001);
<a name="l01319"></a>01319                pI-&gt;<a class="code" href="classinst__t.html#a09d7e5e445404bc8adf99dd0c86af0d0">set_bar_id</a>(op1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01320"></a>01320                <span class="keywordflow">switch</span>(red_op){
<a name="l01321"></a>01321                    <span class="keywordflow">case</span> ATOMIC_POPC:
<a name="l01322"></a>01322                        thread-&gt;<a class="code" href="classptx__thread__info.html#a460031dff83cce85051c4ed0056c95f7">popc_reduction</a>(ctaid,op1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,op2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01323"></a>01323                        <span class="keywordflow">break</span>;
<a name="l01324"></a>01324                    <span class="keywordflow">case</span> ATOMIC_AND:
<a name="l01325"></a>01325                        thread-&gt;<a class="code" href="classptx__thread__info.html#a49100740f367c63a90e77633d7bedfeb">and_reduction</a>(ctaid,op1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,op2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01326"></a>01326                        <span class="keywordflow">break</span>;
<a name="l01327"></a>01327                    <span class="keywordflow">case</span> ATOMIC_OR:
<a name="l01328"></a>01328                        thread-&gt;<a class="code" href="classptx__thread__info.html#a7ded392877f5a5a10d307947d008b88e">or_reduction</a>(ctaid,op1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,op2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l01329"></a>01329                        <span class="keywordflow">break</span>;
<a name="l01330"></a>01330                    <span class="keywordflow">default</span>:
<a name="l01331"></a>01331                        abort();
<a name="l01332"></a>01332                        <span class="keywordflow">break</span>;
<a name="l01333"></a>01333                }
<a name="l01334"></a>01334            }
<a name="l01335"></a>01335            <span class="keywordflow">break</span>;
<a name="l01336"></a>01336        }
<a name="l01337"></a>01337        <span class="keywordflow">default</span>:
<a name="l01338"></a>01338            abort();
<a name="l01339"></a>01339            <span class="keywordflow">break</span>;
<a name="l01340"></a>01340    }
<a name="l01341"></a>01341 
<a name="l01342"></a>01342    thread-&gt;<a class="code" href="classptx__thread__info.html#a9a76570297ea1db22fbbe07e361b7096">m_last_dram_callback</a>.<a class="code" href="structdram__callback__t.html#a0c920dd2417e7dfb45d5a65bfc213767">function</a> = <a class="code" href="instructions_8cc.html#a2ee1c50ba90613cd44a0876547942f8d">bar_callback</a>;
<a name="l01343"></a>01343    thread-&gt;<a class="code" href="classptx__thread__info.html#a9a76570297ea1db22fbbe07e361b7096">m_last_dram_callback</a>.<a class="code" href="structdram__callback__t.html#a637ad42609af2a656212438f8fe9a42e">instruction</a> = pIin;
<a name="l01344"></a>01344 }
<a name="l01345"></a>01345 
<a name="l01346"></a><a class="code" href="instructions_8cc.html#a68ba132815715d8495aa668f0884fe7a">01346</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a68ba132815715d8495aa668f0884fe7a">bfe_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l01347"></a>01347 {
<a name="l01348"></a>01348     <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l01349"></a>01349     <span class="keywordtype">unsigned</span> msb = (i_type == U32_TYPE || i_type == S32_TYPE) ? 31 : 63;
<a name="l01350"></a>01350     <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01351"></a>01351     <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l01352"></a>01352     <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l01353"></a>01353     <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src3 = pI-&gt;<a class="code" href="classptx__instruction.html#ad3166c06dcaaba2b7e6187126d3a07ed">src3</a>();
<a name="l01354"></a>01354     <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l01355"></a>01355     <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l01356"></a>01356     <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> c = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src3, dst, i_type, thread, 1);
<a name="l01357"></a>01357     <span class="keywordtype">unsigned</span> pos = b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; 0xFF;
<a name="l01358"></a>01358     <span class="keywordtype">unsigned</span> len = c.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; 0xFF;
<a name="l01359"></a>01359     <span class="keywordtype">unsigned</span> d = 0;
<a name="l01360"></a>01360     <span class="keywordflow">switch</span> (i_type)
<a name="l01361"></a>01361     {
<a name="l01362"></a>01362         <span class="keywordflow">case</span> U32_TYPE:
<a name="l01363"></a>01363         {
<a name="l01364"></a>01364             <span class="keywordtype">unsigned</span> mask;
<a name="l01365"></a>01365             d = a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &gt;&gt; pos;
<a name="l01366"></a>01366             mask = 0xFFFFFFFF &gt;&gt; (32 - len);
<a name="l01367"></a>01367             d &amp;= mask;
<a name="l01368"></a>01368             <span class="keywordflow">break</span>;
<a name="l01369"></a>01369         }
<a name="l01370"></a>01370         <span class="keywordflow">case</span> U64_TYPE:
<a name="l01371"></a>01371         {
<a name="l01372"></a>01372             <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mask;
<a name="l01373"></a>01373             d = a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &gt;&gt; pos;   
<a name="l01374"></a>01374             mask = 0xFFFFFFFFFFFFFFFF &gt;&gt; (64 - len);
<a name="l01375"></a>01375             d &amp;= mask;
<a name="l01376"></a>01376             <span class="keywordflow">break</span>;
<a name="l01377"></a>01377         }
<a name="l01378"></a>01378         <span class="keywordflow">case</span> S32_TYPE:
<a name="l01379"></a>01379         {
<a name="l01380"></a>01380             <span class="keywordtype">unsigned</span> mask;
<a name="l01381"></a>01381             <span class="keywordtype">unsigned</span> min = MY_MIN_I(pos + len - 1, msb);
<a name="l01382"></a>01382             <span class="keywordtype">unsigned</span> sbit = len == 0 ? 0 : (a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &gt;&gt; min) &amp; 0x1;
<a name="l01383"></a>01383             d = a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &gt;&gt; pos;
<a name="l01384"></a>01384             <span class="keywordflow">if</span> (sbit &gt; 0)
<a name="l01385"></a>01385             {
<a name="l01386"></a>01386                 mask = 0xFFFFFFFF &lt;&lt; len;
<a name="l01387"></a>01387                 d |= mask;
<a name="l01388"></a>01388             }
<a name="l01389"></a>01389             <span class="keywordflow">else</span>
<a name="l01390"></a>01390             {
<a name="l01391"></a>01391                 mask = 0xFFFFFFFF &gt;&gt; (32 - len);
<a name="l01392"></a>01392                 d &amp;= mask;
<a name="l01393"></a>01393             }
<a name="l01394"></a>01394             <span class="keywordflow">break</span>;
<a name="l01395"></a>01395         }
<a name="l01396"></a>01396         <span class="keywordflow">case</span> S64_TYPE:
<a name="l01397"></a>01397         {
<a name="l01398"></a>01398             <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mask;
<a name="l01399"></a>01399             <span class="keywordtype">unsigned</span> min = MY_MIN_I(pos + len - 1, msb);
<a name="l01400"></a>01400             <span class="keywordtype">unsigned</span> sbit = len == 0 ? 0 : (a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &gt;&gt; min) &amp; 0x1;
<a name="l01401"></a>01401             d = a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &gt;&gt; pos;
<a name="l01402"></a>01402             <span class="keywordflow">if</span> (sbit &gt; 0)
<a name="l01403"></a>01403             {
<a name="l01404"></a>01404                 mask = 0xFFFFFFFFFFFFFFFF &lt;&lt; len;
<a name="l01405"></a>01405                 d |= mask;
<a name="l01406"></a>01406             }
<a name="l01407"></a>01407             <span class="keywordflow">else</span>
<a name="l01408"></a>01408             {
<a name="l01409"></a>01409                 mask = 0xFFFFFFFFFFFFFFFF &gt;&gt; (64 - len);
<a name="l01410"></a>01410                 d &amp;= mask;
<a name="l01411"></a>01411             }
<a name="l01412"></a>01412             <span class="keywordflow">break</span>;
<a name="l01413"></a>01413         }
<a name="l01414"></a>01414         <span class="keywordflow">default</span>:
<a name="l01415"></a>01415         printf(<span class="stringliteral">&quot;Operand type not supported for BFE instruction.\n&quot;</span>);
<a name="l01416"></a>01416         abort();
<a name="l01417"></a>01417         <span class="keywordflow">return</span>;
<a name="l01418"></a>01418     }
<a name="l01419"></a>01419     thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l01420"></a>01420 }
<a name="l01421"></a>01421 
<a name="l01422"></a><a class="code" href="instructions_8cc.html#a050b926c9bd1c45567e362b9ea538316">01422</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a050b926c9bd1c45567e362b9ea538316">bfi_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l01423"></a><a class="code" href="instructions_8cc.html#aab5881b5643f86a2116fc3596e82b642">01423</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aab5881b5643f86a2116fc3596e82b642">bfind_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l01424"></a>01424 
<a name="l01425"></a><a class="code" href="instructions_8cc.html#a6eb43021694867fc6b30748c871d96c2">01425</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a6eb43021694867fc6b30748c871d96c2">bra_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l01426"></a>01426 {
<a name="l01427"></a>01427    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;target  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01428"></a>01428    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> target_pc = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(target, target, U32_TYPE, thread, 1);
<a name="l01429"></a>01429 
<a name="l01430"></a>01430    thread-&gt;<a class="code" href="classptx__thread__info.html#a0ed2659f31cfcea6997cca7171bb9d50">m_branch_taken</a> = <span class="keyword">true</span>;
<a name="l01431"></a>01431    thread-&gt;<a class="code" href="classptx__thread__info.html#a4230765ef71b488274911361c34bcef0">set_npc</a>(target_pc);
<a name="l01432"></a>01432 }
<a name="l01433"></a>01433 
<a name="l01434"></a><a class="code" href="instructions_8cc.html#a86ad5e106ceb20109ad870ebef5cb578">01434</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a86ad5e106ceb20109ad870ebef5cb578">brx_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l01435"></a>01435 {
<a name="l01436"></a>01436    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;target  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01437"></a>01437    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> target_pc = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(target, target, U32_TYPE, thread, 1);
<a name="l01438"></a>01438 
<a name="l01439"></a>01439    thread-&gt;<a class="code" href="classptx__thread__info.html#a0ed2659f31cfcea6997cca7171bb9d50">m_branch_taken</a> = <span class="keyword">true</span>;
<a name="l01440"></a>01440    thread-&gt;<a class="code" href="classptx__thread__info.html#a4230765ef71b488274911361c34bcef0">set_npc</a>(target_pc);
<a name="l01441"></a>01441 }
<a name="l01442"></a>01442 
<a name="l01443"></a><a class="code" href="instructions_8cc.html#a7dcb2611baa9683cde3e0a59e6fcf09b">01443</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a7dcb2611baa9683cde3e0a59e6fcf09b">break_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l01444"></a>01444 {
<a name="l01445"></a>01445    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;target  = thread-&gt;<a class="code" href="classptx__thread__info.html#a8db1da1ef0b6144bbe8581d97650a71c">pop_breakaddr</a>();
<a name="l01446"></a>01446    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> target_pc = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(target, target, U32_TYPE, thread, 1);
<a name="l01447"></a>01447 
<a name="l01448"></a>01448    thread-&gt;<a class="code" href="classptx__thread__info.html#a0ed2659f31cfcea6997cca7171bb9d50">m_branch_taken</a> = <span class="keyword">true</span>;
<a name="l01449"></a>01449    thread-&gt;<a class="code" href="classptx__thread__info.html#a4230765ef71b488274911361c34bcef0">set_npc</a>(target_pc);
<a name="l01450"></a>01450 }
<a name="l01451"></a>01451 
<a name="l01452"></a><a class="code" href="instructions_8cc.html#a0f6c4fc7ababa51bbc4aed848411d9e4">01452</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a0f6c4fc7ababa51bbc4aed848411d9e4">breakaddr_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l01453"></a>01453 {
<a name="l01454"></a>01454    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;target  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01455"></a>01455    thread-&gt;<a class="code" href="classptx__thread__info.html#ad6ed611bcf7fc99a4a63cd8b28e24172">push_breakaddr</a>(target);
<a name="l01456"></a>01456    assert(pI-&gt;<a class="code" href="classptx__instruction.html#a4a59a40f681e221e013ff726428c4b1a">has_pred</a>() == <span class="keyword">false</span>); <span class="comment">// pdom analysis cannot handle if this instruction is predicated </span>
<a name="l01457"></a>01457 }
<a name="l01458"></a>01458 
<a name="l01459"></a><a class="code" href="instructions_8cc.html#ad9ffc38acf57af034607445ca1eb1c84">01459</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ad9ffc38acf57af034607445ca1eb1c84">brev_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l01460"></a><a class="code" href="instructions_8cc.html#afe9658aa3985881f6116fdeb27504c14">01460</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#afe9658aa3985881f6116fdeb27504c14">brkpt_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l01461"></a>01461 
<a name="l01462"></a><a class="code" href="instructions_8cc.html#a662cace9b20058cd56353a95ddafbd9a">01462</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a662cace9b20058cd56353a95ddafbd9a">call_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l01463"></a>01463 {
<a name="l01464"></a>01464    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> call_uid_next = 1;
<a name="l01465"></a>01465     
<a name="l01466"></a>01466    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;target  = pI-&gt;<a class="code" href="classptx__instruction.html#a28a02a08a7affb0cd46ae7b2bcf93f3c">func_addr</a>();
<a name="l01467"></a>01467    assert( target.<a class="code" href="classoperand__info.html#a9ba168e040e6e7d6df60d616bff10677">is_function_address</a>() );
<a name="l01468"></a>01468    <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *func_addr = target.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>();
<a name="l01469"></a>01469    <span class="keyword">const</span> <a class="code" href="classfunction__info.html">function_info</a> *target_func = func_addr-&gt;<a class="code" href="classsymbol.html#a66f4cb25e44abd7eddd7cbcfbca52e79">get_pc</a>();
<a name="l01470"></a>01470 
<a name="l01471"></a>01471    <span class="comment">// check that number of args and return match function requirements</span>
<a name="l01472"></a>01472    <span class="keywordflow">if</span>( pI-&gt;<a class="code" href="classptx__instruction.html#ab20205063be738576474d2e288089c0f">has_return</a>() ^ target_func-&gt;<a class="code" href="classfunction__info.html#aa7b0e90a0bd21c8277c9f9fd2d62991d">has_return</a>() ) {
<a name="l01473"></a>01473       printf(<span class="stringliteral">&quot;GPGPU-Sim PTX: Execution error - mismatch in number of return values between\n&quot;</span>
<a name="l01474"></a>01474              <span class="stringliteral">&quot;               call instruction and function declaration\n&quot;</span>);
<a name="l01475"></a>01475       abort(); 
<a name="l01476"></a>01476    }
<a name="l01477"></a>01477    <span class="keywordtype">unsigned</span> n_return = target_func-&gt;<a class="code" href="classfunction__info.html#aa7b0e90a0bd21c8277c9f9fd2d62991d">has_return</a>();
<a name="l01478"></a>01478    <span class="keywordtype">unsigned</span> n_args = target_func-&gt;<a class="code" href="classfunction__info.html#a7509da79744747fc0c1ae6a84b5c32dc">num_args</a>();
<a name="l01479"></a>01479    <span class="keywordtype">unsigned</span> n_operands = pI-&gt;<a class="code" href="classptx__instruction.html#a8c20877db07add4aacd26ce9a183fb2e">get_num_operands</a>();
<a name="l01480"></a>01480 
<a name="l01481"></a>01481    <span class="keywordflow">if</span>( n_operands != (n_return+1+n_args) ) {
<a name="l01482"></a>01482       printf(<span class="stringliteral">&quot;GPGPU-Sim PTX: Execution error - mismatch in number of arguements between\n&quot;</span>
<a name="l01483"></a>01483              <span class="stringliteral">&quot;               call instruction and function declaration\n&quot;</span>);
<a name="l01484"></a>01484       abort(); 
<a name="l01485"></a>01485    }
<a name="l01486"></a>01486 
<a name="l01487"></a>01487    <span class="comment">// handle intrinsic functions</span>
<a name="l01488"></a>01488    std::string fname = target_func-&gt;<a class="code" href="classfunction__info.html#a1c8bf33afe5a0aef76b9109214c96699">get_name</a>();
<a name="l01489"></a>01489    <span class="keywordflow">if</span>( fname == <span class="stringliteral">&quot;vprintf&quot;</span> ) {
<a name="l01490"></a>01490       <a class="code" href="cuda__device__printf_8cc.html#a0943f9dc56c60122faf04e8d2b4b4d4d">gpgpusim_cuda_vprintf</a>(pI, thread, target_func);
<a name="l01491"></a>01491       <span class="keywordflow">return</span>;
<a name="l01492"></a>01492    }
<a name="l01493"></a>01493 
<a name="l01494"></a>01494 <span class="preprocessor">#if (CUDART_VERSION &gt;= 5000)</span>
<a name="l01495"></a>01495 <span class="preprocessor"></span>   <span class="comment">//Jin: handle device runtime apis for CDP</span>
<a name="l01496"></a>01496    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fname == <span class="stringliteral">&quot;cudaGetParameterBufferV2&quot;</span>) {
<a name="l01497"></a>01497       <a class="code" href="cuda__device__runtime_8cc.html#a3718830f38736e205c68969b651b31a9">gpgpusim_cuda_getParameterBufferV2</a>(pI, thread, target_func);
<a name="l01498"></a>01498       <span class="keywordflow">return</span>;
<a name="l01499"></a>01499    }
<a name="l01500"></a>01500    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fname == <span class="stringliteral">&quot;cudaLaunchDeviceV2&quot;</span>) {
<a name="l01501"></a>01501       <a class="code" href="cuda__device__runtime_8cc.html#af73ab2105a3cb69a649458142e6cee91">gpgpusim_cuda_launchDeviceV2</a>(pI, thread, target_func);
<a name="l01502"></a>01502       <span class="keywordflow">return</span>;
<a name="l01503"></a>01503    }
<a name="l01504"></a>01504    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fname == <span class="stringliteral">&quot;cudaStreamCreateWithFlags&quot;</span>) {
<a name="l01505"></a>01505       <a class="code" href="cuda__device__runtime_8cc.html#a4aba24ba352f4e187cf1e565a81efbf1">gpgpusim_cuda_streamCreateWithFlags</a>(pI, thread, target_func);
<a name="l01506"></a>01506       <span class="keywordflow">return</span>;
<a name="l01507"></a>01507    }
<a name="l01508"></a>01508 <span class="preprocessor">#endif</span>
<a name="l01509"></a>01509 <span class="preprocessor"></span>
<a name="l01510"></a>01510    <span class="comment">// read source arguements into register specified in declaration of function</span>
<a name="l01511"></a>01511    <a class="code" href="ptx__ir_8h.html#a74207c78f5f4ddedd01419c633f1504f">arg_buffer_list_t</a> arg_values;
<a name="l01512"></a>01512    <a class="code" href="ptx__ir_8cc.html#a45f909cf764126c874cc008dbf255b12">copy_args_into_buffer_list</a>(pI, thread, target_func, arg_values);
<a name="l01513"></a>01513 
<a name="l01514"></a>01514    <span class="comment">// record local for return value (we only support a single return value)</span>
<a name="l01515"></a>01515    <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *return_var_src = NULL;
<a name="l01516"></a>01516    <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *return_var_dst = NULL;
<a name="l01517"></a>01517    <span class="keywordflow">if</span>( target_func-&gt;<a class="code" href="classfunction__info.html#aa7b0e90a0bd21c8277c9f9fd2d62991d">has_return</a>() ) {
<a name="l01518"></a>01518       return_var_dst = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>().<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>();
<a name="l01519"></a>01519       return_var_src = target_func-&gt;<a class="code" href="classfunction__info.html#a39c03a2aaa78207692b085047dc5294e">get_return_var</a>();
<a name="l01520"></a>01520    }
<a name="l01521"></a>01521 
<a name="l01522"></a>01522    <a class="code" href="classgpgpu__sim.html">gpgpu_sim</a> *gpu = thread-&gt;<a class="code" href="classptx__thread__info.html#a6682377bc58576547b58b9e529721509">get_gpu</a>();
<a name="l01523"></a>01523    <span class="keywordtype">unsigned</span> callee_pc=0, callee_rpc=0;
<a name="l01524"></a>01524    <span class="keywordflow">if</span>( gpu-&gt;<a class="code" href="classgpgpu__sim.html#a1d79c60562b260d25b469179c1f07565">simd_model</a>() == <a class="code" href="abstract__hardware__model_8h.html#a3c3e5c822956df0d19e61cbb11c5b12ba31993dfb97df7a2ea5aa5a9504b96c72">POST_DOMINATOR</a> ) {
<a name="l01525"></a>01525       thread-&gt;<a class="code" href="classptx__thread__info.html#a796b85af201a3988344a40fb1dcb9eef">get_core</a>()-&gt;<a class="code" href="classcore__t.html#af4559dc19ac00b8e3dfb014e94c361e8">get_pdom_stack_top_info</a>(thread-&gt;<a class="code" href="classptx__thread__info.html#a332166a7693077ea467073d2e5925388">get_hw_wid</a>(),&amp;callee_pc,&amp;callee_rpc);
<a name="l01526"></a>01526       assert( callee_pc == thread-&gt;<a class="code" href="classptx__thread__info.html#a41b1e8fab5caac4c85f2e363b5857967">get_pc</a>() );
<a name="l01527"></a>01527    }
<a name="l01528"></a>01528 
<a name="l01529"></a>01529    thread-&gt;<a class="code" href="classptx__thread__info.html#a8146a890c7d538e3973ce721d1a624c6">callstack_push</a>(callee_pc + pI-&gt;<a class="code" href="classptx__instruction.html#ae48319891d1b705a1c1a0d20ed0ae88a">inst_size</a>(), callee_rpc, return_var_src, return_var_dst, call_uid_next++);
<a name="l01530"></a>01530 
<a name="l01531"></a>01531    <a class="code" href="ptx__ir_8cc.html#aba1b66dfc39af5b6dbb93e7cfdc579ae">copy_buffer_list_into_frame</a>(thread, arg_values);
<a name="l01532"></a>01532 
<a name="l01533"></a>01533    thread-&gt;<a class="code" href="classptx__thread__info.html#a4230765ef71b488274911361c34bcef0">set_npc</a>(target_func);
<a name="l01534"></a>01534 }
<a name="l01535"></a>01535 
<a name="l01536"></a>01536 <span class="comment">//Ptxplus version of call instruction. Jumps to a label not a different Kernel.</span>
<a name="l01537"></a><a class="code" href="instructions_8cc.html#ad2f5de6f489d20688659b34abd72eee1">01537</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ad2f5de6f489d20688659b34abd72eee1">callp_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread )
<a name="l01538"></a>01538 {
<a name="l01539"></a>01539    
<a name="l01540"></a>01540    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> call_uid_next = 1;
<a name="l01541"></a>01541 
<a name="l01542"></a>01542    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;target  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01543"></a>01543    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> target_pc = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(target, target, U32_TYPE, thread, 1);
<a name="l01544"></a>01544 
<a name="l01545"></a>01545    <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *return_var_src = NULL;
<a name="l01546"></a>01546    <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *return_var_dst = NULL;
<a name="l01547"></a>01547 
<a name="l01548"></a>01548    <a class="code" href="classgpgpu__sim.html">gpgpu_sim</a> *gpu = thread-&gt;<a class="code" href="classptx__thread__info.html#a6682377bc58576547b58b9e529721509">get_gpu</a>();
<a name="l01549"></a>01549    <span class="keywordtype">unsigned</span> callee_pc=0, callee_rpc=0;
<a name="l01550"></a>01550    <span class="keywordflow">if</span>( gpu-&gt;<a class="code" href="classgpgpu__sim.html#a1d79c60562b260d25b469179c1f07565">simd_model</a>() == <a class="code" href="abstract__hardware__model_8h.html#a3c3e5c822956df0d19e61cbb11c5b12ba31993dfb97df7a2ea5aa5a9504b96c72">POST_DOMINATOR</a> ) {
<a name="l01551"></a>01551       thread-&gt;<a class="code" href="classptx__thread__info.html#a796b85af201a3988344a40fb1dcb9eef">get_core</a>()-&gt;<a class="code" href="classcore__t.html#af4559dc19ac00b8e3dfb014e94c361e8">get_pdom_stack_top_info</a>(thread-&gt;<a class="code" href="classptx__thread__info.html#a332166a7693077ea467073d2e5925388">get_hw_wid</a>(),&amp;callee_pc,&amp;callee_rpc);
<a name="l01552"></a>01552       assert( callee_pc == thread-&gt;<a class="code" href="classptx__thread__info.html#a41b1e8fab5caac4c85f2e363b5857967">get_pc</a>() );
<a name="l01553"></a>01553    } 
<a name="l01554"></a>01554 
<a name="l01555"></a>01555    thread-&gt;<a class="code" href="classptx__thread__info.html#a334cfffa658727f127ec614a60501009">callstack_push_plus</a>(callee_pc + pI-&gt;<a class="code" href="classptx__instruction.html#ae48319891d1b705a1c1a0d20ed0ae88a">inst_size</a>(), callee_rpc, return_var_src, return_var_dst, call_uid_next++);
<a name="l01556"></a>01556    thread-&gt;<a class="code" href="classptx__thread__info.html#a4230765ef71b488274911361c34bcef0">set_npc</a>(target_pc);
<a name="l01557"></a>01557 }
<a name="l01558"></a>01558 
<a name="l01559"></a><a class="code" href="instructions_8cc.html#ae1bc30efb0cfa1e706cc3cec8f6f25ef">01559</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ae1bc30efb0cfa1e706cc3cec8f6f25ef">clz_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread )
<a name="l01560"></a>01560 {
<a name="l01561"></a>01561    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, d;
<a name="l01562"></a>01562    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01563"></a>01563    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l01564"></a>01564 
<a name="l01565"></a>01565    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l01566"></a>01566    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l01567"></a>01567 
<a name="l01568"></a>01568    <span class="keywordtype">int</span> max;
<a name="l01569"></a>01569    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> mask;
<a name="l01570"></a>01570    d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l01571"></a>01571 
<a name="l01572"></a>01572    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l01573"></a>01573    <span class="keywordflow">case</span> B32_TYPE:
<a name="l01574"></a>01574       max = 32;
<a name="l01575"></a>01575       mask = 0x80000000;
<a name="l01576"></a>01576       <span class="keywordflow">break</span>;
<a name="l01577"></a>01577    <span class="keywordflow">case</span> B64_TYPE:
<a name="l01578"></a>01578       max = 64;
<a name="l01579"></a>01579       mask = 0x8000000000000000;
<a name="l01580"></a>01580       <span class="keywordflow">break</span>;
<a name="l01581"></a>01581    <span class="keywordflow">default</span>:
<a name="l01582"></a>01582       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l01583"></a>01583       assert(0);
<a name="l01584"></a>01584       <span class="keywordflow">break</span>;
<a name="l01585"></a>01585    }
<a name="l01586"></a>01586 
<a name="l01587"></a>01587    <span class="keywordflow">while</span> ((d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &lt; max) &amp;&amp; ((a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>&amp;mask) == 0) ) {
<a name="l01588"></a>01588       d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>++;
<a name="l01589"></a>01589       a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &lt;&lt; 1;
<a name="l01590"></a>01590    }
<a name="l01591"></a>01591 
<a name="l01592"></a>01592    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, B32_TYPE, thread, pI);
<a name="l01593"></a>01593 }
<a name="l01594"></a>01594 
<a name="l01595"></a><a class="code" href="instructions_8cc.html#a8f2c7f040f60650f066464276ec59257">01595</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a8f2c7f040f60650f066464276ec59257">cnot_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l01596"></a>01596 { 
<a name="l01597"></a>01597    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b, d;
<a name="l01598"></a>01598    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01599"></a>01599    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l01600"></a>01600 
<a name="l01601"></a>01601    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l01602"></a>01602    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l01603"></a>01603 
<a name="l01604"></a>01604    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l01605"></a>01605    <span class="keywordflow">case</span> PRED_TYPE: d.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = ((a.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x0001) == 0)?1:0; <span class="keywordflow">break</span>;
<a name="l01606"></a>01606    <span class="keywordflow">case</span> B16_TYPE:  d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>  = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>  == 0)?1:0; <span class="keywordflow">break</span>;
<a name="l01607"></a>01607    <span class="keywordflow">case</span> B32_TYPE:  d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>  = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>  == 0)?1:0; <span class="keywordflow">break</span>;
<a name="l01608"></a>01608    <span class="keywordflow">case</span> B64_TYPE:  d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>  = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>  == 0)?1:0; <span class="keywordflow">break</span>;
<a name="l01609"></a>01609    <span class="keywordflow">default</span>:
<a name="l01610"></a>01610       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l01611"></a>01611       assert(0);
<a name="l01612"></a>01612       <span class="keywordflow">break</span>;
<a name="l01613"></a>01613    }
<a name="l01614"></a>01614 
<a name="l01615"></a>01615    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l01616"></a>01616 }
<a name="l01617"></a>01617 
<a name="l01618"></a><a class="code" href="instructions_8cc.html#aa240feeef6705561dabca7a5799645b2">01618</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aa240feeef6705561dabca7a5799645b2">cos_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l01619"></a>01619 {
<a name="l01620"></a>01620    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, d;
<a name="l01621"></a>01621    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l01622"></a>01622    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l01623"></a>01623 
<a name="l01624"></a>01624    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l01625"></a>01625    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l01626"></a>01626 
<a name="l01627"></a>01627 
<a name="l01628"></a>01628    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l01629"></a>01629    <span class="keywordflow">case</span> F32_TYPE: 
<a name="l01630"></a>01630       d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = cos(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>);
<a name="l01631"></a>01631       <span class="keywordflow">break</span>;
<a name="l01632"></a>01632    <span class="keywordflow">default</span>:
<a name="l01633"></a>01633       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l01634"></a>01634       assert(0); 
<a name="l01635"></a>01635       <span class="keywordflow">break</span>;
<a name="l01636"></a>01636    }
<a name="l01637"></a>01637 
<a name="l01638"></a>01638    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l01639"></a>01639 }
<a name="l01640"></a>01640 
<a name="l01641"></a><a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">01641</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode )
<a name="l01642"></a>01642 {
<a name="l01643"></a>01643    <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01644"></a>01644    <span class="keywordflow">case</span> 8:  x.<a class="code" href="unionptx__reg__t.html#a23976dac81955f39a31589f47a51d6c9">mask_and</a>(0,0xFF);  <span class="keywordflow">break</span>;
<a name="l01645"></a>01645    <span class="keywordflow">case</span> 16: x.<a class="code" href="unionptx__reg__t.html#a23976dac81955f39a31589f47a51d6c9">mask_and</a>(0,0xFFFF);      <span class="keywordflow">break</span>;
<a name="l01646"></a>01646    <span class="keywordflow">case</span> 32: x.<a class="code" href="unionptx__reg__t.html#a23976dac81955f39a31589f47a51d6c9">mask_and</a>(0,0xFFFFFFFF);  <span class="keywordflow">break</span>;
<a name="l01647"></a>01647    <span class="keywordflow">case</span> 64: <span class="keywordflow">break</span>;
<a name="l01648"></a>01648    <span class="keywordflow">default</span>: assert(0);
<a name="l01649"></a>01649    }
<a name="l01650"></a>01650    <span class="keywordflow">return</span> x;
<a name="l01651"></a>01651 }
<a name="l01652"></a>01652 
<a name="l01653"></a><a class="code" href="instructions_8cc.html#a4fea4e976bf45fc9b550b55cd6fe961f">01653</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#a4fea4e976bf45fc9b550b55cd6fe961f">sext</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode )
<a name="l01654"></a>01654 {
<a name="l01655"></a>01655    x=<a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>(x,0,from_width,0,rounding_mode,saturation_mode);
<a name="l01656"></a>01656    <span class="keywordflow">switch</span> ( from_width ) {
<a name="l01657"></a>01657    <span class="keywordflow">case</span> 8: <span class="keywordflow">if</span> ( x.<a class="code" href="unionptx__reg__t.html#a60262c4edbe94dd898204d75e0dc8cca">get_bit</a>(7) ) x.<a class="code" href="unionptx__reg__t.html#abfd73db3b07b7207e92fda21ef8914f4">mask_or</a>(0xFFFFFFFF,0xFFFFFF00);<span class="keywordflow">break</span>;
<a name="l01658"></a>01658    <span class="keywordflow">case</span> 16:<span class="keywordflow">if</span> ( x.<a class="code" href="unionptx__reg__t.html#a60262c4edbe94dd898204d75e0dc8cca">get_bit</a>(15) ) x.<a class="code" href="unionptx__reg__t.html#abfd73db3b07b7207e92fda21ef8914f4">mask_or</a>(0xFFFFFFFF,0xFFFF0000);<span class="keywordflow">break</span>;
<a name="l01659"></a>01659    <span class="keywordflow">case</span> 32: <span class="keywordflow">if</span> ( x.<a class="code" href="unionptx__reg__t.html#a60262c4edbe94dd898204d75e0dc8cca">get_bit</a>(31) ) x.<a class="code" href="unionptx__reg__t.html#abfd73db3b07b7207e92fda21ef8914f4">mask_or</a>(0xFFFFFFFF,0x00000000);<span class="keywordflow">break</span>;
<a name="l01660"></a>01660    <span class="keywordflow">case</span> 64: <span class="keywordflow">break</span>;
<a name="l01661"></a>01661    <span class="keywordflow">default</span>: assert(0);
<a name="l01662"></a>01662    }
<a name="l01663"></a>01663    <span class="keywordflow">return</span> x;
<a name="l01664"></a>01664 }
<a name="l01665"></a>01665 
<a name="l01666"></a>01666 <span class="comment">// sign extend depending on the destination register size - hack to get SobelFilter working in CUDA 4.2</span>
<a name="l01667"></a><a class="code" href="instructions_8cc.html#aa1e532b99e1e81b57899a18f7c8c864b">01667</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#aa1e532b99e1e81b57899a18f7c8c864b">sexd</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode )
<a name="l01668"></a>01668 {
<a name="l01669"></a>01669    x=<a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>(x,0,from_width,0,rounding_mode,saturation_mode);
<a name="l01670"></a>01670    <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01671"></a>01671    <span class="keywordflow">case</span> 8: <span class="keywordflow">if</span> ( x.<a class="code" href="unionptx__reg__t.html#a60262c4edbe94dd898204d75e0dc8cca">get_bit</a>(7) ) x.<a class="code" href="unionptx__reg__t.html#abfd73db3b07b7207e92fda21ef8914f4">mask_or</a>(0xFFFFFFFF,0xFFFFFF00);<span class="keywordflow">break</span>;
<a name="l01672"></a>01672    <span class="keywordflow">case</span> 16:<span class="keywordflow">if</span> ( x.<a class="code" href="unionptx__reg__t.html#a60262c4edbe94dd898204d75e0dc8cca">get_bit</a>(15) ) x.<a class="code" href="unionptx__reg__t.html#abfd73db3b07b7207e92fda21ef8914f4">mask_or</a>(0xFFFFFFFF,0xFFFF0000);<span class="keywordflow">break</span>;
<a name="l01673"></a>01673    <span class="keywordflow">case</span> 32: <span class="keywordflow">if</span> ( x.<a class="code" href="unionptx__reg__t.html#a60262c4edbe94dd898204d75e0dc8cca">get_bit</a>(31) ) x.<a class="code" href="unionptx__reg__t.html#abfd73db3b07b7207e92fda21ef8914f4">mask_or</a>(0xFFFFFFFF,0x00000000);<span class="keywordflow">break</span>;
<a name="l01674"></a>01674    <span class="keywordflow">case</span> 64: <span class="keywordflow">break</span>;
<a name="l01675"></a>01675    <span class="keywordflow">default</span>: assert(0);
<a name="l01676"></a>01676    }
<a name="l01677"></a>01677    <span class="keywordflow">return</span> x;
<a name="l01678"></a>01678 }
<a name="l01679"></a>01679 
<a name="l01680"></a><a class="code" href="instructions_8cc.html#ac7b890b8cafb4712ad85cd00cfd317b7">01680</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#ac7b890b8cafb4712ad85cd00cfd317b7">zext</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode )
<a name="l01681"></a>01681 {
<a name="l01682"></a>01682    <span class="keywordflow">return</span> <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>(x,0,from_width,0,rounding_mode,saturation_mode);
<a name="l01683"></a>01683 }
<a name="l01684"></a>01684 
<a name="l01685"></a><a class="code" href="instructions_8cc.html#a7880995635e8bf2e215644299c08ebc9">01685</a> <span class="keywordtype">int</span> <a class="code" href="instructions_8cc.html#a7880995635e8bf2e215644299c08ebc9">saturatei</a>(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> max, <span class="keywordtype">int</span> min) 
<a name="l01686"></a>01686 {
<a name="l01687"></a>01687    <span class="keywordflow">if</span> (a &gt; max) a = max;
<a name="l01688"></a>01688    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a &lt; min) a = min;
<a name="l01689"></a>01689    <span class="keywordflow">return</span> a;
<a name="l01690"></a>01690 }
<a name="l01691"></a>01691 
<a name="l01692"></a><a class="code" href="instructions_8cc.html#afc7f4f306bf8a159d8f877ead28e14e5">01692</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="instructions_8cc.html#a7880995635e8bf2e215644299c08ebc9">saturatei</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> a, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max) 
<a name="l01693"></a>01693 {
<a name="l01694"></a>01694    <span class="keywordflow">if</span> (a &gt; max) a = max;
<a name="l01695"></a>01695    <span class="keywordflow">return</span> a;
<a name="l01696"></a>01696 }
<a name="l01697"></a>01697 
<a name="l01698"></a><a class="code" href="instructions_8cc.html#a255be8c89f143df742ea2b1b5f57de66">01698</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#a255be8c89f143df742ea2b1b5f57de66">f2x</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode )
<a name="l01699"></a>01699 {
<a name="l01700"></a>01700    assert( from_width == 32); 
<a name="l01701"></a>01701 
<a name="l01702"></a>01702    <span class="keyword">enum</span> cuda_math::cudaRoundMode mode = cuda_math::cudaRoundZero;
<a name="l01703"></a>01703    <span class="keywordflow">switch</span> (rounding_mode) {
<a name="l01704"></a>01704    <span class="keywordflow">case</span> RZI_OPTION: mode = cuda_math::cudaRoundZero;    <span class="keywordflow">break</span>;
<a name="l01705"></a>01705    <span class="keywordflow">case</span> RNI_OPTION: mode = cuda_math::cudaRoundNearest; <span class="keywordflow">break</span>;
<a name="l01706"></a>01706    <span class="keywordflow">case</span> RMI_OPTION: mode = cuda_math::cudaRoundMinInf;  <span class="keywordflow">break</span>;
<a name="l01707"></a>01707    <span class="keywordflow">case</span> RPI_OPTION: mode = cuda_math::cudaRoundPosInf;  <span class="keywordflow">break</span>;
<a name="l01708"></a>01708    <span class="keywordflow">default</span>: <span class="keywordflow">break</span>; 
<a name="l01709"></a>01709    }
<a name="l01710"></a>01710 
<a name="l01711"></a>01711    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> y;
<a name="l01712"></a>01712    <span class="keywordflow">if</span> ( to_sign == 1 ) { <span class="comment">// convert to 64-bit number first?</span>
<a name="l01713"></a>01713       <span class="keywordtype">int</span> tmp = <a class="code" href="namespacecuda__math.html#aa1cff99f5a4d341988ca79f1d42d5b09">cuda_math::float2int</a>(x.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>, mode);
<a name="l01714"></a>01714       <span class="keywordflow">if</span> ((x.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; 0x7f800000) == 0)
<a name="l01715"></a>01715          tmp = 0; <span class="comment">// round denorm. FP to 0</span>
<a name="l01716"></a>01716       <span class="keywordflow">if</span> (saturation_mode &amp;&amp; to_width &lt; 32) {
<a name="l01717"></a>01717          tmp = <a class="code" href="instructions_8cc.html#a7880995635e8bf2e215644299c08ebc9">saturatei</a>(tmp, (1&lt;&lt;to_width) - 1, -(1&lt;&lt;to_width));
<a name="l01718"></a>01718       }
<a name="l01719"></a>01719       <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01720"></a>01720       <span class="keywordflow">case</span> 8:  y.<a class="code" href="unionptx__reg__t.html#aeb61f4c697e957e4716283c63de5a149">s8</a>  = (char)tmp; <span class="keywordflow">break</span>;
<a name="l01721"></a>01721       <span class="keywordflow">case</span> 16: y.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = (short)tmp; <span class="keywordflow">break</span>;
<a name="l01722"></a>01722       <span class="keywordflow">case</span> 32: y.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = (<a class="code" href="classint.html">int</a>)tmp; <span class="keywordflow">break</span>;
<a name="l01723"></a>01723       <span class="keywordflow">case</span> 64: y.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (<span class="keywordtype">long</span> long)tmp; <span class="keywordflow">break</span>;
<a name="l01724"></a>01724       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l01725"></a>01725       }
<a name="l01726"></a>01726    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( to_sign == 0 ) {
<a name="l01727"></a>01727       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp = <a class="code" href="namespacecuda__math.html#a6f6e17bf80de2c14b44921f25bc7bf0d">cuda_math::float2uint</a>(x.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>, mode);
<a name="l01728"></a>01728       <span class="keywordflow">if</span> ((x.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; 0x7f800000) == 0)
<a name="l01729"></a>01729          tmp = 0; <span class="comment">// round denorm. FP to 0</span>
<a name="l01730"></a>01730       <span class="keywordflow">if</span> (saturation_mode &amp;&amp; to_width &lt; 32) {
<a name="l01731"></a>01731          tmp = <a class="code" href="instructions_8cc.html#a7880995635e8bf2e215644299c08ebc9">saturatei</a>(tmp, (1&lt;&lt;to_width) - 1);
<a name="l01732"></a>01732       }
<a name="l01733"></a>01733       <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01734"></a>01734       <span class="keywordflow">case</span> 8:  y.<a class="code" href="unionptx__reg__t.html#ae370e49ce48a8795e1214b80f807f03e">u8</a>  = (<span class="keywordtype">unsigned</span> char)tmp; <span class="keywordflow">break</span>;
<a name="l01735"></a>01735       <span class="keywordflow">case</span> 16: y.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = (<span class="keywordtype">unsigned</span> short)tmp; <span class="keywordflow">break</span>;
<a name="l01736"></a>01736       <span class="keywordflow">case</span> 32: y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = (<span class="keywordtype">unsigned</span> <a class="code" href="classint.html">int</a>)tmp; <span class="keywordflow">break</span>;
<a name="l01737"></a>01737       <span class="keywordflow">case</span> 64: y.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long)tmp; <span class="keywordflow">break</span>;
<a name="l01738"></a>01738       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l01739"></a>01739       }
<a name="l01740"></a>01740    } <span class="keywordflow">else</span> {
<a name="l01741"></a>01741       <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01742"></a>01742       <span class="keywordflow">case</span> 16: assert(0); <span class="keywordflow">break</span>;
<a name="l01743"></a>01743       <span class="keywordflow">case</span> 32: assert(0); <span class="keywordflow">break</span>; <span class="comment">// handled by f2f</span>
<a name="l01744"></a>01744       <span class="keywordflow">case</span> 64: 
<a name="l01745"></a>01745          y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = x.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>; 
<a name="l01746"></a>01746          <span class="keywordflow">break</span>;
<a name="l01747"></a>01747       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l01748"></a>01748       }
<a name="l01749"></a>01749    }
<a name="l01750"></a>01750    <span class="keywordflow">return</span> y;
<a name="l01751"></a>01751 }
<a name="l01752"></a>01752 
<a name="l01753"></a><a class="code" href="instructions_8cc.html#a84f00631dba0ade4c426365e97a3322a">01753</a> <span class="keywordtype">double</span> <a class="code" href="instructions_8cc.html#a84f00631dba0ade4c426365e97a3322a">saturated2i</a> (<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> max, <span class="keywordtype">double</span> min) {
<a name="l01754"></a>01754    <span class="keywordflow">if</span> (a &gt; max) a = max;
<a name="l01755"></a>01755    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a &lt; min) a = min;
<a name="l01756"></a>01756    <span class="keywordflow">return</span> a;
<a name="l01757"></a>01757 }
<a name="l01758"></a>01758 
<a name="l01759"></a><a class="code" href="instructions_8cc.html#a3e030625ed4cf77db723ad8cb7688c11">01759</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#a3e030625ed4cf77db723ad8cb7688c11">d2x</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode )
<a name="l01760"></a>01760 {
<a name="l01761"></a>01761    assert( from_width == 64); 
<a name="l01762"></a>01762 
<a name="l01763"></a>01763    <span class="keywordtype">double</span> tmp;
<a name="l01764"></a>01764    <span class="keywordflow">switch</span> (rounding_mode) {
<a name="l01765"></a>01765    <span class="keywordflow">case</span> RZI_OPTION: tmp = trunc(x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>);     <span class="keywordflow">break</span>;
<a name="l01766"></a>01766    <span class="keywordflow">case</span> RNI_OPTION: tmp = nearbyint(x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l01767"></a>01767    <span class="keywordflow">case</span> RMI_OPTION: tmp = floor(x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>);     <span class="keywordflow">break</span>;
<a name="l01768"></a>01768    <span class="keywordflow">case</span> RPI_OPTION: tmp = ceil(x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>);      <span class="keywordflow">break</span>;
<a name="l01769"></a>01769    <span class="keywordflow">default</span>: tmp = x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>; <span class="keywordflow">break</span>; 
<a name="l01770"></a>01770    }
<a name="l01771"></a>01771 
<a name="l01772"></a>01772    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> y;
<a name="l01773"></a>01773    <span class="keywordflow">if</span> ( to_sign == 1 ) {
<a name="l01774"></a>01774       tmp = <a class="code" href="instructions_8cc.html#a84f00631dba0ade4c426365e97a3322a">saturated2i</a>(tmp, ((1&lt;&lt;(to_width - 1)) - 1), (1&lt;&lt;(to_width - 1)) );
<a name="l01775"></a>01775       <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01776"></a>01776       <span class="keywordflow">case</span> 8:  y.<a class="code" href="unionptx__reg__t.html#aeb61f4c697e957e4716283c63de5a149">s8</a>  = (char)tmp; <span class="keywordflow">break</span>;
<a name="l01777"></a>01777       <span class="keywordflow">case</span> 16: y.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = (short)tmp; <span class="keywordflow">break</span>;
<a name="l01778"></a>01778       <span class="keywordflow">case</span> 32: y.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = (<a class="code" href="classint.html">int</a>)tmp; <span class="keywordflow">break</span>;
<a name="l01779"></a>01779       <span class="keywordflow">case</span> 64: y.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (<span class="keywordtype">long</span> long)tmp; <span class="keywordflow">break</span>;
<a name="l01780"></a>01780       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l01781"></a>01781       }
<a name="l01782"></a>01782    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( to_sign == 0 ) {
<a name="l01783"></a>01783       tmp = <a class="code" href="instructions_8cc.html#a84f00631dba0ade4c426365e97a3322a">saturated2i</a>(tmp, ((1&lt;&lt;(to_width - 1)) - 1), 0);
<a name="l01784"></a>01784       <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01785"></a>01785       <span class="keywordflow">case</span> 8:  y.<a class="code" href="unionptx__reg__t.html#ae370e49ce48a8795e1214b80f807f03e">u8</a>  = (<span class="keywordtype">unsigned</span> char)tmp; <span class="keywordflow">break</span>;
<a name="l01786"></a>01786       <span class="keywordflow">case</span> 16: y.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = (<span class="keywordtype">unsigned</span> short)tmp; <span class="keywordflow">break</span>;
<a name="l01787"></a>01787       <span class="keywordflow">case</span> 32: y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = (<span class="keywordtype">unsigned</span> <a class="code" href="classint.html">int</a>)tmp; <span class="keywordflow">break</span>;
<a name="l01788"></a>01788       <span class="keywordflow">case</span> 64: y.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long)tmp; <span class="keywordflow">break</span>;
<a name="l01789"></a>01789       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l01790"></a>01790       }
<a name="l01791"></a>01791    } <span class="keywordflow">else</span> {
<a name="l01792"></a>01792       <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01793"></a>01793       <span class="keywordflow">case</span> 16: assert(0); <span class="keywordflow">break</span>;
<a name="l01794"></a>01794       <span class="keywordflow">case</span> 32:
<a name="l01795"></a>01795          y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>;  
<a name="l01796"></a>01796          <span class="keywordflow">break</span>;
<a name="l01797"></a>01797       <span class="keywordflow">case</span> 64: 
<a name="l01798"></a>01798          y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>; <span class="comment">// should be handled by d2d</span>
<a name="l01799"></a>01799          <span class="keywordflow">break</span>;
<a name="l01800"></a>01800       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l01801"></a>01801       }
<a name="l01802"></a>01802    }
<a name="l01803"></a>01803    <span class="keywordflow">return</span> y;
<a name="l01804"></a>01804 }
<a name="l01805"></a>01805 
<a name="l01806"></a><a class="code" href="instructions_8cc.html#a601270898045111d46c7b6ea730f65bb">01806</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#a601270898045111d46c7b6ea730f65bb">s2f</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode )
<a name="l01807"></a>01807 {
<a name="l01808"></a>01808    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> y;
<a name="l01809"></a>01809 
<a name="l01810"></a>01810    <span class="keywordflow">if</span> (from_width &lt; 64) { <span class="comment">// 32-bit conversion</span>
<a name="l01811"></a>01811       y = <a class="code" href="instructions_8cc.html#a4fea4e976bf45fc9b550b55cd6fe961f">sext</a>(x,from_width,32,0,rounding_mode,saturation_mode);
<a name="l01812"></a>01812 
<a name="l01813"></a>01813       <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01814"></a>01814       <span class="keywordflow">case</span> 16: assert(0); <span class="keywordflow">break</span>;
<a name="l01815"></a>01815       <span class="keywordflow">case</span> 32: 
<a name="l01816"></a>01816          <span class="keywordflow">switch</span> (rounding_mode) {
<a name="l01817"></a>01817          <span class="keywordflow">case</span> RZ_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a0c8b052de83903ee7801e14afeedfe63">cuda_math::__int2float_rz</a>(y.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l01818"></a>01818          <span class="keywordflow">case</span> RN_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a98e731c588bc2dcc9bee4fbd5ec10f6a">cuda_math::__int2float_rn</a>(y.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l01819"></a>01819          <span class="keywordflow">case</span> RM_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a7c569033dbaa4dca0c368fd92e4dacd3">cuda_math::__int2float_rd</a>(y.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l01820"></a>01820          <span class="keywordflow">case</span> RP_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#ac395a6927aa05ebe6ae5c5d1e54cdc14">cuda_math::__int2float_ru</a>(y.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l01821"></a>01821          <span class="keywordflow">default</span>: <span class="keywordflow">break</span>; 
<a name="l01822"></a>01822          }
<a name="l01823"></a>01823          <span class="keywordflow">break</span>;
<a name="l01824"></a>01824       <span class="keywordflow">case</span> 64: y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = y.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>; <span class="keywordflow">break</span>; <span class="comment">// no rounding needed</span>
<a name="l01825"></a>01825       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l01826"></a>01826       }
<a name="l01827"></a>01827    } <span class="keywordflow">else</span> {
<a name="l01828"></a>01828       <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01829"></a>01829       <span class="keywordflow">case</span> 16: assert(0); <span class="keywordflow">break</span>;
<a name="l01830"></a>01830       <span class="keywordflow">case</span> 32: 
<a name="l01831"></a>01831          <span class="keywordflow">switch</span> (rounding_mode) {
<a name="l01832"></a>01832          <span class="keywordflow">case</span> RZ_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#ab0afa0bc2deb74fc211f215b9a359fad">cuda_math::__ll2float_rz</a>(y.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>; 
<a name="l01833"></a>01833          <span class="keywordflow">case</span> RN_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#af1573dd55af46672b351bfd2895904bf">cuda_math::__ll2float_rn</a>(y.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l01834"></a>01834          <span class="keywordflow">case</span> RM_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a6c60530294fab5baac0964d95fca8057">cuda_math::__ll2float_rd</a>(y.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>; 
<a name="l01835"></a>01835          <span class="keywordflow">case</span> RP_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a135fd86250c0cdacff73be92b21534f1">cuda_math::__ll2float_ru</a>(y.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l01836"></a>01836          <span class="keywordflow">default</span>: <span class="keywordflow">break</span>; 
<a name="l01837"></a>01837          }
<a name="l01838"></a>01838          <span class="keywordflow">break</span>;
<a name="l01839"></a>01839       <span class="keywordflow">case</span> 64: y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = y.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>; <span class="keywordflow">break</span>; <span class="comment">// no internal implementation found</span>
<a name="l01840"></a>01840       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l01841"></a>01841       }
<a name="l01842"></a>01842    }
<a name="l01843"></a>01843 
<a name="l01844"></a>01844    <span class="comment">// saturating an integer to 1 or 0?</span>
<a name="l01845"></a>01845    <span class="keywordflow">return</span> y;
<a name="l01846"></a>01846 }
<a name="l01847"></a>01847 
<a name="l01848"></a><a class="code" href="instructions_8cc.html#aa01476ee60c23d2ca33338b157e56344">01848</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#aa01476ee60c23d2ca33338b157e56344">u2f</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode )
<a name="l01849"></a>01849 {
<a name="l01850"></a>01850    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> y;
<a name="l01851"></a>01851 
<a name="l01852"></a>01852    <span class="keywordflow">if</span> (from_width &lt; 64) { <span class="comment">// 32-bit conversion</span>
<a name="l01853"></a>01853       y = <a class="code" href="instructions_8cc.html#ac7b890b8cafb4712ad85cd00cfd317b7">zext</a>(x,from_width,32,0,rounding_mode,saturation_mode);
<a name="l01854"></a>01854 
<a name="l01855"></a>01855       <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01856"></a>01856       <span class="keywordflow">case</span> 16: assert(0); <span class="keywordflow">break</span>;
<a name="l01857"></a>01857       <span class="keywordflow">case</span> 32: 
<a name="l01858"></a>01858          <span class="keywordflow">switch</span> (rounding_mode) {
<a name="l01859"></a>01859          <span class="keywordflow">case</span> RZ_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#af484bd10fdecfc5247e4789254b6078e">cuda_math::__uint2float_rz</a>(y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l01860"></a>01860          <span class="keywordflow">case</span> RN_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a04b37e8e22f27a35017bf76a98e5532f">cuda_math::__uint2float_rn</a>(y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l01861"></a>01861          <span class="keywordflow">case</span> RM_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a0d5c9a59a4ebd6e72cdecb4b0844f190">cuda_math::__uint2float_rd</a>(y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l01862"></a>01862          <span class="keywordflow">case</span> RP_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a5181e14ef21462e4c83691b7c705c26e">cuda_math::__uint2float_ru</a>(y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l01863"></a>01863          <span class="keywordflow">default</span>: <span class="keywordflow">break</span>; 
<a name="l01864"></a>01864          }
<a name="l01865"></a>01865          <span class="keywordflow">break</span>;
<a name="l01866"></a>01866       <span class="keywordflow">case</span> 64: y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>; <span class="keywordflow">break</span>; <span class="comment">// no rounding needed</span>
<a name="l01867"></a>01867       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l01868"></a>01868       }
<a name="l01869"></a>01869    } <span class="keywordflow">else</span> {
<a name="l01870"></a>01870       <span class="keywordflow">switch</span> ( to_width ) {
<a name="l01871"></a>01871       <span class="keywordflow">case</span> 16: assert(0); <span class="keywordflow">break</span>;
<a name="l01872"></a>01872       <span class="keywordflow">case</span> 32: 
<a name="l01873"></a>01873          <span class="keywordflow">switch</span> (rounding_mode) {
<a name="l01874"></a>01874          <span class="keywordflow">case</span> RZ_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a372ac05a70fa53580867de4e1e34f002">cuda_math::__ull2float_rn</a>(y.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>; 
<a name="l01875"></a>01875          <span class="keywordflow">case</span> RN_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a372ac05a70fa53580867de4e1e34f002">cuda_math::__ull2float_rn</a>(y.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l01876"></a>01876          <span class="keywordflow">case</span> RM_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a372ac05a70fa53580867de4e1e34f002">cuda_math::__ull2float_rn</a>(y.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>; 
<a name="l01877"></a>01877          <span class="keywordflow">case</span> RP_OPTION: y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a372ac05a70fa53580867de4e1e34f002">cuda_math::__ull2float_rn</a>(y.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>; 
<a name="l01878"></a>01878          <span class="keywordflow">default</span>: <span class="keywordflow">break</span>; 
<a name="l01879"></a>01879          }
<a name="l01880"></a>01880          <span class="keywordflow">break</span>;
<a name="l01881"></a>01881       <span class="keywordflow">case</span> 64: y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = y.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>; <span class="keywordflow">break</span>; <span class="comment">// no internal implementation found</span>
<a name="l01882"></a>01882       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l01883"></a>01883       }
<a name="l01884"></a>01884    }
<a name="l01885"></a>01885 
<a name="l01886"></a>01886    <span class="comment">// saturating an integer to 1 or 0?</span>
<a name="l01887"></a>01887    <span class="keywordflow">return</span> y;
<a name="l01888"></a>01888 }
<a name="l01889"></a>01889 
<a name="l01890"></a><a class="code" href="instructions_8cc.html#ad05b38b1d5e3c8d21673d659c432d8cd">01890</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#ad05b38b1d5e3c8d21673d659c432d8cd">f2f</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode )
<a name="l01891"></a>01891 {
<a name="l01892"></a>01892    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> y;
<a name="l01893"></a>01893    <span class="keywordflow">switch</span> ( rounding_mode ) {
<a name="l01894"></a>01894    <span class="keywordflow">case</span> RZI_OPTION: 
<a name="l01895"></a>01895       y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = truncf(x.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); 
<a name="l01896"></a>01896       <span class="keywordflow">break</span>;          
<a name="l01897"></a>01897    <span class="keywordflow">case</span> RNI_OPTION: 
<a name="l01898"></a>01898 <span class="preprocessor">#if CUDART_VERSION &gt;= 3000</span>
<a name="l01899"></a>01899 <span class="preprocessor"></span>      y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = nearbyintf(x.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); 
<a name="l01900"></a>01900 <span class="preprocessor">#else</span>
<a name="l01901"></a>01901 <span class="preprocessor"></span>      y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = cuda_math::__internal_nearbyintf(x.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); 
<a name="l01902"></a>01902 <span class="preprocessor">#endif</span>
<a name="l01903"></a>01903 <span class="preprocessor"></span>      <span class="keywordflow">break</span>;          
<a name="l01904"></a>01904    <span class="keywordflow">case</span> RMI_OPTION: 
<a name="l01905"></a>01905       <span class="keywordflow">if</span> ((x.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; 0x7f800000) == 0) {
<a name="l01906"></a>01906          y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = x.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; 0x80000000; <span class="comment">// round denorm. FP to 0, keeping sign</span>
<a name="l01907"></a>01907       } <span class="keywordflow">else</span> {
<a name="l01908"></a>01908          y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = floorf(x.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); 
<a name="l01909"></a>01909       }
<a name="l01910"></a>01910       <span class="keywordflow">break</span>;          
<a name="l01911"></a>01911    <span class="keywordflow">case</span> RPI_OPTION: 
<a name="l01912"></a>01912       <span class="keywordflow">if</span> ((x.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; 0x7f800000) == 0) {
<a name="l01913"></a>01913          y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = x.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; 0x80000000; <span class="comment">// round denorm. FP to 0, keeping sign</span>
<a name="l01914"></a>01914       } <span class="keywordflow">else</span> {
<a name="l01915"></a>01915          y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = ceilf(x.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); 
<a name="l01916"></a>01916       }
<a name="l01917"></a>01917       <span class="keywordflow">break</span>;          
<a name="l01918"></a>01918    <span class="keywordflow">default</span>: 
<a name="l01919"></a>01919       <span class="keywordflow">if</span> ((x.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; 0x7f800000) == 0) {
<a name="l01920"></a>01920          y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = x.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &amp; 0x80000000; <span class="comment">// round denorm. FP to 0, keeping sign</span>
<a name="l01921"></a>01921       } <span class="keywordflow">else</span> {
<a name="l01922"></a>01922          y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = x.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>;
<a name="l01923"></a>01923       }
<a name="l01924"></a>01924       <span class="keywordflow">break</span>; 
<a name="l01925"></a>01925    }
<a name="l01926"></a>01926 <span class="preprocessor">#if CUDART_VERSION &gt;= 3000</span>
<a name="l01927"></a>01927 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="cuda-math_8h.html#a586dc89529b75ca3fe6cd98d69d2aff3">isnanf</a>(y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>)) 
<a name="l01928"></a>01928 <span class="preprocessor">#else</span>
<a name="l01929"></a>01929 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (cuda_math::__cuda___isnanf(y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>)) 
<a name="l01930"></a>01930 <span class="preprocessor">#endif</span>
<a name="l01931"></a>01931 <span class="preprocessor"></span>   {
<a name="l01932"></a>01932       y.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0x7fffffff;
<a name="l01933"></a>01933    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (saturation_mode) {
<a name="l01934"></a>01934       y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a80bedbc30874fac1ec02a3aaf33317a2">cuda_math::__saturatef</a>(y.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>);
<a name="l01935"></a>01935    }
<a name="l01936"></a>01936 
<a name="l01937"></a>01937    <span class="keywordflow">return</span> y;
<a name="l01938"></a>01938 }
<a name="l01939"></a>01939 
<a name="l01940"></a><a class="code" href="instructions_8cc.html#a4c2ce15388ed3fc3d0b5a03e2592c440">01940</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#a4c2ce15388ed3fc3d0b5a03e2592c440">d2d</a>( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode )
<a name="l01941"></a>01941 {
<a name="l01942"></a>01942    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> y;
<a name="l01943"></a>01943    <span class="keywordflow">switch</span> ( rounding_mode ) {
<a name="l01944"></a>01944    <span class="keywordflow">case</span> RZI_OPTION: 
<a name="l01945"></a>01945       y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = trunc(x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); 
<a name="l01946"></a>01946       <span class="keywordflow">break</span>;          
<a name="l01947"></a>01947    <span class="keywordflow">case</span> RNI_OPTION: 
<a name="l01948"></a>01948 <span class="preprocessor">#if CUDART_VERSION &gt;= 3000</span>
<a name="l01949"></a>01949 <span class="preprocessor"></span>      y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = nearbyint(x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); 
<a name="l01950"></a>01950 <span class="preprocessor">#else</span>
<a name="l01951"></a>01951 <span class="preprocessor"></span>      y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = cuda_math::__internal_nearbyintf(x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); 
<a name="l01952"></a>01952 <span class="preprocessor">#endif</span>
<a name="l01953"></a>01953 <span class="preprocessor"></span>      <span class="keywordflow">break</span>;          
<a name="l01954"></a>01954    <span class="keywordflow">case</span> RMI_OPTION: 
<a name="l01955"></a>01955       y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = floor(x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); 
<a name="l01956"></a>01956       <span class="keywordflow">break</span>;          
<a name="l01957"></a>01957    <span class="keywordflow">case</span> RPI_OPTION: 
<a name="l01958"></a>01958       y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = ceil(x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); 
<a name="l01959"></a>01959       <span class="keywordflow">break</span>;          
<a name="l01960"></a>01960    <span class="keywordflow">default</span>: 
<a name="l01961"></a>01961       y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = x.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>;
<a name="l01962"></a>01962       <span class="keywordflow">break</span>; 
<a name="l01963"></a>01963    }
<a name="l01964"></a>01964    <span class="keywordflow">if</span> (isnan(y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>)) {
<a name="l01965"></a>01965       y.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0xfff8000000000000ull;
<a name="l01966"></a>01966    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (saturation_mode) {
<a name="l01967"></a>01967       y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = <a class="code" href="namespacecuda__math.html#a80bedbc30874fac1ec02a3aaf33317a2">cuda_math::__saturatef</a>(y.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); 
<a name="l01968"></a>01968    }
<a name="l01969"></a>01969    <span class="keywordflow">return</span> y;
<a name="l01970"></a>01970 }
<a name="l01971"></a>01971 
<a name="l01972"></a>01972 <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> (*<a class="code" href="instructions_8cc.html#ad1e755f27e46f917ddd55aba6a4627a2">g_cvt_fn</a>[11][11])( <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> x, <span class="keywordtype">unsigned</span> from_width, <span class="keywordtype">unsigned</span> to_width, <span class="keywordtype">int</span> to_sign, 
<a name="l01973"></a>01973                                <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> saturation_mode ) = {
<a name="l01974"></a>01974    { NULL, <a class="code" href="instructions_8cc.html#a4fea4e976bf45fc9b550b55cd6fe961f">sext</a>, sext, sext, NULL, sext, sext, sext, <a class="code" href="instructions_8cc.html#a601270898045111d46c7b6ea730f65bb">s2f</a>, s2f, s2f}, 
<a name="l01975"></a>01975    { <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, NULL, <a class="code" href="instructions_8cc.html#a4fea4e976bf45fc9b550b55cd6fe961f">sext</a>, sext, <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, NULL, sext, sext, <a class="code" href="instructions_8cc.html#a601270898045111d46c7b6ea730f65bb">s2f</a>, s2f, s2f}, 
<a name="l01976"></a>01976    { <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, <a class="code" href="instructions_8cc.html#aa1e532b99e1e81b57899a18f7c8c864b">sexd</a>, NULL, <a class="code" href="instructions_8cc.html#a4fea4e976bf45fc9b550b55cd6fe961f">sext</a>, <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, chop, NULL, sext, <a class="code" href="instructions_8cc.html#a601270898045111d46c7b6ea730f65bb">s2f</a>, s2f, s2f}, 
<a name="l01977"></a>01977    { <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, chop, NULL, chop, chop, chop, NULL, <a class="code" href="instructions_8cc.html#a601270898045111d46c7b6ea730f65bb">s2f</a>, s2f, s2f}, 
<a name="l01978"></a>01978    { NULL, <a class="code" href="instructions_8cc.html#ac7b890b8cafb4712ad85cd00cfd317b7">zext</a>, zext, zext, NULL, zext, zext, zext, <a class="code" href="instructions_8cc.html#aa01476ee60c23d2ca33338b157e56344">u2f</a>, u2f, u2f}, 
<a name="l01979"></a>01979    { <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, NULL, <a class="code" href="instructions_8cc.html#ac7b890b8cafb4712ad85cd00cfd317b7">zext</a>, zext, <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, NULL, zext, zext, <a class="code" href="instructions_8cc.html#aa01476ee60c23d2ca33338b157e56344">u2f</a>, u2f, u2f}, 
<a name="l01980"></a>01980    { <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, NULL, <a class="code" href="instructions_8cc.html#ac7b890b8cafb4712ad85cd00cfd317b7">zext</a>, chop, chop, NULL, zext, <a class="code" href="instructions_8cc.html#aa01476ee60c23d2ca33338b157e56344">u2f</a>, u2f, u2f}, 
<a name="l01981"></a>01981    { <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, <a class="code" href="instructions_8cc.html#a59d301abc132af19b79fe03f7a095906">chop</a>, chop, NULL, chop, chop, chop, NULL, <a class="code" href="instructions_8cc.html#aa01476ee60c23d2ca33338b157e56344">u2f</a>, u2f, u2f}, 
<a name="l01982"></a>01982    { <a class="code" href="instructions_8cc.html#a255be8c89f143df742ea2b1b5f57de66">f2x</a> , <a class="code" href="instructions_8cc.html#a255be8c89f143df742ea2b1b5f57de66">f2x</a> , f2x , f2x , f2x , f2x , f2x , f2x , NULL,f2x, f2x}, 
<a name="l01983"></a>01983    { <a class="code" href="instructions_8cc.html#a255be8c89f143df742ea2b1b5f57de66">f2x</a> , <a class="code" href="instructions_8cc.html#a255be8c89f143df742ea2b1b5f57de66">f2x</a> , f2x , f2x , f2x , f2x , f2x , f2x , f2x, <a class="code" href="instructions_8cc.html#ad05b38b1d5e3c8d21673d659c432d8cd">f2f</a>, f2x},
<a name="l01984"></a>01984    { <a class="code" href="instructions_8cc.html#a3e030625ed4cf77db723ad8cb7688c11">d2x</a> , <a class="code" href="instructions_8cc.html#a3e030625ed4cf77db723ad8cb7688c11">d2x</a> , d2x , d2x , d2x , d2x , d2x , d2x , d2x, d2x, <a class="code" href="instructions_8cc.html#a4c2ce15388ed3fc3d0b5a03e2592c440">d2d</a>} 
<a name="l01985"></a>01985 };
<a name="l01986"></a>01986 
<a name="l01987"></a><a class="code" href="instructions_8cc.html#a5ffd8feafc11c06acb59d24b88b851f1">01987</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a5ffd8feafc11c06acb59d24b88b851f1">ptx_round</a>(<a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>&amp; data, <span class="keywordtype">int</span> rounding_mode, <span class="keywordtype">int</span> type)
<a name="l01988"></a>01988 {
<a name="l01989"></a>01989    <span class="keywordflow">if</span> (rounding_mode == RN_OPTION) {
<a name="l01990"></a>01990       <span class="keywordflow">return</span>;
<a name="l01991"></a>01991    }
<a name="l01992"></a>01992    <span class="keywordflow">switch</span> ( rounding_mode ) {
<a name="l01993"></a>01993    <span class="keywordflow">case</span> RZI_OPTION: 
<a name="l01994"></a>01994       <span class="keywordflow">switch</span> ( type ) {
<a name="l01995"></a>01995       <span class="keywordflow">case</span> S8_TYPE:
<a name="l01996"></a>01996       <span class="keywordflow">case</span> S16_TYPE:
<a name="l01997"></a>01997       <span class="keywordflow">case</span> S32_TYPE:
<a name="l01998"></a>01998       <span class="keywordflow">case</span> S64_TYPE:
<a name="l01999"></a>01999       <span class="keywordflow">case</span> U8_TYPE:
<a name="l02000"></a>02000       <span class="keywordflow">case</span> U16_TYPE:
<a name="l02001"></a>02001       <span class="keywordflow">case</span> U32_TYPE:
<a name="l02002"></a>02002       <span class="keywordflow">case</span> U64_TYPE:
<a name="l02003"></a>02003          printf(<span class="stringliteral">&quot;Trying to round an integer??\n&quot;</span>); assert(0); <span class="keywordflow">break</span>;
<a name="l02004"></a>02004       <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l02005"></a>02005       <span class="keywordflow">case</span> F32_TYPE:
<a name="l02006"></a>02006          data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = truncf(data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); 
<a name="l02007"></a>02007          <span class="keywordflow">break</span>;          
<a name="l02008"></a>02008       <span class="keywordflow">case</span> F64_TYPE:
<a name="l02009"></a>02009       <span class="keywordflow">case</span> FF64_TYPE:
<a name="l02010"></a>02010          <span class="keywordflow">if</span> (data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &lt; 0) data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = ceil(data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="comment">//negative</span>
<a name="l02011"></a>02011          <span class="keywordflow">else</span> data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = floor(data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="comment">//positive</span>
<a name="l02012"></a>02012          <span class="keywordflow">break</span>; 
<a name="l02013"></a>02013       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02014"></a>02014       }
<a name="l02015"></a>02015       <span class="keywordflow">break</span>;
<a name="l02016"></a>02016    <span class="keywordflow">case</span> RNI_OPTION: 
<a name="l02017"></a>02017       <span class="keywordflow">switch</span> ( type ) {
<a name="l02018"></a>02018       <span class="keywordflow">case</span> S8_TYPE:
<a name="l02019"></a>02019       <span class="keywordflow">case</span> S16_TYPE:
<a name="l02020"></a>02020       <span class="keywordflow">case</span> S32_TYPE:
<a name="l02021"></a>02021       <span class="keywordflow">case</span> S64_TYPE:
<a name="l02022"></a>02022       <span class="keywordflow">case</span> U8_TYPE:
<a name="l02023"></a>02023       <span class="keywordflow">case</span> U16_TYPE:
<a name="l02024"></a>02024       <span class="keywordflow">case</span> U32_TYPE:
<a name="l02025"></a>02025       <span class="keywordflow">case</span> U64_TYPE:
<a name="l02026"></a>02026          printf(<span class="stringliteral">&quot;Trying to round an integer??\n&quot;</span>); assert(0); <span class="keywordflow">break</span>;
<a name="l02027"></a>02027       <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l02028"></a>02028       <span class="keywordflow">case</span> F32_TYPE: 
<a name="l02029"></a>02029 <span class="preprocessor">#if CUDART_VERSION &gt;= 3000</span>
<a name="l02030"></a>02030 <span class="preprocessor"></span>         data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = nearbyintf(data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); 
<a name="l02031"></a>02031 <span class="preprocessor">#else</span>
<a name="l02032"></a>02032 <span class="preprocessor"></span>         data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = cuda_math::__cuda_nearbyintf(data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); 
<a name="l02033"></a>02033 <span class="preprocessor">#endif</span>
<a name="l02034"></a>02034 <span class="preprocessor"></span>         <span class="keywordflow">break</span>;          
<a name="l02035"></a>02035       <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = round(data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>; 
<a name="l02036"></a>02036       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02037"></a>02037       }
<a name="l02038"></a>02038       <span class="keywordflow">break</span>;
<a name="l02039"></a>02039    <span class="keywordflow">case</span> RMI_OPTION: 
<a name="l02040"></a>02040       <span class="keywordflow">switch</span> ( type ) {
<a name="l02041"></a>02041       <span class="keywordflow">case</span> S8_TYPE:
<a name="l02042"></a>02042       <span class="keywordflow">case</span> S16_TYPE:
<a name="l02043"></a>02043       <span class="keywordflow">case</span> S32_TYPE:
<a name="l02044"></a>02044       <span class="keywordflow">case</span> S64_TYPE:
<a name="l02045"></a>02045       <span class="keywordflow">case</span> U8_TYPE:
<a name="l02046"></a>02046       <span class="keywordflow">case</span> U16_TYPE:
<a name="l02047"></a>02047       <span class="keywordflow">case</span> U32_TYPE:
<a name="l02048"></a>02048       <span class="keywordflow">case</span> U64_TYPE:
<a name="l02049"></a>02049          printf(<span class="stringliteral">&quot;Trying to round an integer??\n&quot;</span>); assert(0); <span class="keywordflow">break</span>;
<a name="l02050"></a>02050       <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l02051"></a>02051       <span class="keywordflow">case</span> F32_TYPE: 
<a name="l02052"></a>02052          data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = floorf(data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); 
<a name="l02053"></a>02053          <span class="keywordflow">break</span>;          
<a name="l02054"></a>02054       <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = floor(data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>; 
<a name="l02055"></a>02055       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02056"></a>02056       }
<a name="l02057"></a>02057       <span class="keywordflow">break</span>;
<a name="l02058"></a>02058    <span class="keywordflow">case</span> RPI_OPTION: 
<a name="l02059"></a>02059       <span class="keywordflow">switch</span> ( type ) {
<a name="l02060"></a>02060       <span class="keywordflow">case</span> S8_TYPE:
<a name="l02061"></a>02061       <span class="keywordflow">case</span> S16_TYPE:
<a name="l02062"></a>02062       <span class="keywordflow">case</span> S32_TYPE:
<a name="l02063"></a>02063       <span class="keywordflow">case</span> S64_TYPE:
<a name="l02064"></a>02064       <span class="keywordflow">case</span> U8_TYPE:
<a name="l02065"></a>02065       <span class="keywordflow">case</span> U16_TYPE:
<a name="l02066"></a>02066       <span class="keywordflow">case</span> U32_TYPE:
<a name="l02067"></a>02067       <span class="keywordflow">case</span> U64_TYPE:
<a name="l02068"></a>02068          printf(<span class="stringliteral">&quot;Trying to round an integer??\n&quot;</span>); assert(0); <span class="keywordflow">break</span>;
<a name="l02069"></a>02069       <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l02070"></a>02070       <span class="keywordflow">case</span> F32_TYPE: data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = ceilf(data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;          
<a name="l02071"></a>02071       <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = ceil(data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>; 
<a name="l02072"></a>02072       <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02073"></a>02073       }
<a name="l02074"></a>02074       <span class="keywordflow">break</span>;
<a name="l02075"></a>02075    <span class="keywordflow">default</span>:  <span class="keywordflow">break</span>; 
<a name="l02076"></a>02076    }
<a name="l02077"></a>02077 
<a name="l02078"></a>02078    <span class="keywordflow">if</span> (type == F32_TYPE) {
<a name="l02079"></a>02079 <span class="preprocessor">#if CUDART_VERSION &gt;= 3000</span>
<a name="l02080"></a>02080 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (<a class="code" href="cuda-math_8h.html#a586dc89529b75ca3fe6cd98d69d2aff3">isnanf</a>(data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>)) 
<a name="l02081"></a>02081 <span class="preprocessor">#else</span>
<a name="l02082"></a>02082 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (cuda_math::__cuda___isnanf(data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>)) 
<a name="l02083"></a>02083 <span class="preprocessor">#endif</span>
<a name="l02084"></a>02084 <span class="preprocessor"></span>      {
<a name="l02085"></a>02085          data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0x7fffffff;
<a name="l02086"></a>02086       }
<a name="l02087"></a>02087    }
<a name="l02088"></a>02088    <span class="keywordflow">if</span> ((type == F64_TYPE)||(type == FF64_TYPE)) {
<a name="l02089"></a>02089       <span class="keywordflow">if</span> (isnan(data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>)) {
<a name="l02090"></a>02090          data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0xfff8000000000000ull;
<a name="l02091"></a>02091       }
<a name="l02092"></a>02092    }
<a name="l02093"></a>02093 }
<a name="l02094"></a>02094 
<a name="l02095"></a><a class="code" href="instructions_8cc.html#a910cd16ee8d49b5094913745ea520f84">02095</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a910cd16ee8d49b5094913745ea520f84">ptx_saturate</a>(<a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>&amp; data, <span class="keywordtype">int</span> saturation_mode, <span class="keywordtype">int</span> type)
<a name="l02096"></a>02096 {
<a name="l02097"></a>02097    <span class="keywordflow">if</span> (!saturation_mode) {
<a name="l02098"></a>02098       <span class="keywordflow">return</span>;
<a name="l02099"></a>02099    }
<a name="l02100"></a>02100    <span class="keywordflow">switch</span> ( type ) {
<a name="l02101"></a>02101    <span class="keywordflow">case</span> S8_TYPE:
<a name="l02102"></a>02102    <span class="keywordflow">case</span> S16_TYPE:
<a name="l02103"></a>02103    <span class="keywordflow">case</span> S32_TYPE:
<a name="l02104"></a>02104    <span class="keywordflow">case</span> S64_TYPE:
<a name="l02105"></a>02105    <span class="keywordflow">case</span> U8_TYPE:
<a name="l02106"></a>02106    <span class="keywordflow">case</span> U16_TYPE:
<a name="l02107"></a>02107    <span class="keywordflow">case</span> U32_TYPE:
<a name="l02108"></a>02108    <span class="keywordflow">case</span> U64_TYPE:
<a name="l02109"></a>02109       printf(<span class="stringliteral">&quot;Trying to clamp an integer to 1??\n&quot;</span>); assert(0); <span class="keywordflow">break</span>;
<a name="l02110"></a>02110    <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l02111"></a>02111    <span class="keywordflow">case</span> F32_TYPE:
<a name="l02112"></a>02112       <span class="keywordflow">if</span> (data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &gt; 1.0f) data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = 1.0f; <span class="comment">//negative</span>
<a name="l02113"></a>02113       <span class="keywordflow">if</span> (data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt; 0.0f) data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = 0.0f; <span class="comment">//positive</span>
<a name="l02114"></a>02114       <span class="keywordflow">break</span>;          
<a name="l02115"></a>02115    <span class="keywordflow">case</span> F64_TYPE:
<a name="l02116"></a>02116    <span class="keywordflow">case</span> FF64_TYPE:
<a name="l02117"></a>02117       <span class="keywordflow">if</span> (data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &gt; 1.0f) data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = 1.0f; <span class="comment">//negative</span>
<a name="l02118"></a>02118       <span class="keywordflow">if</span> (data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &lt; 0.0f) data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = 0.0f; <span class="comment">//positive</span>
<a name="l02119"></a>02119       <span class="keywordflow">break</span>; 
<a name="l02120"></a>02120    <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02121"></a>02121    }
<a name="l02122"></a>02122 
<a name="l02123"></a>02123 }
<a name="l02124"></a>02124 
<a name="l02125"></a><a class="code" href="instructions_8cc.html#a53976801b2971b48e2a5be0d687b09e3">02125</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a53976801b2971b48e2a5be0d687b09e3">cvt_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02126"></a>02126 { 
<a name="l02127"></a>02127    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02128"></a>02128    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02129"></a>02129    <span class="keywordtype">unsigned</span> to_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02130"></a>02130    <span class="keywordtype">unsigned</span> from_type = pI-&gt;<a class="code" href="classptx__instruction.html#a65ccc3829d2356648a9865c42bc91409">get_type2</a>();
<a name="l02131"></a>02131    <span class="keywordtype">unsigned</span> rounding_mode = pI-&gt;<a class="code" href="classptx__instruction.html#a761267ac81a148d1bd1cd3b93643db7e">rounding_mode</a>();
<a name="l02132"></a>02132    <span class="keywordtype">unsigned</span> saturation_mode = pI-&gt;<a class="code" href="classptx__instruction.html#aae07066e2373dcbed9598b1ecdbc2b99">saturation_mode</a>();
<a name="l02133"></a>02133 
<a name="l02134"></a>02134    <span class="keywordflow">if</span> ( to_type == F16_TYPE || from_type == F16_TYPE )
<a name="l02135"></a>02135       abort();
<a name="l02136"></a>02136 
<a name="l02137"></a>02137    <span class="keywordtype">int</span> to_sign, from_sign;
<a name="l02138"></a>02138    <span class="keywordtype">size_t</span> from_width, to_width;
<a name="l02139"></a>02139    <span class="keywordtype">unsigned</span> src_fmt = <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(from_type, from_width, from_sign);
<a name="l02140"></a>02140    <span class="keywordtype">unsigned</span> dst_fmt = <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(to_type, to_width, to_sign);
<a name="l02141"></a>02141 
<a name="l02142"></a>02142    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, from_type, thread, 1);
<a name="l02143"></a>02143 
<a name="l02144"></a>02144    <span class="keywordflow">if</span>(pI-&gt;<a class="code" href="classptx__instruction.html#ae7fb0471c410f323b1401612a285bed7">is_neg</a>()){
<a name="l02145"></a>02145 
<a name="l02146"></a>02146    <span class="keywordflow">switch</span>( from_type ) {
<a name="l02147"></a>02147       <span class="comment">// Default to f32 for now, need to add support for others</span>
<a name="l02148"></a>02148       <span class="keywordflow">case</span> S8_TYPE:
<a name="l02149"></a>02149       <span class="keywordflow">case</span> U8_TYPE:
<a name="l02150"></a>02150       <span class="keywordflow">case</span> B8_TYPE:
<a name="l02151"></a>02151          data.<a class="code" href="unionptx__reg__t.html#aeb61f4c697e957e4716283c63de5a149">s8</a> = -data.<a class="code" href="unionptx__reg__t.html#aeb61f4c697e957e4716283c63de5a149">s8</a>;
<a name="l02152"></a>02152          <span class="keywordflow">break</span>;
<a name="l02153"></a>02153       <span class="keywordflow">case</span> S16_TYPE:
<a name="l02154"></a>02154       <span class="keywordflow">case</span> U16_TYPE:
<a name="l02155"></a>02155       <span class="keywordflow">case</span> B16_TYPE:
<a name="l02156"></a>02156          data.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = -data.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>;
<a name="l02157"></a>02157          <span class="keywordflow">break</span>;
<a name="l02158"></a>02158       <span class="keywordflow">case</span> S32_TYPE:
<a name="l02159"></a>02159       <span class="keywordflow">case</span> U32_TYPE:
<a name="l02160"></a>02160       <span class="keywordflow">case</span> B32_TYPE:
<a name="l02161"></a>02161          data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = -data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l02162"></a>02162          <span class="keywordflow">break</span>;
<a name="l02163"></a>02163       <span class="keywordflow">case</span> S64_TYPE:
<a name="l02164"></a>02164       <span class="keywordflow">case</span> U64_TYPE:
<a name="l02165"></a>02165       <span class="keywordflow">case</span> B64_TYPE:
<a name="l02166"></a>02166          data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = -data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>;
<a name="l02167"></a>02167          <span class="keywordflow">break</span>;
<a name="l02168"></a>02168       <span class="keywordflow">case</span> F16_TYPE:
<a name="l02169"></a>02169          data.<a class="code" href="unionptx__reg__t.html#a0b71ba26b727ecfad58b8b7a7b87b90f">f16</a> = -data.<a class="code" href="unionptx__reg__t.html#a0b71ba26b727ecfad58b8b7a7b87b90f">f16</a>;
<a name="l02170"></a>02170          <span class="keywordflow">break</span>;
<a name="l02171"></a>02171       <span class="keywordflow">case</span> F32_TYPE:
<a name="l02172"></a>02172          data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = -data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>;
<a name="l02173"></a>02173          <span class="keywordflow">break</span>;
<a name="l02174"></a>02174       <span class="keywordflow">case</span> F64_TYPE:
<a name="l02175"></a>02175       <span class="keywordflow">case</span> FF64_TYPE:
<a name="l02176"></a>02176          data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = -data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>;
<a name="l02177"></a>02177          <span class="keywordflow">break</span>;
<a name="l02178"></a>02178       <span class="keywordflow">default</span>:
<a name="l02179"></a>02179          assert(0);
<a name="l02180"></a>02180       }
<a name="l02181"></a>02181 
<a name="l02182"></a>02182    }
<a name="l02183"></a>02183 
<a name="l02184"></a>02184 
<a name="l02185"></a>02185    <span class="keywordflow">if</span> ( <a class="code" href="instructions_8cc.html#ad1e755f27e46f917ddd55aba6a4627a2">g_cvt_fn</a>[src_fmt][dst_fmt] != NULL ) {
<a name="l02186"></a>02186       <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> result = <a class="code" href="instructions_8cc.html#ad1e755f27e46f917ddd55aba6a4627a2">g_cvt_fn</a>[src_fmt][dst_fmt](data,from_width,to_width,to_sign, rounding_mode, saturation_mode);
<a name="l02187"></a>02187       data = result;
<a name="l02188"></a>02188    }
<a name="l02189"></a>02189 
<a name="l02190"></a>02190    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, data, to_type, thread, pI );
<a name="l02191"></a>02191 }
<a name="l02192"></a>02192 
<a name="l02193"></a><a class="code" href="instructions_8cc.html#a815c28eff2d2162adc084d2d513877c5">02193</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a815c28eff2d2162adc084d2d513877c5">cvta_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02194"></a>02194 { 
<a name="l02195"></a>02195    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l02196"></a>02196 
<a name="l02197"></a>02197    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02198"></a>02198    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02199"></a>02199    <a class="code" href="classmemory__space__t.html">memory_space_t</a> space = pI-&gt;<a class="code" href="classptx__instruction.html#a93c8cf0ec080e4e0b0672e9e2ff8328e">get_space</a>();
<a name="l02200"></a>02200    <span class="keywordtype">bool</span> to_non_generic = pI-&gt;<a class="code" href="classptx__instruction.html#ac05193566c7aca21c1af383e35765e6b">is_to</a>();
<a name="l02201"></a>02201 
<a name="l02202"></a>02202    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02203"></a>02203    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> from_addr = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1,dst,i_type,thread,1);
<a name="l02204"></a>02204    <a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a> from_addr_hw = (<a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a>)from_addr.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l02205"></a>02205    <a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a> to_addr_hw = 0;
<a name="l02206"></a>02206    <span class="keywordtype">unsigned</span> smid = thread-&gt;<a class="code" href="classptx__thread__info.html#a2ea77b07de9b308b68345534238442ba">get_hw_sid</a>();
<a name="l02207"></a>02207    <span class="keywordtype">unsigned</span> hwtid = thread-&gt;<a class="code" href="classptx__thread__info.html#ab29aab67515d40473c131e4d9e475acb">get_hw_tid</a>();
<a name="l02208"></a>02208 
<a name="l02209"></a>02209    <span class="keywordflow">if</span>( to_non_generic ) {
<a name="l02210"></a>02210       <span class="keywordflow">switch</span>( space.<a class="code" href="classmemory__space__t.html#a9aa8b2fabc2c16d1bfda090f27ab479c">get_type</a>() ) {
<a name="l02211"></a>02211       <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>: to_addr_hw = <a class="code" href="cuda-sim_8cc.html#a35eba6b8cdc2d7ec759b29fa0b9f3fa1">generic_to_shared</a>( smid, from_addr_hw ); <span class="keywordflow">break</span>;
<a name="l02212"></a>02212       <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca133ba819812b7d97221aed15cb830967">local_space</a>:  to_addr_hw = <a class="code" href="cuda-sim_8cc.html#afdfedaa298dbf33d4b846e775e293d23">generic_to_local</a>( smid, hwtid, from_addr_hw ); <span class="keywordflow">break</span>;
<a name="l02213"></a>02213       <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>: to_addr_hw = <a class="code" href="cuda-sim_8cc.html#a8f2b2d24aeb6bb7d520ee819c0c22fa5">generic_to_global</a>(from_addr_hw ); <span class="keywordflow">break</span>;
<a name="l02214"></a>02214       <span class="keywordflow">default</span>: abort();
<a name="l02215"></a>02215       }
<a name="l02216"></a>02216    } <span class="keywordflow">else</span> {
<a name="l02217"></a>02217       <span class="keywordflow">switch</span>( space.<a class="code" href="classmemory__space__t.html#a9aa8b2fabc2c16d1bfda090f27ab479c">get_type</a>() ) {
<a name="l02218"></a>02218       <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>: to_addr_hw = <a class="code" href="cuda-sim_8cc.html#a2db3cb2d086416a94cf6c1c0193c86fe">shared_to_generic</a>( smid, from_addr_hw ); <span class="keywordflow">break</span>;
<a name="l02219"></a>02219       <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca133ba819812b7d97221aed15cb830967">local_space</a>:  to_addr_hw =  <a class="code" href="cuda-sim_8cc.html#a1b860df34fdd0b974b965fcec7f77c35">local_to_generic</a>( smid, hwtid, from_addr_hw )
<a name="l02220"></a>02220                                       + thread-&gt;<a class="code" href="classptx__thread__info.html#a41da2adc2dc2e08a4280f76d11f04f39">get_local_mem_stack_pointer</a>(); <span class="keywordflow">break</span>; <span class="comment">// add stack ptr here so that it can be passed as a pointer at function call </span>
<a name="l02221"></a>02221       <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>: to_addr_hw = <a class="code" href="cuda-sim_8cc.html#a9d22c70a712c557a4dd37e0855797e69">global_to_generic</a>( from_addr_hw ); <span class="keywordflow">break</span>;
<a name="l02222"></a>02222       <span class="keywordflow">default</span>: abort();
<a name="l02223"></a>02223       }
<a name="l02224"></a>02224    }
<a name="l02225"></a>02225    
<a name="l02226"></a>02226    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> to_addr;
<a name="l02227"></a>02227    to_addr.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = to_addr_hw;
<a name="l02228"></a>02228    thread-&gt;<a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(dst.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>(),to_addr);
<a name="l02229"></a>02229 }
<a name="l02230"></a>02230 
<a name="l02231"></a><a class="code" href="instructions_8cc.html#aa0a9e2692f0e8e003423921738a9fa79">02231</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aa0a9e2692f0e8e003423921738a9fa79">div_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02232"></a>02232 { 
<a name="l02233"></a>02233    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l02234"></a>02234 
<a name="l02235"></a>02235    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02236"></a>02236    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02237"></a>02237    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l02238"></a>02238 
<a name="l02239"></a>02239    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02240"></a>02240 
<a name="l02241"></a>02241    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02242"></a>02242    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l02243"></a>02243 
<a name="l02244"></a>02244 
<a name="l02245"></a>02245    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l02246"></a>02246    <span class="keywordflow">case</span> S8_TYPE:
<a name="l02247"></a>02247       data.<a class="code" href="unionptx__reg__t.html#aeb61f4c697e957e4716283c63de5a149">s8</a>  = src1_data.<a class="code" href="unionptx__reg__t.html#aeb61f4c697e957e4716283c63de5a149">s8</a>  / src2_data.<a class="code" href="unionptx__reg__t.html#aeb61f4c697e957e4716283c63de5a149">s8</a> ; <span class="keywordflow">break</span>;
<a name="l02248"></a>02248    <span class="keywordflow">case</span> S16_TYPE:
<a name="l02249"></a>02249       data.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> / src2_data.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>; <span class="keywordflow">break</span>;
<a name="l02250"></a>02250    <span class="keywordflow">case</span> S32_TYPE:
<a name="l02251"></a>02251       data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> / src2_data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>; <span class="keywordflow">break</span>;
<a name="l02252"></a>02252    <span class="keywordflow">case</span> S64_TYPE: 
<a name="l02253"></a>02253       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> / src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>; <span class="keywordflow">break</span>;
<a name="l02254"></a>02254    <span class="keywordflow">case</span> U8_TYPE:
<a name="l02255"></a>02255       data.<a class="code" href="unionptx__reg__t.html#ae370e49ce48a8795e1214b80f807f03e">u8</a>  = src1_data.<a class="code" href="unionptx__reg__t.html#ae370e49ce48a8795e1214b80f807f03e">u8</a>  / src2_data.<a class="code" href="unionptx__reg__t.html#ae370e49ce48a8795e1214b80f807f03e">u8</a> ; <span class="keywordflow">break</span>;
<a name="l02256"></a>02256    <span class="keywordflow">case</span> U16_TYPE:
<a name="l02257"></a>02257       data.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = src1_data.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> / src2_data.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>; <span class="keywordflow">break</span>;
<a name="l02258"></a>02258    <span class="keywordflow">case</span> U32_TYPE:
<a name="l02259"></a>02259       data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> / src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>; <span class="keywordflow">break</span>;
<a name="l02260"></a>02260    <span class="keywordflow">case</span> U64_TYPE: 
<a name="l02261"></a>02261       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> / src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>; <span class="keywordflow">break</span>;
<a name="l02262"></a>02262    <span class="keywordflow">case</span> B8_TYPE:
<a name="l02263"></a>02263       data.<a class="code" href="unionptx__reg__t.html#ae370e49ce48a8795e1214b80f807f03e">u8</a>  = src1_data.<a class="code" href="unionptx__reg__t.html#ae370e49ce48a8795e1214b80f807f03e">u8</a>  / src2_data.<a class="code" href="unionptx__reg__t.html#ae370e49ce48a8795e1214b80f807f03e">u8</a> ; <span class="keywordflow">break</span>;
<a name="l02264"></a>02264    <span class="keywordflow">case</span> B16_TYPE:
<a name="l02265"></a>02265       data.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = src1_data.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> / src2_data.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>; <span class="keywordflow">break</span>;
<a name="l02266"></a>02266    <span class="keywordflow">case</span> B32_TYPE:
<a name="l02267"></a>02267       data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> / src2_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>; <span class="keywordflow">break</span>;
<a name="l02268"></a>02268    <span class="keywordflow">case</span> B64_TYPE:
<a name="l02269"></a>02269       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> / src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>; <span class="keywordflow">break</span>;
<a name="l02270"></a>02270    <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l02271"></a>02271    <span class="keywordflow">case</span> F32_TYPE: data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = src1_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> / src2_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>; <span class="keywordflow">break</span>;
<a name="l02272"></a>02272    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> / src2_data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>; <span class="keywordflow">break</span>;
<a name="l02273"></a>02273    <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02274"></a>02274    }
<a name="l02275"></a>02275    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread,pI);
<a name="l02276"></a>02276 }
<a name="l02277"></a>02277 
<a name="l02278"></a><a class="code" href="instructions_8cc.html#ae67014e5a8d108980b529565b739c9a8">02278</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ae67014e5a8d108980b529565b739c9a8">ex2_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02279"></a>02279 { 
<a name="l02280"></a>02280    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l02281"></a>02281    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02282"></a>02282    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02283"></a>02283 
<a name="l02284"></a>02284    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02285"></a>02285 
<a name="l02286"></a>02286    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02287"></a>02287 
<a name="l02288"></a>02288 
<a name="l02289"></a>02289    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l02290"></a>02290    <span class="keywordflow">case</span> F32_TYPE: 
<a name="l02291"></a>02291       data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a8c8e281843ace5ab4d259f61d11c0618">cuda_math::__powf</a>(2.0, src1_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>);
<a name="l02292"></a>02292       <span class="keywordflow">break</span>;
<a name="l02293"></a>02293    <span class="keywordflow">default</span>:
<a name="l02294"></a>02294       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l02295"></a>02295       assert(0); 
<a name="l02296"></a>02296       <span class="keywordflow">break</span>;
<a name="l02297"></a>02297    }
<a name="l02298"></a>02298    
<a name="l02299"></a>02299    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread,pI);
<a name="l02300"></a>02300 }
<a name="l02301"></a>02301 
<a name="l02302"></a><a class="code" href="instructions_8cc.html#aa9cde06b41dd716e332d0e0caea12988">02302</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aa9cde06b41dd716e332d0e0caea12988">exit_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02303"></a>02303 {
<a name="l02304"></a>02304    thread-&gt;<a class="code" href="classptx__thread__info.html#a004f522e8c39d5404d4278659c6196cd">set_done</a>();
<a name="l02305"></a>02305    thread-&gt;<a class="code" href="classptx__thread__info.html#aede5addae6f87f77407ebae85dc3d7fe">exitCore</a>();
<a name="l02306"></a>02306    thread-&gt;<a class="code" href="classptx__thread__info.html#a021336f7273f7176a38c284b720e02fa">registerExit</a>();
<a name="l02307"></a>02307 }
<a name="l02308"></a>02308 
<a name="l02309"></a>02309 <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a4470960e0d45badb9f3f06d612a7ed9c">mad_def</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread, <span class="keywordtype">bool</span> use_carry = <span class="keyword">false</span> );
<a name="l02310"></a>02310 
<a name="l02311"></a><a class="code" href="instructions_8cc.html#ac76df510fb6e02698bc7f46a7e614c23">02311</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ac76df510fb6e02698bc7f46a7e614c23">fma_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02312"></a>02312 {
<a name="l02313"></a>02313    <a class="code" href="instructions_8cc.html#a4470960e0d45badb9f3f06d612a7ed9c">mad_def</a>(pI,thread);
<a name="l02314"></a>02314 }
<a name="l02315"></a>02315 
<a name="l02316"></a><a class="code" href="instructions_8cc.html#a3074cbb4efe511949f60a53eacfc7f12">02316</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a3074cbb4efe511949f60a53eacfc7f12">isspacep_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02317"></a>02317 { 
<a name="l02318"></a>02318    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a;
<a name="l02319"></a>02319    <span class="keywordtype">bool</span> t=<span class="keyword">false</span>;
<a name="l02320"></a>02320 
<a name="l02321"></a>02321    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02322"></a>02322    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02323"></a>02323    <a class="code" href="classmemory__space__t.html">memory_space_t</a> space = pI-&gt;<a class="code" href="classptx__instruction.html#a93c8cf0ec080e4e0b0672e9e2ff8328e">get_space</a>();
<a name="l02324"></a>02324 
<a name="l02325"></a>02325    a = thread-&gt;<a class="code" href="classptx__thread__info.html#afe77b2eff319e52e3efc0ccd75c7ae36">get_reg</a>(src1.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>());
<a name="l02326"></a>02326    <a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a> addr = (<a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a>)a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l02327"></a>02327    <span class="keywordtype">unsigned</span> smid = thread-&gt;<a class="code" href="classptx__thread__info.html#a2ea77b07de9b308b68345534238442ba">get_hw_sid</a>();
<a name="l02328"></a>02328    <span class="keywordtype">unsigned</span> hwtid = thread-&gt;<a class="code" href="classptx__thread__info.html#ab29aab67515d40473c131e4d9e475acb">get_hw_tid</a>();
<a name="l02329"></a>02329 
<a name="l02330"></a>02330    <span class="keywordflow">switch</span>( space.<a class="code" href="classmemory__space__t.html#a9aa8b2fabc2c16d1bfda090f27ab479c">get_type</a>() ) {
<a name="l02331"></a>02331    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>: t = <a class="code" href="cuda-sim_8cc.html#ac3dc2e26eb917451331db93ee1602ffe">isspace_shared</a>( smid, addr );
<a name="l02332"></a>02332    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca133ba819812b7d97221aed15cb830967">local_space</a>:  t = <a class="code" href="cuda-sim_8cc.html#a23479f4255c50747df7595f125d0012a">isspace_local</a>( smid, hwtid, addr );
<a name="l02333"></a>02333    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>: t = <a class="code" href="cuda-sim_8cc.html#a3f11fc9a91c46bedd3588d198e491473">isspace_global</a>( addr );
<a name="l02334"></a>02334    <span class="keywordflow">default</span>: abort();
<a name="l02335"></a>02335    }
<a name="l02336"></a>02336 
<a name="l02337"></a>02337    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> p;
<a name="l02338"></a>02338    p.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = t?1:0;
<a name="l02339"></a>02339 
<a name="l02340"></a>02340    thread-&gt;<a class="code" href="classptx__thread__info.html#acf4008bd9ca1d9d29ffcace508f8314d">set_reg</a>(dst.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>(),p);
<a name="l02341"></a>02341 }
<a name="l02342"></a>02342 
<a name="l02343"></a><a class="code" href="instructions_8cc.html#aba16c3439b22dd0d69d4502beac6e7c6">02343</a> <span class="keywordtype">void</span> <a class="code" href="cuda__device__printf_8cc.html#aba16c3439b22dd0d69d4502beac6e7c6">decode_space</a>( <a class="code" href="classmemory__space__t.html">memory_space_t</a> &amp;space, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread, <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;op, <a class="code" href="classmemory__space.html">memory_space</a> *&amp;mem, <a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a> &amp;addr)
<a name="l02344"></a>02344 {
<a name="l02345"></a>02345    <span class="keywordtype">unsigned</span> smid = thread-&gt;<a class="code" href="classptx__thread__info.html#a2ea77b07de9b308b68345534238442ba">get_hw_sid</a>();
<a name="l02346"></a>02346    <span class="keywordtype">unsigned</span> hwtid = thread-&gt;<a class="code" href="classptx__thread__info.html#ab29aab67515d40473c131e4d9e475acb">get_hw_tid</a>();
<a name="l02347"></a>02347 
<a name="l02348"></a>02348    <span class="keywordflow">if</span>( space == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca397b6ec5c92b5f013d27f984ce50abea">param_space_unclassified</a> ) {
<a name="l02349"></a>02349       <span class="comment">// need to op to determine whether it refers to a kernel param or local param</span>
<a name="l02350"></a>02350       <span class="keyword">const</span> <a class="code" href="classsymbol.html">symbol</a> *s = op.<a class="code" href="classoperand__info.html#a90cf6e60e556a54e6ee775a777bfe169">get_symbol</a>();
<a name="l02351"></a>02351       <span class="keyword">const</span> <a class="code" href="classtype__info.html">type_info</a> *t = s-&gt;<a class="code" href="classsymbol.html#af8da68543a752fdbd25f4b905f2ab6da">type</a>();
<a name="l02352"></a>02352       <a class="code" href="classtype__info__key.html">type_info_key</a> ti = t-&gt;<a class="code" href="classtype__info.html#acf7d3f7834206cc07553246538e409b9">get_key</a>();
<a name="l02353"></a>02353       <span class="keywordflow">if</span>( ti.<a class="code" href="classtype__info__key.html#ae1879cfd96269bd1ca2a652c92a73225">is_param_kernel</a>() )
<a name="l02354"></a>02354          space = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca5448bfae061180e01eb15ce5fec7bdcc">param_space_kernel</a>;
<a name="l02355"></a>02355       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ti.<a class="code" href="classtype__info__key.html#aeef019e08057f701723f9a27b6b8e135">is_param_local</a>() ) {
<a name="l02356"></a>02356          space = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca2f594286872ffab4d06ed69f65f111ac">param_space_local</a>;
<a name="l02357"></a>02357       } <span class="keywordflow">else</span> {
<a name="l02358"></a>02358          printf(<span class="stringliteral">&quot;GPGPU-Sim PTX: ERROR ** cannot resolve .param space for &apos;%s&apos;\n&quot;</span>, s-&gt;<a class="code" href="classsymbol.html#a280a3f1e3caffd94b10590dbb4259033">name</a>().c_str() );
<a name="l02359"></a>02359          abort(); 
<a name="l02360"></a>02360       }
<a name="l02361"></a>02361    }
<a name="l02362"></a>02362    <span class="keywordflow">switch</span> ( space.<a class="code" href="classmemory__space__t.html#a9aa8b2fabc2c16d1bfda090f27ab479c">get_type</a>() ) {
<a name="l02363"></a>02363    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>: mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab2b214414769f3a7422e2e7a1642bf74">get_global_memory</a>(); <span class="keywordflow">break</span>;
<a name="l02364"></a>02364    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca2f594286872ffab4d06ed69f65f111ac">param_space_local</a>:
<a name="l02365"></a>02365    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca133ba819812b7d97221aed15cb830967">local_space</a>:
<a name="l02366"></a>02366       mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a22296d84ac37c6861d88a24761506e2e">m_local_mem</a>; 
<a name="l02367"></a>02367       addr += thread-&gt;<a class="code" href="classptx__thread__info.html#a41da2adc2dc2e08a4280f76d11f04f39">get_local_mem_stack_pointer</a>();
<a name="l02368"></a>02368       <span class="keywordflow">break</span>; 
<a name="l02369"></a>02369    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cadc0c390c9425eb280596cbf66b5d4d4f">tex_space</a>:    mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab84687f7c6d8f30487c14c082b7ac693">get_tex_memory</a>(); <span class="keywordflow">break</span>; 
<a name="l02370"></a>02370    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca44dbb1b8dbb05c3dc58275d544c2611d">surf_space</a>:   mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a42aaeccceee9915eb2112bed7361182d">get_surf_memory</a>(); <span class="keywordflow">break</span>; 
<a name="l02371"></a>02371    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca5448bfae061180e01eb15ce5fec7bdcc">param_space_kernel</a>:  mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a4306ccde84b6bbd5f4745ed3960d188b">get_param_memory</a>(); <span class="keywordflow">break</span>;
<a name="l02372"></a>02372    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>:  mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a7c4af02df5c97e1e2d89f2475bf8df8f">m_shared_mem</a>; <span class="keywordflow">break</span>; 
<a name="l02373"></a>02373    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca445236c52ac314c07392ad430f155071">const_space</a>:  mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab2b214414769f3a7422e2e7a1642bf74">get_global_memory</a>(); <span class="keywordflow">break</span>;
<a name="l02374"></a>02374    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca17d691d8581a1417ef2062ce6e833be9">generic_space</a>:
<a name="l02375"></a>02375       <span class="keywordflow">if</span>( thread-&gt;<a class="code" href="classptx__thread__info.html#a31f963b9c32964bd1c499e83ee337f29">get_ptx_version</a>().<a class="code" href="classptx__version.html#aa7be87ba571d14be2e73c963cca1b88c">ver</a>() &gt;= 2.0 ) {
<a name="l02376"></a>02376          <span class="comment">// convert generic address to memory space address</span>
<a name="l02377"></a>02377          space = <a class="code" href="cuda-sim_8cc.html#adc619997188fa5d771ace549b2700aa7">whichspace</a>(addr);
<a name="l02378"></a>02378          <span class="keywordflow">switch</span> ( space.<a class="code" href="classmemory__space__t.html#a9aa8b2fabc2c16d1bfda090f27ab479c">get_type</a>() ) {
<a name="l02379"></a>02379          <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>: mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab2b214414769f3a7422e2e7a1642bf74">get_global_memory</a>(); addr = <a class="code" href="cuda-sim_8cc.html#a8f2b2d24aeb6bb7d520ee819c0c22fa5">generic_to_global</a>(addr); <span class="keywordflow">break</span>;
<a name="l02380"></a>02380          <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca133ba819812b7d97221aed15cb830967">local_space</a>:  mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a22296d84ac37c6861d88a24761506e2e">m_local_mem</a>; addr = <a class="code" href="cuda-sim_8cc.html#afdfedaa298dbf33d4b846e775e293d23">generic_to_local</a>(smid,hwtid,addr); <span class="keywordflow">break</span>; 
<a name="l02381"></a>02381          <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>: mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a7c4af02df5c97e1e2d89f2475bf8df8f">m_shared_mem</a>; addr = <a class="code" href="cuda-sim_8cc.html#a35eba6b8cdc2d7ec759b29fa0b9f3fa1">generic_to_shared</a>(smid,addr); <span class="keywordflow">break</span>; 
<a name="l02382"></a>02382          <span class="keywordflow">default</span>: abort();
<a name="l02383"></a>02383          }
<a name="l02384"></a>02384       } <span class="keywordflow">else</span> {
<a name="l02385"></a>02385          abort();
<a name="l02386"></a>02386       }
<a name="l02387"></a>02387       <span class="keywordflow">break</span>;
<a name="l02388"></a>02388    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca397b6ec5c92b5f013d27f984ce50abea">param_space_unclassified</a>:
<a name="l02389"></a>02389    <span class="keywordflow">case</span> <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca434a5fd1a70c9dcbe2de96e9c602d265">undefined_space</a>:
<a name="l02390"></a>02390    <span class="keywordflow">default</span>:
<a name="l02391"></a>02391       abort();
<a name="l02392"></a>02392    }
<a name="l02393"></a>02393 }
<a name="l02394"></a>02394 
<a name="l02395"></a><a class="code" href="instructions_8cc.html#a19be4d7f6becab44acf932fdb6d08979">02395</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a19be4d7f6becab44acf932fdb6d08979">ld_exec</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02396"></a>02396 { 
<a name="l02397"></a>02397    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02398"></a>02398    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02399"></a>02399 
<a name="l02400"></a>02400    <span class="keywordtype">unsigned</span> type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02401"></a>02401 
<a name="l02402"></a>02402    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, type, thread, 1);
<a name="l02403"></a>02403    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l02404"></a>02404    <a class="code" href="classmemory__space__t.html">memory_space_t</a> space = pI-&gt;<a class="code" href="classptx__instruction.html#a93c8cf0ec080e4e0b0672e9e2ff8328e">get_space</a>();
<a name="l02405"></a>02405    <span class="keywordtype">unsigned</span> vector_spec = pI-&gt;<a class="code" href="classptx__instruction.html#aeedec39ded36b742e6fa59a3a4b83b3c">get_vector</a>();
<a name="l02406"></a>02406 
<a name="l02407"></a>02407    <a class="code" href="classmemory__space.html">memory_space</a> *mem = NULL;
<a name="l02408"></a>02408    <a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a> addr = src1_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l02409"></a>02409 
<a name="l02410"></a>02410    <a class="code" href="cuda__device__printf_8cc.html#aba16c3439b22dd0d69d4502beac6e7c6">decode_space</a>(space,thread,src1,mem,addr);
<a name="l02411"></a>02411 
<a name="l02412"></a>02412    <span class="keywordtype">size_t</span> size;
<a name="l02413"></a>02413    <span class="keywordtype">int</span> t;
<a name="l02414"></a>02414    data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>=0;
<a name="l02415"></a>02415    <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(type,size,t);
<a name="l02416"></a>02416    <span class="keywordflow">if</span> (!vector_spec) {
<a name="l02417"></a>02417       mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(addr,size/8,&amp;data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>);
<a name="l02418"></a>02418       <span class="keywordflow">if</span>( type == S16_TYPE || type == S32_TYPE ) 
<a name="l02419"></a>02419          <a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">sign_extend</a>(data,size,dst);
<a name="l02420"></a>02420       thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, type, thread, pI);
<a name="l02421"></a>02421    } <span class="keywordflow">else</span> {
<a name="l02422"></a>02422       <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data1, data2, data3, data4;
<a name="l02423"></a>02423       mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(addr,size/8,&amp;data1.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>);
<a name="l02424"></a>02424       mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(addr+size/8,size/8,&amp;data2.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>);
<a name="l02425"></a>02425       <span class="keywordflow">if</span> (vector_spec != V2_TYPE) { <span class="comment">//either V3 or V4</span>
<a name="l02426"></a>02426          mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(addr+2*size/8,size/8,&amp;data3.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>);
<a name="l02427"></a>02427          <span class="keywordflow">if</span> (vector_spec != V3_TYPE) { <span class="comment">//v4</span>
<a name="l02428"></a>02428             mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(addr+3*size/8,size/8,&amp;data4.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>);
<a name="l02429"></a>02429             thread-&gt;<a class="code" href="classptx__thread__info.html#a63c1ce9a7e644923b52c8dcbbd58d6fc">set_vector_operand_values</a>(dst,data1,data2,data3,data4);
<a name="l02430"></a>02430          } <span class="keywordflow">else</span> <span class="comment">//v3</span>
<a name="l02431"></a>02431             thread-&gt;<a class="code" href="classptx__thread__info.html#a63c1ce9a7e644923b52c8dcbbd58d6fc">set_vector_operand_values</a>(dst,data1,data2,data3,data3);
<a name="l02432"></a>02432       } <span class="keywordflow">else</span> <span class="comment">//v2</span>
<a name="l02433"></a>02433          thread-&gt;<a class="code" href="classptx__thread__info.html#a63c1ce9a7e644923b52c8dcbbd58d6fc">set_vector_operand_values</a>(dst,data1,data2,data2,data2);
<a name="l02434"></a>02434    }
<a name="l02435"></a>02435    thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = addr;
<a name="l02436"></a>02436    thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = space; 
<a name="l02437"></a>02437 }
<a name="l02438"></a>02438 
<a name="l02439"></a><a class="code" href="instructions_8cc.html#aa857cc06df484f1b5783ceae775d74fb">02439</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aa857cc06df484f1b5783ceae775d74fb">ld_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02440"></a>02440 {
<a name="l02441"></a>02441    <a class="code" href="instructions_8cc.html#a19be4d7f6becab44acf932fdb6d08979">ld_exec</a>(pI,thread);
<a name="l02442"></a>02442 }
<a name="l02443"></a><a class="code" href="instructions_8cc.html#a78c4bd6b3521e4890a4615ab8d27b886">02443</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a78c4bd6b3521e4890a4615ab8d27b886">ldu_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02444"></a>02444 { 
<a name="l02445"></a>02445    <a class="code" href="instructions_8cc.html#a19be4d7f6becab44acf932fdb6d08979">ld_exec</a>(pI,thread);
<a name="l02446"></a>02446 }
<a name="l02447"></a>02447 
<a name="l02448"></a><a class="code" href="instructions_8cc.html#aaa4b29bd5f6b8c83e623098e33b499ce">02448</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aaa4b29bd5f6b8c83e623098e33b499ce">lg2_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02449"></a>02449 { 
<a name="l02450"></a>02450    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, d;
<a name="l02451"></a>02451    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02452"></a>02452    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02453"></a>02453 
<a name="l02454"></a>02454    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02455"></a>02455 
<a name="l02456"></a>02456    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02457"></a>02457 
<a name="l02458"></a>02458 
<a name="l02459"></a>02459    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l02460"></a>02460    <span class="keywordflow">case</span> F32_TYPE: 
<a name="l02461"></a>02461       d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = log(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>)/log(2);
<a name="l02462"></a>02462       <span class="keywordflow">break</span>;
<a name="l02463"></a>02463    <span class="keywordflow">default</span>:
<a name="l02464"></a>02464       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l02465"></a>02465       assert(0);
<a name="l02466"></a>02466       <span class="keywordflow">break</span>;
<a name="l02467"></a>02467    }
<a name="l02468"></a>02468 
<a name="l02469"></a>02469    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l02470"></a>02470 }
<a name="l02471"></a>02471 
<a name="l02472"></a><a class="code" href="instructions_8cc.html#a92a7606ad6bf020f0844724dcfd35ae8">02472</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a92a7606ad6bf020f0844724dcfd35ae8">mad24_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread )
<a name="l02473"></a>02473 {
<a name="l02474"></a>02474    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02475"></a>02475    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02476"></a>02476    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l02477"></a>02477    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src3 = pI-&gt;<a class="code" href="classptx__instruction.html#ad3166c06dcaaba2b7e6187126d3a07ed">src3</a>();
<a name="l02478"></a>02478    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> d, t;
<a name="l02479"></a>02479 
<a name="l02480"></a>02480    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02481"></a>02481    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02482"></a>02482    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l02483"></a>02483    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> c = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src3, dst, i_type, thread, 1);
<a name="l02484"></a>02484 
<a name="l02485"></a>02485    <span class="keywordtype">unsigned</span> sat_mode = pI-&gt;<a class="code" href="classptx__instruction.html#aae07066e2373dcbed9598b1ecdbc2b99">saturation_mode</a>();
<a name="l02486"></a>02486 
<a name="l02487"></a>02487    assert( !pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() );
<a name="l02488"></a>02488 
<a name="l02489"></a>02489    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l02490"></a>02490    <span class="keywordflow">case</span> S32_TYPE: 
<a name="l02491"></a>02491       t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> * b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l02492"></a>02492       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) {
<a name="l02493"></a>02493          d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>&gt;&gt;16) + c.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l02494"></a>02494          if ( sat_mode ) {
<a name="l02495"></a>02495             <span class="keywordflow">if</span> ( d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &gt; (<span class="keywordtype">int</span>)0x7FFFFFFF )
<a name="l02496"></a>02496                d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (<span class="keywordtype">int</span>)0x7FFFFFFF;
<a name="l02497"></a>02497             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &lt; (<span class="keywordtype">int</span>)0x80000000 )
<a name="l02498"></a>02498                d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (<span class="keywordtype">int</span>)0x80000000;
<a name="l02499"></a>02499          }
<a name="l02500"></a>02500       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = t.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> + c.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l02501"></a>02501       <span class="keywordflow">else</span> assert(0);
<a name="l02502"></a>02502       <span class="keywordflow">break</span>;
<a name="l02503"></a>02503    <span class="keywordflow">case</span> U32_TYPE: 
<a name="l02504"></a>02504       t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> * b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l02505"></a>02505       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>&gt;&gt;16) + c.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l02506"></a>02506       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = t.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + c.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l02507"></a>02507       <span class="keywordflow">else</span> assert(0);
<a name="l02508"></a>02508       <span class="keywordflow">break</span>;
<a name="l02509"></a>02509    <span class="keywordflow">default</span>: 
<a name="l02510"></a>02510       assert(0);
<a name="l02511"></a>02511       <span class="keywordflow">break</span>;
<a name="l02512"></a>02512    }
<a name="l02513"></a>02513 
<a name="l02514"></a>02514    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, d, i_type, thread, pI);
<a name="l02515"></a>02515 }
<a name="l02516"></a>02516 
<a name="l02517"></a><a class="code" href="instructions_8cc.html#abaaf3287cf81eae6baad20cd3cf1ad1c">02517</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#abaaf3287cf81eae6baad20cd3cf1ad1c">mad_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02518"></a>02518 {
<a name="l02519"></a>02519    <a class="code" href="instructions_8cc.html#a4470960e0d45badb9f3f06d612a7ed9c">mad_def</a>(pI, thread, <span class="keyword">false</span>);
<a name="l02520"></a>02520 }
<a name="l02521"></a>02521 
<a name="l02522"></a><a class="code" href="instructions_8cc.html#aadf65e21fc86e13da88b3e67321b1867">02522</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aadf65e21fc86e13da88b3e67321b1867">madp_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02523"></a>02523 {
<a name="l02524"></a>02524    <a class="code" href="instructions_8cc.html#a4470960e0d45badb9f3f06d612a7ed9c">mad_def</a>(pI, thread, <span class="keyword">true</span>);
<a name="l02525"></a>02525 }
<a name="l02526"></a>02526 
<a name="l02527"></a><a class="code" href="instructions_8cc.html#aa858b098e8bfaaa0eae90bc6c9a7e826">02527</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aa858b098e8bfaaa0eae90bc6c9a7e826">madc_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02528"></a>02528 {
<a name="l02529"></a>02529    <a class="code" href="instructions_8cc.html#a4470960e0d45badb9f3f06d612a7ed9c">mad_def</a>(pI, thread, <span class="keyword">true</span>);
<a name="l02530"></a>02530 }
<a name="l02531"></a>02531 
<a name="l02532"></a><a class="code" href="instructions_8cc.html#a4470960e0d45badb9f3f06d612a7ed9c">02532</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a4470960e0d45badb9f3f06d612a7ed9c">mad_def</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread, <span class="keywordtype">bool</span> use_carry ) 
<a name="l02533"></a>02533 { 
<a name="l02534"></a>02534    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02535"></a>02535    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02536"></a>02536    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l02537"></a>02537    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src3 = pI-&gt;<a class="code" href="classptx__instruction.html#ad3166c06dcaaba2b7e6187126d3a07ed">src3</a>();
<a name="l02538"></a>02538    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> d, t;
<a name="l02539"></a>02539 
<a name="l02540"></a>02540    <span class="keywordtype">int</span> carry=0;
<a name="l02541"></a>02541    <span class="keywordtype">int</span> overflow=0;
<a name="l02542"></a>02542 
<a name="l02543"></a>02543    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02544"></a>02544    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02545"></a>02545    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l02546"></a>02546    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> c = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src3, dst, i_type, thread, 1);
<a name="l02547"></a>02547 
<a name="l02548"></a>02548    <span class="comment">// take the carry bit, it should be the 4th operand </span>
<a name="l02549"></a>02549    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> carry_bit; 
<a name="l02550"></a>02550    carry_bit.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l02551"></a>02551    <span class="keywordflow">if</span> (use_carry) {
<a name="l02552"></a>02552       <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;carry = pI-&gt;<a class="code" href="classptx__instruction.html#a11714bd8014ff9f90d0db623234aead8">operand_lookup</a>(4);
<a name="l02553"></a>02553       carry_bit = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(carry, dst, PRED_TYPE, thread, 0);
<a name="l02554"></a>02554       carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp;= 0x4;
<a name="l02555"></a>02555       carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &gt;&gt;=2;
<a name="l02556"></a>02556    }
<a name="l02557"></a>02557 
<a name="l02558"></a>02558    <span class="keywordtype">unsigned</span> rounding_mode = pI-&gt;<a class="code" href="classptx__instruction.html#a761267ac81a148d1bd1cd3b93643db7e">rounding_mode</a>();
<a name="l02559"></a>02559 
<a name="l02560"></a>02560    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l02561"></a>02561    <span class="keywordflow">case</span> S16_TYPE: 
<a name="l02562"></a>02562       t.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> * b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>;
<a name="l02563"></a>02563       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() ) d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = t.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> + c.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02564"></a>02564       <span class="keywordflow">else</span> if ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) d.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = (t.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>&gt;&gt;16) + c.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02565"></a>02565       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = t.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> + c.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02566"></a>02566       <span class="keywordflow">else</span> assert(0);
<a name="l02567"></a>02567       carry = ((<span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="classint.html">int</a>)(t.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> + c.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>)&amp;0x100000000)&gt;&gt;32;
<a name="l02568"></a>02568       <span class="keywordflow">break</span>;
<a name="l02569"></a>02569    <span class="keywordflow">case</span> S32_TYPE: 
<a name="l02570"></a>02570       t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> * b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l02571"></a>02571       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() ) d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> + c.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02572"></a>02572       <span class="keywordflow">else</span> if ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = (t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>&gt;&gt;32) + c.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02573"></a>02573       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = t.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> + c.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02574"></a>02574       <span class="keywordflow">else</span> assert(0);
<a name="l02575"></a>02575       <span class="keywordflow">break</span>;
<a name="l02576"></a>02576    <span class="keywordflow">case</span> S64_TYPE: 
<a name="l02577"></a>02577       t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> * b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>;
<a name="l02578"></a>02578       assert( !pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() );
<a name="l02579"></a>02579       assert( !pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() );
<a name="l02580"></a>02580       assert( use_carry == <span class="keyword">false</span>); 
<a name="l02581"></a>02581       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> + c.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02582"></a>02582       <span class="keywordflow">else</span> assert(0);
<a name="l02583"></a>02583       <span class="keywordflow">break</span>;
<a name="l02584"></a>02584    <span class="keywordflow">case</span> U16_TYPE: 
<a name="l02585"></a>02585       t.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> * b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>;
<a name="l02586"></a>02586       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() ) d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = t.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + c.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02587"></a>02587       <span class="keywordflow">else</span> if ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = (t.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + c.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>)&gt;&gt;16;
<a name="l02588"></a>02588       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = t.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> + c.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02589"></a>02589       <span class="keywordflow">else</span> assert(0);
<a name="l02590"></a>02590       carry = ((<span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="classint.html">int</a>)((<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>)t.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + c.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>)&amp;0x100000000)&gt;&gt;32;
<a name="l02591"></a>02591       <span class="keywordflow">break</span>;
<a name="l02592"></a>02592    <span class="keywordflow">case</span> U32_TYPE: 
<a name="l02593"></a>02593       t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> * b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l02594"></a>02594       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() ) d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + c.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02595"></a>02595       <span class="keywordflow">else</span> if ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = (t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + c.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>)&gt;&gt;32;
<a name="l02596"></a>02596       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = t.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + c.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02597"></a>02597       <span class="keywordflow">else</span> assert(0);
<a name="l02598"></a>02598       <span class="keywordflow">break</span>;
<a name="l02599"></a>02599    <span class="keywordflow">case</span> U64_TYPE: 
<a name="l02600"></a>02600       t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> * b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l02601"></a>02601       assert( !pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() );
<a name="l02602"></a>02602       assert( !pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() );
<a name="l02603"></a>02603       assert( use_carry == <span class="keyword">false</span>); 
<a name="l02604"></a>02604       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + c.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> + carry_bit.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>;
<a name="l02605"></a>02605       <span class="keywordflow">else</span> assert(0);
<a name="l02606"></a>02606       <span class="keywordflow">break</span>;
<a name="l02607"></a>02607    <span class="keywordflow">case</span> F16_TYPE: 
<a name="l02608"></a>02608       assert(0); 
<a name="l02609"></a>02609       <span class="keywordflow">break</span>;
<a name="l02610"></a>02610    <span class="keywordflow">case</span> F32_TYPE: {
<a name="l02611"></a>02611          assert( use_carry == <span class="keyword">false</span>); 
<a name="l02612"></a>02612          <span class="keywordtype">int</span> orig_rm = fegetround();
<a name="l02613"></a>02613          <span class="keywordflow">switch</span> ( rounding_mode ) {
<a name="l02614"></a>02614          <span class="keywordflow">case</span> RN_OPTION: <span class="keywordflow">break</span>;
<a name="l02615"></a>02615          <span class="keywordflow">case</span> RZ_OPTION: fesetround( FE_TOWARDZERO ); <span class="keywordflow">break</span>;
<a name="l02616"></a>02616          <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02617"></a>02617          }
<a name="l02618"></a>02618          d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> * b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> + c.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>;
<a name="l02619"></a>02619          <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#aae07066e2373dcbed9598b1ecdbc2b99">saturation_mode</a>() ) {
<a name="l02620"></a>02620             <span class="keywordflow">if</span> ( d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt; 0 ) d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = 0;
<a name="l02621"></a>02621             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &gt; 1.0f ) d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = 1.0f;
<a name="l02622"></a>02622          }
<a name="l02623"></a>02623          fesetround( orig_rm );
<a name="l02624"></a>02624          <span class="keywordflow">break</span>;
<a name="l02625"></a>02625       }  
<a name="l02626"></a>02626    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: {
<a name="l02627"></a>02627          assert( use_carry == <span class="keyword">false</span>); 
<a name="l02628"></a>02628          <span class="keywordtype">int</span> orig_rm = fegetround();
<a name="l02629"></a>02629          <span class="keywordflow">switch</span> ( rounding_mode ) {
<a name="l02630"></a>02630          <span class="keywordflow">case</span> RN_OPTION: <span class="keywordflow">break</span>;
<a name="l02631"></a>02631          <span class="keywordflow">case</span> RZ_OPTION: fesetround( FE_TOWARDZERO ); <span class="keywordflow">break</span>;
<a name="l02632"></a>02632          <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02633"></a>02633          }
<a name="l02634"></a>02634          d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> * b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> + c.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>;
<a name="l02635"></a>02635          <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#aae07066e2373dcbed9598b1ecdbc2b99">saturation_mode</a>() ) {
<a name="l02636"></a>02636             <span class="keywordflow">if</span> ( d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &lt; 0 ) d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = 0;
<a name="l02637"></a>02637             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &gt; 1.0f ) d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = 1.0;
<a name="l02638"></a>02638          }
<a name="l02639"></a>02639          fesetround( orig_rm );
<a name="l02640"></a>02640          <span class="keywordflow">break</span>;
<a name="l02641"></a>02641       }
<a name="l02642"></a>02642    <span class="keywordflow">default</span>: 
<a name="l02643"></a>02643       assert(0);
<a name="l02644"></a>02644       <span class="keywordflow">break</span>;
<a name="l02645"></a>02645    }
<a name="l02646"></a>02646    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, d, i_type, thread, pI, overflow, carry);
<a name="l02647"></a>02647 }
<a name="l02648"></a>02648 
<a name="l02649"></a><a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">02649</a> <span class="keywordtype">bool</span> <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(<span class="keywordtype">float</span> x)
<a name="l02650"></a>02650 {
<a name="l02651"></a>02651    <span class="keywordflow">return</span> isnan(x);
<a name="l02652"></a>02652 }
<a name="l02653"></a>02653 
<a name="l02654"></a><a class="code" href="instructions_8cc.html#a80011ca13b8a663c7cd94826a4f34a7b">02654</a> <span class="keywordtype">bool</span> <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(<span class="keywordtype">double</span> x)
<a name="l02655"></a>02655 {
<a name="l02656"></a>02656    <span class="keywordflow">return</span> isnan(x);
<a name="l02657"></a>02657 }
<a name="l02658"></a>02658 
<a name="l02659"></a><a class="code" href="instructions_8cc.html#a3211363f352a93994df5b2ac160356df">02659</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a3211363f352a93994df5b2ac160356df">max_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02660"></a>02660 { 
<a name="l02661"></a>02661    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b, d;
<a name="l02662"></a>02662    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02663"></a>02663    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02664"></a>02664    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l02665"></a>02665 
<a name="l02666"></a>02666    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02667"></a>02667    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02668"></a>02668    b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l02669"></a>02669 
<a name="l02670"></a>02670 
<a name="l02671"></a>02671    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l02672"></a>02672    <span class="keywordflow">case</span> U16_TYPE: d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = MY_MAX_I(a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>,b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l02673"></a>02673    <span class="keywordflow">case</span> U32_TYPE: d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = MY_MAX_I(a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l02674"></a>02674    <span class="keywordflow">case</span> U64_TYPE: d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = MY_MAX_I(a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>,b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l02675"></a>02675    <span class="keywordflow">case</span> S16_TYPE: d.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = MY_MAX_I(a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>,b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l02676"></a>02676    <span class="keywordflow">case</span> S32_TYPE: d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = MY_MAX_I(a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>,b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l02677"></a>02677    <span class="keywordflow">case</span> S64_TYPE: d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = MY_MAX_I(a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>,b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l02678"></a>02678    <span class="keywordflow">case</span> F32_TYPE: d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = MY_MAX_F(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>,b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l02679"></a>02679    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = MY_MAX_F(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>,b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l02680"></a>02680    <span class="keywordflow">default</span>:
<a name="l02681"></a>02681       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l02682"></a>02682       assert(0); 
<a name="l02683"></a>02683       <span class="keywordflow">break</span>;
<a name="l02684"></a>02684    }
<a name="l02685"></a>02685 
<a name="l02686"></a>02686    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l02687"></a>02687 }
<a name="l02688"></a>02688 
<a name="l02689"></a><a class="code" href="instructions_8cc.html#afd1acfed1827fa660a72b33ac59d7c08">02689</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#afd1acfed1827fa660a72b33ac59d7c08">membar_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02690"></a>02690 { 
<a name="l02691"></a>02691    <span class="comment">// handled by timing simulator </span>
<a name="l02692"></a>02692 }
<a name="l02693"></a>02693 
<a name="l02694"></a><a class="code" href="instructions_8cc.html#a0b86b42e016926c2b79e342e8b15ef36">02694</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a0b86b42e016926c2b79e342e8b15ef36">min_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02695"></a>02695 { 
<a name="l02696"></a>02696    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b, d;
<a name="l02697"></a>02697    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02698"></a>02698    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02699"></a>02699    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l02700"></a>02700 
<a name="l02701"></a>02701    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02702"></a>02702    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02703"></a>02703    b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l02704"></a>02704 
<a name="l02705"></a>02705 
<a name="l02706"></a>02706    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l02707"></a>02707    <span class="keywordflow">case</span> U16_TYPE: d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = MY_MIN_I(a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>,b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l02708"></a>02708    <span class="keywordflow">case</span> U32_TYPE: d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = MY_MIN_I(a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l02709"></a>02709    <span class="keywordflow">case</span> U64_TYPE: d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = MY_MIN_I(a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>,b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l02710"></a>02710    <span class="keywordflow">case</span> S16_TYPE: d.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = MY_MIN_I(a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>,b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l02711"></a>02711    <span class="keywordflow">case</span> S32_TYPE: d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = MY_MIN_I(a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>,b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l02712"></a>02712    <span class="keywordflow">case</span> S64_TYPE: d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = MY_MIN_I(a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>,b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l02713"></a>02713    <span class="keywordflow">case</span> F32_TYPE: d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = MY_MIN_F(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>,b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l02714"></a>02714    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = MY_MIN_F(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>,b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l02715"></a>02715    <span class="keywordflow">default</span>:
<a name="l02716"></a>02716       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l02717"></a>02717       assert(0);
<a name="l02718"></a>02718       <span class="keywordflow">break</span>;
<a name="l02719"></a>02719    }
<a name="l02720"></a>02720 
<a name="l02721"></a>02721    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l02722"></a>02722 }
<a name="l02723"></a>02723 
<a name="l02724"></a><a class="code" href="instructions_8cc.html#ae947ffd920786251f76d029f75b2d830">02724</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ae947ffd920786251f76d029f75b2d830">mov_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02725"></a>02725 {
<a name="l02726"></a>02726    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l02727"></a>02727 
<a name="l02728"></a>02728    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02729"></a>02729    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02730"></a>02730    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02731"></a>02731 
<a name="l02732"></a>02732    <span class="keywordflow">if</span>( (src1.<a class="code" href="classoperand__info.html#a2d9731133be1063f65d792099473e426">is_vector</a>() || dst.<a class="code" href="classoperand__info.html#a2d9731133be1063f65d792099473e426">is_vector</a>()) &amp;&amp; (i_type != BB64_TYPE) &amp;&amp; (i_type != BB128_TYPE) &amp;&amp; (i_type != FF64_TYPE) ) {
<a name="l02733"></a>02733       <span class="comment">// pack or unpack operation</span>
<a name="l02734"></a>02734       <span class="keywordtype">unsigned</span> nbits_to_move;
<a name="l02735"></a>02735       <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> tmp_bits;
<a name="l02736"></a>02736 
<a name="l02737"></a>02737       <span class="keywordflow">switch</span>( pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>() ) {
<a name="l02738"></a>02738       <span class="keywordflow">case</span> B16_TYPE: nbits_to_move = 16; <span class="keywordflow">break</span>;
<a name="l02739"></a>02739       <span class="keywordflow">case</span> B32_TYPE: nbits_to_move = 32; <span class="keywordflow">break</span>;
<a name="l02740"></a>02740       <span class="keywordflow">case</span> B64_TYPE: nbits_to_move = 64; <span class="keywordflow">break</span>;
<a name="l02741"></a>02741       <span class="keywordflow">default</span>: printf(<span class="stringliteral">&quot;Execution error: mov pack/unpack with unsupported type qualifier\n&quot;</span>); assert(0); <span class="keywordflow">break</span>;
<a name="l02742"></a>02742       }
<a name="l02743"></a>02743 
<a name="l02744"></a>02744       <span class="keywordflow">if</span>( src1.<a class="code" href="classoperand__info.html#a2d9731133be1063f65d792099473e426">is_vector</a>() ) {
<a name="l02745"></a>02745          <span class="keywordtype">unsigned</span> nelem = src1.<a class="code" href="classoperand__info.html#ac45793fc8d4cad1dfe18a3c165c9e18f">get_vect_nelem</a>();
<a name="l02746"></a>02746          <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> v[4];
<a name="l02747"></a>02747          thread-&gt;<a class="code" href="classptx__thread__info.html#a4e9d2673a65c55339ae395075cdba6cd">get_vector_operand_values</a>(src1, v, nelem );
<a name="l02748"></a>02748 
<a name="l02749"></a>02749          <span class="keywordtype">unsigned</span> bits_per_src_elem = nbits_to_move / nelem;
<a name="l02750"></a>02750          <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>=0; <a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a> &lt; nelem; <a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>++ ) {
<a name="l02751"></a>02751             <span class="keywordflow">switch</span>(bits_per_src_elem) {
<a name="l02752"></a>02752             <span class="keywordflow">case</span> 8:   tmp_bits.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long)(v[<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>].u8)  &lt;&lt; (8*<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>));  <span class="keywordflow">break</span>;
<a name="l02753"></a>02753             <span class="keywordflow">case</span> 16:  tmp_bits.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long)(v[<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>].u16) &lt;&lt; (16*<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>)); <span class="keywordflow">break</span>;
<a name="l02754"></a>02754             <span class="keywordflow">case</span> 32:  tmp_bits.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> |= ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long)(v[<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>].u32) &lt;&lt; (32*<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>)); <span class="keywordflow">break</span>;
<a name="l02755"></a>02755             <span class="keywordflow">default</span>: printf(<span class="stringliteral">&quot;Execution error: mov pack/unpack with unsupported source/dst size ratio (src)\n&quot;</span>); assert(0); <span class="keywordflow">break</span>;
<a name="l02756"></a>02756             }
<a name="l02757"></a>02757          }
<a name="l02758"></a>02758       } <span class="keywordflow">else</span> {
<a name="l02759"></a>02759          data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02760"></a>02760 
<a name="l02761"></a>02761          <span class="keywordflow">switch</span>( pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>() ) {
<a name="l02762"></a>02762          <span class="keywordflow">case</span> B16_TYPE: tmp_bits.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = data.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>; <span class="keywordflow">break</span>;
<a name="l02763"></a>02763          <span class="keywordflow">case</span> B32_TYPE: tmp_bits.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>; <span class="keywordflow">break</span>;
<a name="l02764"></a>02764          <span class="keywordflow">case</span> B64_TYPE: tmp_bits.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>; <span class="keywordflow">break</span>;
<a name="l02765"></a>02765          <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02766"></a>02766          }
<a name="l02767"></a>02767       }
<a name="l02768"></a>02768 
<a name="l02769"></a>02769       <span class="keywordflow">if</span>( dst.<a class="code" href="classoperand__info.html#a2d9731133be1063f65d792099473e426">is_vector</a>() ) {
<a name="l02770"></a>02770          <span class="keywordtype">unsigned</span> nelem = dst.<a class="code" href="classoperand__info.html#ac45793fc8d4cad1dfe18a3c165c9e18f">get_vect_nelem</a>();
<a name="l02771"></a>02771          <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> v[4];
<a name="l02772"></a>02772          <span class="keywordtype">unsigned</span> bits_per_dst_elem = nbits_to_move / nelem;
<a name="l02773"></a>02773          <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>=0; <a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a> &lt; nelem; <a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>++ ) {
<a name="l02774"></a>02774             <span class="keywordflow">switch</span>(bits_per_dst_elem) {
<a name="l02775"></a>02775             <span class="keywordflow">case</span> 8:  v[<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>].<a class="code" href="unionptx__reg__t.html#ae370e49ce48a8795e1214b80f807f03e">u8</a>  = (tmp_bits.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &gt;&gt; (8*<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>)) &amp; ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long) 0xFF); <span class="keywordflow">break</span>;
<a name="l02776"></a>02776             <span class="keywordflow">case</span> 16: v[<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>].<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = (tmp_bits.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &gt;&gt; (16*<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>)) &amp; ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long) 0xFFFF); <span class="keywordflow">break</span>;
<a name="l02777"></a>02777             <span class="keywordflow">case</span> 32: v[<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>].<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = (tmp_bits.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &gt;&gt; (32*<a class="code" href="rng-double_8c.html#aa42a9a9cb6e2b93d7f825c395af871bf">i</a>)) &amp; ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long) 0xFFFFFFFF); <span class="keywordflow">break</span>;
<a name="l02778"></a>02778             <span class="keywordflow">default</span>:
<a name="l02779"></a>02779                printf(<span class="stringliteral">&quot;Execution error: mov pack/unpack with unsupported source/dst size ratio (dst)\n&quot;</span>);
<a name="l02780"></a>02780                assert(0);
<a name="l02781"></a>02781                <span class="keywordflow">break</span>;
<a name="l02782"></a>02782             }
<a name="l02783"></a>02783          }
<a name="l02784"></a>02784          thread-&gt;<a class="code" href="classptx__thread__info.html#a63c1ce9a7e644923b52c8dcbbd58d6fc">set_vector_operand_values</a>(dst,v[0],v[1],v[2],v[3]);
<a name="l02785"></a>02785       } <span class="keywordflow">else</span> {
<a name="l02786"></a>02786          thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,tmp_bits, i_type, thread, pI);
<a name="l02787"></a>02787       }
<a name="l02788"></a>02788    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i_type == PRED_TYPE and src1.<a class="code" href="classoperand__info.html#a7f575445d398382185666bc79df440f7">is_literal</a>() == <span class="keyword">true</span>) {
<a name="l02789"></a>02789       <span class="comment">// in ptx, literal input translate to predicate as 0 = false and 1 = true </span>
<a name="l02790"></a>02790       <span class="comment">// we have adopted the opposite to simplify implementation of zero flags in ptxplus </span>
<a name="l02791"></a>02791       data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02792"></a>02792 
<a name="l02793"></a>02793       <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> finaldata; 
<a name="l02794"></a>02794       finaldata.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = (data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> == 0)? 1 : 0;  <span class="comment">// setting zero-flag in predicate </span>
<a name="l02795"></a>02795       thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, finaldata, i_type, thread, pI);
<a name="l02796"></a>02796    } <span class="keywordflow">else</span> {
<a name="l02797"></a>02797 
<a name="l02798"></a>02798       data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02799"></a>02799 
<a name="l02800"></a>02800      thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, data, i_type, thread, pI);
<a name="l02801"></a>02801 
<a name="l02802"></a>02802    }
<a name="l02803"></a>02803 }
<a name="l02804"></a>02804 
<a name="l02805"></a><a class="code" href="instructions_8cc.html#a1fab66c636a1a45ec1cb4ec98b7a57e3">02805</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a1fab66c636a1a45ec1cb4ec98b7a57e3">mul24_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02806"></a>02806 {
<a name="l02807"></a>02807    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l02808"></a>02808 
<a name="l02809"></a>02809    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02810"></a>02810    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02811"></a>02811    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l02812"></a>02812 
<a name="l02813"></a>02813    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02814"></a>02814    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02815"></a>02815    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l02816"></a>02816 
<a name="l02817"></a>02817 
<a name="l02818"></a>02818    <span class="comment">//src1_data = srcOperandModifiers(src1_data, src1, dst, i_type, thread);</span>
<a name="l02819"></a>02819    <span class="comment">//src2_data = srcOperandModifiers(src2_data, src2, dst, i_type, thread);</span>
<a name="l02820"></a>02820 
<a name="l02821"></a>02821    src1_data.<a class="code" href="unionptx__reg__t.html#a23976dac81955f39a31589f47a51d6c9">mask_and</a>(0,0x00FFFFFF);
<a name="l02822"></a>02822    src2_data.<a class="code" href="unionptx__reg__t.html#a23976dac81955f39a31589f47a51d6c9">mask_and</a>(0,0x00FFFFFF);
<a name="l02823"></a>02823 
<a name="l02824"></a>02824    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l02825"></a>02825    <span class="keywordflow">case</span> S32_TYPE: 
<a name="l02826"></a>02826       <span class="keywordflow">if</span>( src1_data.<a class="code" href="unionptx__reg__t.html#a60262c4edbe94dd898204d75e0dc8cca">get_bit</a>(23) ) 
<a name="l02827"></a>02827          src1_data.<a class="code" href="unionptx__reg__t.html#abfd73db3b07b7207e92fda21ef8914f4">mask_or</a>(0xFFFFFFFF,0xFF000000);
<a name="l02828"></a>02828       <span class="keywordflow">if</span>( src2_data.<a class="code" href="unionptx__reg__t.html#a60262c4edbe94dd898204d75e0dc8cca">get_bit</a>(23) ) 
<a name="l02829"></a>02829          src2_data.<a class="code" href="unionptx__reg__t.html#abfd73db3b07b7207e92fda21ef8914f4">mask_or</a>(0xFFFFFFFF,0xFF000000);
<a name="l02830"></a>02830       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> * src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>;
<a name="l02831"></a>02831       <span class="keywordflow">break</span>;
<a name="l02832"></a>02832    <span class="keywordflow">case</span> U32_TYPE:
<a name="l02833"></a>02833       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> * src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l02834"></a>02834       <span class="keywordflow">break</span>;
<a name="l02835"></a>02835    <span class="keywordflow">default</span>:
<a name="l02836"></a>02836       printf(<span class="stringliteral">&quot;GPGPU-Sim PTX: Execution error - type mismatch with instruction\n&quot;</span>);
<a name="l02837"></a>02837       assert(0);
<a name="l02838"></a>02838       <span class="keywordflow">break</span>;
<a name="l02839"></a>02839    }
<a name="l02840"></a>02840 
<a name="l02841"></a>02841    <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) {
<a name="l02842"></a>02842       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &gt;&gt; 16;
<a name="l02843"></a>02843       data.<a class="code" href="unionptx__reg__t.html#a23976dac81955f39a31589f47a51d6c9">mask_and</a>(0,0xFFFFFFFF);
<a name="l02844"></a>02844    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>()) {
<a name="l02845"></a>02845       data.<a class="code" href="unionptx__reg__t.html#a23976dac81955f39a31589f47a51d6c9">mask_and</a>(0,0xFFFFFFFF);
<a name="l02846"></a>02846    }
<a name="l02847"></a>02847 
<a name="l02848"></a>02848    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, data, i_type, thread, pI);
<a name="l02849"></a>02849 }
<a name="l02850"></a>02850 
<a name="l02851"></a><a class="code" href="instructions_8cc.html#a01498925083f8f5c52017250f276595d">02851</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a01498925083f8f5c52017250f276595d">mul_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02852"></a>02852 {
<a name="l02853"></a>02853    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l02854"></a>02854 
<a name="l02855"></a>02855    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02856"></a>02856    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02857"></a>02857    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l02858"></a>02858    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> d, t;
<a name="l02859"></a>02859 
<a name="l02860"></a>02860    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02861"></a>02861    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02862"></a>02862    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l02863"></a>02863 
<a name="l02864"></a>02864    <span class="keywordtype">unsigned</span> rounding_mode = pI-&gt;<a class="code" href="classptx__instruction.html#a761267ac81a148d1bd1cd3b93643db7e">rounding_mode</a>();
<a name="l02865"></a>02865 
<a name="l02866"></a>02866    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l02867"></a>02867    <span class="keywordflow">case</span> S16_TYPE: 
<a name="l02868"></a>02868       t.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = ((<a class="code" href="classint.html">int</a>)a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>) * ((<a class="code" href="classint.html">int</a>)b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>);
<a name="l02869"></a>02869       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() ) d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = t.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l02870"></a>02870       <span class="keywordflow">else</span> if ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) d.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = (t.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>&gt;&gt;16);
<a name="l02871"></a>02871       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = t.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>;
<a name="l02872"></a>02872       <span class="keywordflow">else</span> assert(0);
<a name="l02873"></a>02873       <span class="keywordflow">break</span>;
<a name="l02874"></a>02874    <span class="keywordflow">case</span> S32_TYPE: 
<a name="l02875"></a>02875       t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = ((<span class="keywordtype">long</span> long)a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>) * ((<span class="keywordtype">long</span> long)b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>);
<a name="l02876"></a>02876       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() ) d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>;
<a name="l02877"></a>02877       <span class="keywordflow">else</span> if ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = (t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>&gt;&gt;32);
<a name="l02878"></a>02878       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = t.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>;
<a name="l02879"></a>02879       <span class="keywordflow">else</span> assert(0);
<a name="l02880"></a>02880       <span class="keywordflow">break</span>;
<a name="l02881"></a>02881    <span class="keywordflow">case</span> S64_TYPE: 
<a name="l02882"></a>02882       t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> * b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>;
<a name="l02883"></a>02883       assert( !pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() );
<a name="l02884"></a>02884       assert( !pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() );
<a name="l02885"></a>02885       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = t.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>;
<a name="l02886"></a>02886       <span class="keywordflow">else</span> assert(0);
<a name="l02887"></a>02887       <span class="keywordflow">break</span>;
<a name="l02888"></a>02888    <span class="keywordflow">case</span> U16_TYPE: 
<a name="l02889"></a>02889       t.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = ((unsigned)a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>) * ((unsigned)b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>);
<a name="l02890"></a>02890       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() ) d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = t.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l02891"></a>02891       <span class="keywordflow">else</span> if ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = t.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>;
<a name="l02892"></a>02892       <span class="keywordflow">else</span> if ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = (t.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>&gt;&gt;16);
<a name="l02893"></a>02893       <span class="keywordflow">else</span> assert(0);
<a name="l02894"></a>02894       <span class="keywordflow">break</span>;
<a name="l02895"></a>02895    <span class="keywordflow">case</span> U32_TYPE: 
<a name="l02896"></a>02896       t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long)a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>) * ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long)b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l02897"></a>02897       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() ) d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l02898"></a>02898       <span class="keywordflow">else</span> if ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = t.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l02899"></a>02899       <span class="keywordflow">else</span> if ( pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() ) d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = (t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>&gt;&gt;32);
<a name="l02900"></a>02900       <span class="keywordflow">else</span> assert(0);
<a name="l02901"></a>02901       <span class="keywordflow">break</span>;
<a name="l02902"></a>02902    <span class="keywordflow">case</span> U64_TYPE: 
<a name="l02903"></a>02903       t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> * b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l02904"></a>02904       assert( !pI-&gt;<a class="code" href="classptx__instruction.html#a86d1a73c1364e5add24bde249dc00195">is_wide</a>() );
<a name="l02905"></a>02905       assert( !pI-&gt;<a class="code" href="classptx__instruction.html#aef3c1a59f5ed86d0ac588d8c961aeba2">is_hi</a>() );
<a name="l02906"></a>02906       <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#af2497143af65d72ffe35292206ff7a96">is_lo</a>() ) d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = t.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l02907"></a>02907       <span class="keywordflow">else</span> assert(0);
<a name="l02908"></a>02908       <span class="keywordflow">break</span>;
<a name="l02909"></a>02909    <span class="keywordflow">case</span> F16_TYPE: 
<a name="l02910"></a>02910       assert(0); 
<a name="l02911"></a>02911       <span class="keywordflow">break</span>;
<a name="l02912"></a>02912    <span class="keywordflow">case</span> F32_TYPE: {
<a name="l02913"></a>02913          <span class="keywordtype">int</span> orig_rm = fegetround();
<a name="l02914"></a>02914          <span class="keywordflow">switch</span> ( rounding_mode ) {
<a name="l02915"></a>02915          <span class="keywordflow">case</span> RN_OPTION: <span class="keywordflow">break</span>;
<a name="l02916"></a>02916          <span class="keywordflow">case</span> RZ_OPTION: fesetround( FE_TOWARDZERO ); <span class="keywordflow">break</span>;
<a name="l02917"></a>02917          <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02918"></a>02918          }
<a name="l02919"></a>02919 
<a name="l02920"></a>02920          d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> * b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>;
<a name="l02921"></a>02921 
<a name="l02922"></a>02922          <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#aae07066e2373dcbed9598b1ecdbc2b99">saturation_mode</a>() ) {
<a name="l02923"></a>02923             <span class="keywordflow">if</span> ( d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt; 0 ) d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = 0;
<a name="l02924"></a>02924             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &gt; 1.0f ) d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = 1.0f;
<a name="l02925"></a>02925          }
<a name="l02926"></a>02926          fesetround( orig_rm );
<a name="l02927"></a>02927          <span class="keywordflow">break</span>;
<a name="l02928"></a>02928       }  
<a name="l02929"></a>02929    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE:{
<a name="l02930"></a>02930          <span class="keywordtype">int</span> orig_rm = fegetround();
<a name="l02931"></a>02931          <span class="keywordflow">switch</span> ( rounding_mode ) {
<a name="l02932"></a>02932          <span class="keywordflow">case</span> RN_OPTION: <span class="keywordflow">break</span>;
<a name="l02933"></a>02933          <span class="keywordflow">case</span> RZ_OPTION: fesetround( FE_TOWARDZERO ); <span class="keywordflow">break</span>;
<a name="l02934"></a>02934          <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02935"></a>02935          }
<a name="l02936"></a>02936          d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> * b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>;
<a name="l02937"></a>02937          <span class="keywordflow">if</span> ( pI-&gt;<a class="code" href="classptx__instruction.html#aae07066e2373dcbed9598b1ecdbc2b99">saturation_mode</a>() ) {
<a name="l02938"></a>02938             <span class="keywordflow">if</span> ( d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &lt; 0 ) d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = 0;
<a name="l02939"></a>02939             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &gt; 1.0f ) d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = 1.0;
<a name="l02940"></a>02940          }
<a name="l02941"></a>02941          fesetround( orig_rm );
<a name="l02942"></a>02942          <span class="keywordflow">break</span>;
<a name="l02943"></a>02943       }
<a name="l02944"></a>02944    <span class="keywordflow">default</span>: 
<a name="l02945"></a>02945       assert(0); 
<a name="l02946"></a>02946       <span class="keywordflow">break</span>;
<a name="l02947"></a>02947    }
<a name="l02948"></a>02948 
<a name="l02949"></a>02949    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, d, i_type, thread, pI);
<a name="l02950"></a>02950 }
<a name="l02951"></a>02951 
<a name="l02952"></a><a class="code" href="instructions_8cc.html#afc29958a4c53e4ed48aed472b504b3e1">02952</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#afc29958a4c53e4ed48aed472b504b3e1">neg_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02953"></a>02953 { 
<a name="l02954"></a>02954    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l02955"></a>02955 
<a name="l02956"></a>02956    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02957"></a>02957    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02958"></a>02958 
<a name="l02959"></a>02959    <span class="keywordtype">unsigned</span> to_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02960"></a>02960    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, to_type, thread, 1);
<a name="l02961"></a>02961 
<a name="l02962"></a>02962 
<a name="l02963"></a>02963    <span class="keywordflow">switch</span> ( to_type ) {
<a name="l02964"></a>02964    <span class="keywordflow">case</span> S8_TYPE:
<a name="l02965"></a>02965    <span class="keywordflow">case</span> S16_TYPE:
<a name="l02966"></a>02966    <span class="keywordflow">case</span> S32_TYPE:
<a name="l02967"></a>02967    <span class="keywordflow">case</span> S64_TYPE: 
<a name="l02968"></a>02968       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = 0 - src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>; <span class="keywordflow">break</span>; <span class="comment">// seems buggy, but not (just ignore higher bits)</span>
<a name="l02969"></a>02969    <span class="keywordflow">case</span> U8_TYPE:
<a name="l02970"></a>02970    <span class="keywordflow">case</span> U16_TYPE:
<a name="l02971"></a>02971    <span class="keywordflow">case</span> U32_TYPE:
<a name="l02972"></a>02972    <span class="keywordflow">case</span> U64_TYPE: 
<a name="l02973"></a>02973       assert(0); <span class="keywordflow">break</span>;
<a name="l02974"></a>02974    <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l02975"></a>02975    <span class="keywordflow">case</span> F32_TYPE: data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = 0.0f - src1_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>; <span class="keywordflow">break</span>;
<a name="l02976"></a>02976    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = 0.0f - src1_data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>; <span class="keywordflow">break</span>;
<a name="l02977"></a>02977    <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l02978"></a>02978    }
<a name="l02979"></a>02979 
<a name="l02980"></a>02980    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, to_type, thread, pI);
<a name="l02981"></a>02981 }
<a name="l02982"></a>02982 
<a name="l02983"></a>02983 <span class="comment">//nandn bitwise negates second operand then bitwise nands with the first operand</span>
<a name="l02984"></a><a class="code" href="instructions_8cc.html#ad8cb2dfe771f9d38c158294ca1148a4c">02984</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ad8cb2dfe771f9d38c158294ca1148a4c">nandn_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l02985"></a>02985 {
<a name="l02986"></a>02986    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l02987"></a>02987 
<a name="l02988"></a>02988    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l02989"></a>02989    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l02990"></a>02990    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l02991"></a>02991 
<a name="l02992"></a>02992    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l02993"></a>02993    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l02994"></a>02994    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l02995"></a>02995 
<a name="l02996"></a>02996 
<a name="l02997"></a>02997    <span class="comment">//the way ptxplus handles predicates: 1 = false and 0 = true</span>
<a name="l02998"></a>02998    <span class="keywordflow">if</span>(i_type == PRED_TYPE)
<a name="l02999"></a>02999       data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = (~src1_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; src2_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>);
<a name="l03000"></a>03000    <span class="keywordflow">else</span>
<a name="l03001"></a>03001       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = ~(src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; ~src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l03002"></a>03002 
<a name="l03003"></a>03003    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI);
<a name="l03004"></a>03004 
<a name="l03005"></a>03005 }
<a name="l03006"></a>03006 
<a name="l03007"></a>03007 <span class="comment">//norn bitwise negates first operand then bitwise ands with the second operand</span>
<a name="l03008"></a><a class="code" href="instructions_8cc.html#af0a1a6f9a6e535835158602c9fa59307">03008</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#af0a1a6f9a6e535835158602c9fa59307">norn_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03009"></a>03009 {
<a name="l03010"></a>03010    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l03011"></a>03011 
<a name="l03012"></a>03012    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03013"></a>03013    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03014"></a>03014    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03015"></a>03015 
<a name="l03016"></a>03016    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03017"></a>03017    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03018"></a>03018    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l03019"></a>03019 
<a name="l03020"></a>03020 
<a name="l03021"></a>03021    <span class="comment">//the way ptxplus handles predicates: 1 = false and 0 = true</span>
<a name="l03022"></a>03022    <span class="keywordflow">if</span>(i_type == PRED_TYPE)
<a name="l03023"></a>03023       data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = ~(src1_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; ~(src2_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>));
<a name="l03024"></a>03024    <span class="keywordflow">else</span>
<a name="l03025"></a>03025       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = ~(src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>) &amp; src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l03026"></a>03026 
<a name="l03027"></a>03027    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI);
<a name="l03028"></a>03028 
<a name="l03029"></a>03029 }
<a name="l03030"></a>03030 
<a name="l03031"></a><a class="code" href="instructions_8cc.html#a9b9286f5a0cfcec033f0bdcac3844ee4">03031</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a9b9286f5a0cfcec033f0bdcac3844ee4">not_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03032"></a>03032 {
<a name="l03033"></a>03033    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b, d;
<a name="l03034"></a>03034    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03035"></a>03035    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03036"></a>03036 
<a name="l03037"></a>03037    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03038"></a>03038    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03039"></a>03039 
<a name="l03040"></a>03040 
<a name="l03041"></a>03041    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03042"></a>03042    <span class="keywordflow">case</span> PRED_TYPE: d.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = (~(a.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>) &amp; 0x000F); <span class="keywordflow">break</span>;
<a name="l03043"></a>03043    <span class="keywordflow">case</span> B16_TYPE:  d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>  = ~a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>; <span class="keywordflow">break</span>;
<a name="l03044"></a>03044    <span class="keywordflow">case</span> B32_TYPE:  d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>  = ~a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>; <span class="keywordflow">break</span>;
<a name="l03045"></a>03045    <span class="keywordflow">case</span> B64_TYPE:  d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>  = ~a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>; <span class="keywordflow">break</span>;
<a name="l03046"></a>03046    <span class="keywordflow">default</span>:
<a name="l03047"></a>03047       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l03048"></a>03048       assert(0); 
<a name="l03049"></a>03049       <span class="keywordflow">break</span>;
<a name="l03050"></a>03050    }
<a name="l03051"></a>03051 
<a name="l03052"></a>03052    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l03053"></a>03053 }
<a name="l03054"></a>03054 
<a name="l03055"></a><a class="code" href="instructions_8cc.html#abae13cb5ea583e8fba2d2918bb636ecc">03055</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#abae13cb5ea583e8fba2d2918bb636ecc">or_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03056"></a>03056 { 
<a name="l03057"></a>03057    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l03058"></a>03058    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03059"></a>03059    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03060"></a>03060    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03061"></a>03061 
<a name="l03062"></a>03062    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03063"></a>03063    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03064"></a>03064    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l03065"></a>03065 
<a name="l03066"></a>03066    <span class="comment">//the way ptxplus handles predicates: 1 = false and 0 = true</span>
<a name="l03067"></a>03067    <span class="keywordflow">if</span>(i_type == PRED_TYPE)
<a name="l03068"></a>03068       data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = ~(~(src1_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>) | ~(src2_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>));
<a name="l03069"></a>03069    <span class="keywordflow">else</span>
<a name="l03070"></a>03070       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> | src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l03071"></a>03071 
<a name="l03072"></a>03072    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI);
<a name="l03073"></a>03073 }
<a name="l03074"></a>03074 
<a name="l03075"></a><a class="code" href="instructions_8cc.html#a6238d49dd4634ee7e2206c318cea4ff3">03075</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a6238d49dd4634ee7e2206c318cea4ff3">orn_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03076"></a>03076 { 
<a name="l03077"></a>03077    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l03078"></a>03078    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03079"></a>03079    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03080"></a>03080    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03081"></a>03081 
<a name="l03082"></a>03082    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03083"></a>03083    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03084"></a>03084    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l03085"></a>03085 
<a name="l03086"></a>03086    <span class="comment">//the way ptxplus handles predicates: 1 = false and 0 = true</span>
<a name="l03087"></a>03087    <span class="keywordflow">if</span>(i_type == PRED_TYPE)
<a name="l03088"></a>03088       data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = ~(~(src1_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>) | (src2_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>));
<a name="l03089"></a>03089    <span class="keywordflow">else</span>
<a name="l03090"></a>03090       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> | ~src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l03091"></a>03091 
<a name="l03092"></a>03092    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI);
<a name="l03093"></a>03093 }
<a name="l03094"></a>03094 
<a name="l03095"></a><a class="code" href="instructions_8cc.html#a936d87e509b507774a6d1183edce855f">03095</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a936d87e509b507774a6d1183edce855f">pmevent_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l03096"></a><a class="code" href="instructions_8cc.html#a3c4341b2dc87f00fb33d2a62ab695554">03096</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a3c4341b2dc87f00fb33d2a62ab695554">popc_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03097"></a>03097 { 
<a name="l03098"></a>03098    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src_data, data;
<a name="l03099"></a>03099    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03100"></a>03100    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03101"></a>03101 
<a name="l03102"></a>03102    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03103"></a>03103    src_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src, dst, i_type, thread, 1);
<a name="l03104"></a>03104 
<a name="l03105"></a>03105    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03106"></a>03106    <span class="keywordflow">case</span> B32_TYPE: {
<a name="l03107"></a>03107       std::bitset&lt;32&gt; mask(src_data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); 
<a name="l03108"></a>03108       data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = mask.count(); 
<a name="l03109"></a>03109       } <span class="keywordflow">break</span>;
<a name="l03110"></a>03110    <span class="keywordflow">case</span> B64_TYPE: {
<a name="l03111"></a>03111       std::bitset&lt;64&gt; mask(src_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); 
<a name="l03112"></a>03112       data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = mask.count();
<a name="l03113"></a>03113       } <span class="keywordflow">break</span>;
<a name="l03114"></a>03114    <span class="keywordflow">default</span>:
<a name="l03115"></a>03115       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l03116"></a>03116       assert(0); 
<a name="l03117"></a>03117       <span class="keywordflow">break</span>;
<a name="l03118"></a>03118    }
<a name="l03119"></a>03119 
<a name="l03120"></a>03120    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI);
<a name="l03121"></a>03121 }
<a name="l03122"></a><a class="code" href="instructions_8cc.html#ae71f80bb00f1d4c220f4a09896ff5ad6">03122</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ae71f80bb00f1d4c220f4a09896ff5ad6">prefetch_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l03123"></a><a class="code" href="instructions_8cc.html#a16a608cd4f6addbca45584233bc370fd">03123</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a16a608cd4f6addbca45584233bc370fd">prefetchu_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l03124"></a><a class="code" href="instructions_8cc.html#aea12df51dc78551502bd2694d9165c70">03124</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aea12df51dc78551502bd2694d9165c70">prmt_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l03125"></a>03125 
<a name="l03126"></a><a class="code" href="instructions_8cc.html#a5c4c0af0a3175cdc4aa7e5d6344ccbfd">03126</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a5c4c0af0a3175cdc4aa7e5d6344ccbfd">rcp_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03127"></a>03127 { 
<a name="l03128"></a>03128    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l03129"></a>03129    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03130"></a>03130    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03131"></a>03131 
<a name="l03132"></a>03132    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03133"></a>03133    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03134"></a>03134 
<a name="l03135"></a>03135 
<a name="l03136"></a>03136    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03137"></a>03137    <span class="keywordflow">case</span> F32_TYPE: 
<a name="l03138"></a>03138       data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = 1.0f / src1_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>;
<a name="l03139"></a>03139       <span class="keywordflow">break</span>;
<a name="l03140"></a>03140    <span class="keywordflow">case</span> F64_TYPE:
<a name="l03141"></a>03141    <span class="keywordflow">case</span> FF64_TYPE:
<a name="l03142"></a>03142       data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = 1.0f / src1_data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>;
<a name="l03143"></a>03143       <span class="keywordflow">break</span>;
<a name="l03144"></a>03144    <span class="keywordflow">default</span>:
<a name="l03145"></a>03145       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l03146"></a>03146       assert(0); 
<a name="l03147"></a>03147       <span class="keywordflow">break</span>;
<a name="l03148"></a>03148    }
<a name="l03149"></a>03149 
<a name="l03150"></a>03150    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI);
<a name="l03151"></a>03151 }
<a name="l03152"></a>03152 
<a name="l03153"></a><a class="code" href="instructions_8cc.html#a865b8826dbeaab9c8fe08a448e00f487">03153</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a865b8826dbeaab9c8fe08a448e00f487">red_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l03154"></a>03154 
<a name="l03155"></a><a class="code" href="instructions_8cc.html#a79aa2f15740dcedf541300fe64aad16f">03155</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a79aa2f15740dcedf541300fe64aad16f">rem_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03156"></a>03156 { 
<a name="l03157"></a>03157    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l03158"></a>03158 
<a name="l03159"></a>03159    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03160"></a>03160    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03161"></a>03161    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03162"></a>03162 
<a name="l03163"></a>03163    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03164"></a>03164    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03165"></a>03165    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l03166"></a>03166 
<a name="l03167"></a>03167    data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> % src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l03168"></a>03168 
<a name="l03169"></a>03169    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI);
<a name="l03170"></a>03170 }
<a name="l03171"></a>03171 
<a name="l03172"></a><a class="code" href="instructions_8cc.html#a3d39c69ac91212bfbd0abed0ede05c80">03172</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a3d39c69ac91212bfbd0abed0ede05c80">ret_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03173"></a>03173 { 
<a name="l03174"></a>03174    <span class="keywordtype">bool</span> <a class="code" href="structCUstream__st.html#a6353e37c5be49616c4619c2be27dd6ab">empty</a> = thread-&gt;<a class="code" href="classptx__thread__info.html#a66deba768a30dfbd7204a5f3ab62f0e6">callstack_pop</a>();
<a name="l03175"></a>03175    <span class="keywordflow">if</span>( empty ) {
<a name="l03176"></a>03176    thread-&gt;<a class="code" href="classptx__thread__info.html#a004f522e8c39d5404d4278659c6196cd">set_done</a>();
<a name="l03177"></a>03177    thread-&gt;<a class="code" href="classptx__thread__info.html#aede5addae6f87f77407ebae85dc3d7fe">exitCore</a>();
<a name="l03178"></a>03178    thread-&gt;<a class="code" href="classptx__thread__info.html#a021336f7273f7176a38c284b720e02fa">registerExit</a>();
<a name="l03179"></a>03179    }
<a name="l03180"></a>03180 }
<a name="l03181"></a>03181 
<a name="l03182"></a>03182 <span class="comment">//Ptxplus version of ret instruction.</span>
<a name="l03183"></a><a class="code" href="instructions_8cc.html#ab4dda563f8f696c53780f569b6e50d1f">03183</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ab4dda563f8f696c53780f569b6e50d1f">retp_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread )
<a name="l03184"></a>03184 {
<a name="l03185"></a>03185    <span class="keywordtype">bool</span> <a class="code" href="structCUstream__st.html#a6353e37c5be49616c4619c2be27dd6ab">empty</a> = thread-&gt;<a class="code" href="classptx__thread__info.html#a2287f5e51b6a82f306a36512270a0c8f">callstack_pop_plus</a>();
<a name="l03186"></a>03186    <span class="keywordflow">if</span>( empty ) {
<a name="l03187"></a>03187    thread-&gt;<a class="code" href="classptx__thread__info.html#a004f522e8c39d5404d4278659c6196cd">set_done</a>();
<a name="l03188"></a>03188    thread-&gt;<a class="code" href="classptx__thread__info.html#aede5addae6f87f77407ebae85dc3d7fe">exitCore</a>();
<a name="l03189"></a>03189    thread-&gt;<a class="code" href="classptx__thread__info.html#a021336f7273f7176a38c284b720e02fa">registerExit</a>();
<a name="l03190"></a>03190    }
<a name="l03191"></a>03191 }
<a name="l03192"></a>03192 
<a name="l03193"></a><a class="code" href="instructions_8cc.html#a218cf9af312688b52701caf4edd41c09">03193</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a218cf9af312688b52701caf4edd41c09">rsqrt_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03194"></a>03194 { 
<a name="l03195"></a>03195    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, d;
<a name="l03196"></a>03196    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03197"></a>03197    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03198"></a>03198 
<a name="l03199"></a>03199    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03200"></a>03200    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03201"></a>03201 
<a name="l03202"></a>03202 
<a name="l03203"></a>03203    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03204"></a>03204    <span class="keywordflow">case</span> F32_TYPE:
<a name="l03205"></a>03205       <span class="keywordflow">if</span> ( a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt; 0 ) {
<a name="l03206"></a>03206          d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l03207"></a>03207          d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0x7fc00000; <span class="comment">// NaN</span>
<a name="l03208"></a>03208       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> == 0 ) {
<a name="l03209"></a>03209          d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l03210"></a>03210          d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0x7f800000; <span class="comment">// Inf</span>
<a name="l03211"></a>03211       } <span class="keywordflow">else</span>
<a name="l03212"></a>03212          d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="namespacecuda__math.html#a075dbea46e75020bbcdf178cad4ff9a9">cuda_math::__internal_accurate_fdividef</a>(1.0f, sqrtf(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>));
<a name="l03213"></a>03213       <span class="keywordflow">break</span>;
<a name="l03214"></a>03214    <span class="keywordflow">case</span> F64_TYPE: 
<a name="l03215"></a>03215    <span class="keywordflow">case</span> FF64_TYPE:
<a name="l03216"></a>03216       <span class="keywordflow">if</span> ( a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt; 0 ) {
<a name="l03217"></a>03217          d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l03218"></a>03218           d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0x7fc00000; <span class="comment">// NaN</span>
<a name="l03219"></a>03219          <span class="keywordtype">float</span> x = d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>; 
<a name="l03220"></a>03220          d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = (double)x;
<a name="l03221"></a>03221       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> == 0 ) {
<a name="l03222"></a>03222          d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l03223"></a>03223           d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0x7f800000; <span class="comment">// Inf</span>
<a name="l03224"></a>03224          <span class="keywordtype">float</span> x = d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>; 
<a name="l03225"></a>03225          d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = (double)x;
<a name="l03226"></a>03226       } <span class="keywordflow">else</span>
<a name="l03227"></a>03227          d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = 1.0 / sqrt(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); 
<a name="l03228"></a>03228       <span class="keywordflow">break</span>;
<a name="l03229"></a>03229    <span class="keywordflow">default</span>:
<a name="l03230"></a>03230       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l03231"></a>03231       assert(0);
<a name="l03232"></a>03232       <span class="keywordflow">break</span>;
<a name="l03233"></a>03233    }
<a name="l03234"></a>03234 
<a name="l03235"></a>03235    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l03236"></a>03236 }
<a name="l03237"></a>03237 
<a name="l03238"></a>03238 <span class="preprocessor">#define SAD(d,a,b,c) d = c + ((a&lt;b) ? (b-a) : (a-b))</span>
<a name="l03239"></a>03239 <span class="preprocessor"></span>
<a name="l03240"></a><a class="code" href="instructions_8cc.html#ac04fbb491348467c6d1972631a19e83c">03240</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ac04fbb491348467c6d1972631a19e83c">sad_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03241"></a>03241 { 
<a name="l03242"></a>03242    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b, c, d;
<a name="l03243"></a>03243    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03244"></a>03244    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03245"></a>03245    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03246"></a>03246    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src3 = pI-&gt;<a class="code" href="classptx__instruction.html#ad3166c06dcaaba2b7e6187126d3a07ed">src3</a>();
<a name="l03247"></a>03247 
<a name="l03248"></a>03248    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03249"></a>03249    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03250"></a>03250    b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l03251"></a>03251    c = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src3, dst, i_type, thread, 1);
<a name="l03252"></a>03252 
<a name="l03253"></a>03253 
<a name="l03254"></a>03254    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03255"></a>03255    <span class="keywordflow">case</span> U16_TYPE: SAD(d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>,a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>,b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>,c.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03256"></a>03256    <span class="keywordflow">case</span> U32_TYPE: SAD(d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,c.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03257"></a>03257    <span class="keywordflow">case</span> U64_TYPE: SAD(d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>,a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>,b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>,c.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03258"></a>03258    <span class="keywordflow">case</span> S16_TYPE: SAD(d.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>,a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>,b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>,c.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l03259"></a>03259    <span class="keywordflow">case</span> S32_TYPE: SAD(d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>,a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>,b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>,c.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l03260"></a>03260    <span class="keywordflow">case</span> S64_TYPE: SAD(d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>,a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>,b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>,c.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l03261"></a>03261    <span class="keywordflow">case</span> F32_TYPE: SAD(d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>,a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>,b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>,c.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03262"></a>03262    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: SAD(d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>,a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>,b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>,c.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03263"></a>03263    <span class="keywordflow">default</span>:
<a name="l03264"></a>03264       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l03265"></a>03265       assert(0); 
<a name="l03266"></a>03266       <span class="keywordflow">break</span>;
<a name="l03267"></a>03267    }
<a name="l03268"></a>03268 
<a name="l03269"></a>03269    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l03270"></a>03270 }
<a name="l03271"></a>03271 
<a name="l03272"></a><a class="code" href="instructions_8cc.html#aa03c4c9dfc961733ab01418a9b091a05">03272</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aa03c4c9dfc961733ab01418a9b091a05">selp_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03273"></a>03273 {
<a name="l03274"></a>03274    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03275"></a>03275    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03276"></a>03276    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03277"></a>03277    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src3 = pI-&gt;<a class="code" href="classptx__instruction.html#ad3166c06dcaaba2b7e6187126d3a07ed">src3</a>();
<a name="l03278"></a>03278 
<a name="l03279"></a>03279    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b, c, d;
<a name="l03280"></a>03280 
<a name="l03281"></a>03281    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03282"></a>03282    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03283"></a>03283    b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l03284"></a>03284    c = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src3, dst, i_type, thread, 1);
<a name="l03285"></a>03285 
<a name="l03286"></a>03286    <span class="comment">//predicate value was changed so the lowest bit being set means the zero flag is set.</span>
<a name="l03287"></a>03287    <span class="comment">//As a result, the value of c.pred must be inverted to get proper behavior</span>
<a name="l03288"></a>03288    d = (!(c.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x0001))?a:b;
<a name="l03289"></a>03289 
<a name="l03290"></a>03290    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, PRED_TYPE, thread, pI);
<a name="l03291"></a>03291 }
<a name="l03292"></a>03292 
<a name="l03293"></a><a class="code" href="instructions_8cc.html#a9a2d46977c5427129056f3184af9142e">03293</a> <span class="keywordtype">bool</span> <a class="code" href="instructions_8cc.html#a9a2d46977c5427129056f3184af9142e">isFloat</a>(<span class="keywordtype">int</span> type) 
<a name="l03294"></a>03294 {
<a name="l03295"></a>03295    <span class="keywordflow">switch</span> ( type ) {
<a name="l03296"></a>03296    <span class="keywordflow">case</span> F16_TYPE:
<a name="l03297"></a>03297    <span class="keywordflow">case</span> F32_TYPE:
<a name="l03298"></a>03298    <span class="keywordflow">case</span> F64_TYPE:
<a name="l03299"></a>03299    <span class="keywordflow">case</span> FF64_TYPE:
<a name="l03300"></a>03300       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l03301"></a>03301    <span class="keywordflow">default</span>:
<a name="l03302"></a>03302       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03303"></a>03303    }
<a name="l03304"></a>03304 }
<a name="l03305"></a>03305 
<a name="l03306"></a><a class="code" href="instructions_8cc.html#ae378cfe87ac58885790b4124ab60b632">03306</a> <span class="keywordtype">bool</span> <a class="code" href="instructions_8cc.html#ae378cfe87ac58885790b4124ab60b632">CmpOp</a>( <span class="keywordtype">int</span> type, <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> b, <span class="keywordtype">unsigned</span> cmpop )
<a name="l03307"></a>03307 {
<a name="l03308"></a>03308    <span class="keywordtype">bool</span> t = <span class="keyword">false</span>;
<a name="l03309"></a>03309 
<a name="l03310"></a>03310    <span class="keywordflow">switch</span> ( type ) {
<a name="l03311"></a>03311    <span class="keywordflow">case</span> B16_TYPE: 
<a name="l03312"></a>03312       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03313"></a>03313       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> == b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03314"></a>03314       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> != b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03315"></a>03315       <span class="keywordflow">default</span>:
<a name="l03316"></a>03316          assert(0);
<a name="l03317"></a>03317       }
<a name="l03318"></a>03318 
<a name="l03319"></a>03319    <span class="keywordflow">case</span> B32_TYPE: 
<a name="l03320"></a>03320       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03321"></a>03321       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> == b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03322"></a>03322       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> != b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03323"></a>03323       <span class="keywordflow">default</span>:
<a name="l03324"></a>03324          assert(0);
<a name="l03325"></a>03325       }
<a name="l03326"></a>03326    <span class="keywordflow">case</span> B64_TYPE:
<a name="l03327"></a>03327       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03328"></a>03328       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> == b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03329"></a>03329       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> != b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03330"></a>03330       <span class="keywordflow">default</span>:
<a name="l03331"></a>03331          assert(0);
<a name="l03332"></a>03332       }
<a name="l03333"></a>03333       <span class="keywordflow">break</span>;
<a name="l03334"></a>03334    <span class="keywordflow">case</span> S8_TYPE: 
<a name="l03335"></a>03335    <span class="keywordflow">case</span> S16_TYPE:
<a name="l03336"></a>03336       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03337"></a>03337       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> == b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l03338"></a>03338       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> != b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l03339"></a>03339       <span class="keywordflow">case</span> LT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> &lt; b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l03340"></a>03340       <span class="keywordflow">case</span> LE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l03341"></a>03341       <span class="keywordflow">case</span> GT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> &gt; b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l03342"></a>03342       <span class="keywordflow">case</span> GE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l03343"></a>03343       <span class="keywordflow">default</span>:
<a name="l03344"></a>03344          assert(0);
<a name="l03345"></a>03345       }
<a name="l03346"></a>03346       <span class="keywordflow">break</span>;
<a name="l03347"></a>03347    <span class="keywordflow">case</span> S32_TYPE: 
<a name="l03348"></a>03348       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03349"></a>03349       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> == b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l03350"></a>03350       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> != b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l03351"></a>03351       <span class="keywordflow">case</span> LT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &lt; b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l03352"></a>03352       <span class="keywordflow">case</span> LE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l03353"></a>03353       <span class="keywordflow">case</span> GT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &gt; b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l03354"></a>03354       <span class="keywordflow">case</span> GE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l03355"></a>03355       <span class="keywordflow">default</span>:
<a name="l03356"></a>03356          assert(0);
<a name="l03357"></a>03357       }
<a name="l03358"></a>03358       <span class="keywordflow">break</span>;
<a name="l03359"></a>03359    <span class="keywordflow">case</span> S64_TYPE:
<a name="l03360"></a>03360       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03361"></a>03361       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> == b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l03362"></a>03362       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> != b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l03363"></a>03363       <span class="keywordflow">case</span> LT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &lt; b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l03364"></a>03364       <span class="keywordflow">case</span> LE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l03365"></a>03365       <span class="keywordflow">case</span> GT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &gt; b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l03366"></a>03366       <span class="keywordflow">case</span> GE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l03367"></a>03367       <span class="keywordflow">default</span>:
<a name="l03368"></a>03368          assert(0);
<a name="l03369"></a>03369       }
<a name="l03370"></a>03370       <span class="keywordflow">break</span>;
<a name="l03371"></a>03371    <span class="keywordflow">case</span> U8_TYPE: 
<a name="l03372"></a>03372    <span class="keywordflow">case</span> U16_TYPE: 
<a name="l03373"></a>03373       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03374"></a>03374       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> == b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03375"></a>03375       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> != b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03376"></a>03376       <span class="keywordflow">case</span> LT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &lt; b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03377"></a>03377       <span class="keywordflow">case</span> LE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03378"></a>03378       <span class="keywordflow">case</span> GT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &gt; b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03379"></a>03379       <span class="keywordflow">case</span> GE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03380"></a>03380       <span class="keywordflow">case</span> LO_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &lt; b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03381"></a>03381       <span class="keywordflow">case</span> LS_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03382"></a>03382       <span class="keywordflow">case</span> HI_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &gt; b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03383"></a>03383       <span class="keywordflow">case</span> HS_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>); <span class="keywordflow">break</span>;
<a name="l03384"></a>03384       <span class="keywordflow">default</span>:
<a name="l03385"></a>03385          assert(0);
<a name="l03386"></a>03386       }
<a name="l03387"></a>03387       <span class="keywordflow">break</span>;
<a name="l03388"></a>03388    <span class="keywordflow">case</span> U32_TYPE: 
<a name="l03389"></a>03389       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03390"></a>03390       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> == b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03391"></a>03391       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> != b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03392"></a>03392       <span class="keywordflow">case</span> LT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &lt; b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03393"></a>03393       <span class="keywordflow">case</span> LE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03394"></a>03394       <span class="keywordflow">case</span> GT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &gt; b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03395"></a>03395       <span class="keywordflow">case</span> GE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03396"></a>03396       <span class="keywordflow">case</span> LO_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &lt; b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03397"></a>03397       <span class="keywordflow">case</span> LS_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03398"></a>03398       <span class="keywordflow">case</span> HI_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &gt; b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03399"></a>03399       <span class="keywordflow">case</span> HS_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03400"></a>03400       <span class="keywordflow">default</span>:
<a name="l03401"></a>03401          assert(0);
<a name="l03402"></a>03402       }
<a name="l03403"></a>03403       <span class="keywordflow">break</span>;
<a name="l03404"></a>03404    <span class="keywordflow">case</span> U64_TYPE:
<a name="l03405"></a>03405       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03406"></a>03406       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> == b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03407"></a>03407       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> != b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03408"></a>03408       <span class="keywordflow">case</span> LT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &lt; b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03409"></a>03409       <span class="keywordflow">case</span> LE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03410"></a>03410       <span class="keywordflow">case</span> GT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &gt; b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03411"></a>03411       <span class="keywordflow">case</span> GE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03412"></a>03412       <span class="keywordflow">case</span> LO_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &lt; b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03413"></a>03413       <span class="keywordflow">case</span> LS_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03414"></a>03414       <span class="keywordflow">case</span> HI_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &gt; b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03415"></a>03415       <span class="keywordflow">case</span> HS_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03416"></a>03416       <span class="keywordflow">default</span>:
<a name="l03417"></a>03417          assert(0);
<a name="l03418"></a>03418       }
<a name="l03419"></a>03419       <span class="keywordflow">break</span>;
<a name="l03420"></a>03420    <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l03421"></a>03421    <span class="keywordflow">case</span> F32_TYPE: 
<a name="l03422"></a>03422       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03423"></a>03423       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> == b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03424"></a>03424       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> != b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03425"></a>03425       <span class="keywordflow">case</span> LT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt; b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> ) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03426"></a>03426       <span class="keywordflow">case</span> LE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03427"></a>03427       <span class="keywordflow">case</span> GT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &gt; b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> ) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03428"></a>03428       <span class="keywordflow">case</span> GE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03429"></a>03429       <span class="keywordflow">case</span> EQU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> == b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03430"></a>03430       <span class="keywordflow">case</span> NEU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> != b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03431"></a>03431       <span class="keywordflow">case</span> LTU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt; b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> ) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03432"></a>03432       <span class="keywordflow">case</span> LEU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03433"></a>03433       <span class="keywordflow">case</span> GTU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &gt; b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> ) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03434"></a>03434       <span class="keywordflow">case</span> GEU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03435"></a>03435       <span class="keywordflow">case</span> NUM_OPTION: t = !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03436"></a>03436       <span class="keywordflow">case</span> NAN_OPTION: t = <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03437"></a>03437       <span class="keywordflow">default</span>:
<a name="l03438"></a>03438          assert(0);
<a name="l03439"></a>03439       }
<a name="l03440"></a>03440       <span class="keywordflow">break</span>;
<a name="l03441"></a>03441    <span class="keywordflow">case</span> F64_TYPE: 
<a name="l03442"></a>03442    <span class="keywordflow">case</span> FF64_TYPE:
<a name="l03443"></a>03443       <span class="keywordflow">switch</span> (cmpop) {
<a name="l03444"></a>03444       <span class="keywordflow">case</span> EQ_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> == b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03445"></a>03445       <span class="keywordflow">case</span> NE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> != b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03446"></a>03446       <span class="keywordflow">case</span> LT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &lt; b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> ) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03447"></a>03447       <span class="keywordflow">case</span> LE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03448"></a>03448       <span class="keywordflow">case</span> GT_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &gt; b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> ) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03449"></a>03449       <span class="keywordflow">case</span> GE_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03450"></a>03450       <span class="keywordflow">case</span> EQU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> == b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03451"></a>03451       <span class="keywordflow">case</span> NEU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> != b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03452"></a>03452       <span class="keywordflow">case</span> LTU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &lt; b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> ) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03453"></a>03453       <span class="keywordflow">case</span> LEU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &lt;= b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03454"></a>03454       <span class="keywordflow">case</span> GTU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &gt; b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> ) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03455"></a>03455       <span class="keywordflow">case</span> GEU_OPTION: t = (a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &gt;= b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03456"></a>03456       <span class="keywordflow">case</span> NUM_OPTION: t = !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) &amp;&amp; !<a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03457"></a>03457       <span class="keywordflow">case</span> NAN_OPTION: t = <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>) || <a class="code" href="instructions_8cc.html#a8639ff9b466bfc7b6fc1742154e5f1bb">isNaN</a>(b.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03458"></a>03458       <span class="keywordflow">default</span>:
<a name="l03459"></a>03459          assert(0);
<a name="l03460"></a>03460       }
<a name="l03461"></a>03461       <span class="keywordflow">break</span>;
<a name="l03462"></a>03462    <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l03463"></a>03463    }
<a name="l03464"></a>03464 
<a name="l03465"></a>03465    <span class="keywordflow">return</span> t;
<a name="l03466"></a>03466 }
<a name="l03467"></a>03467 
<a name="l03468"></a><a class="code" href="instructions_8cc.html#a1dbfc98b651d4468aadd1ff2bbc3ac1c">03468</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a1dbfc98b651d4468aadd1ff2bbc3ac1c">setp_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03469"></a>03469 {
<a name="l03470"></a>03470    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b;
<a name="l03471"></a>03471 
<a name="l03472"></a>03472    <span class="keywordtype">int</span> t=0;
<a name="l03473"></a>03473    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03474"></a>03474    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03475"></a>03475    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03476"></a>03476 
<a name="l03477"></a>03477    assert( pI-&gt;<a class="code" href="classptx__instruction.html#a8c20877db07add4aacd26ce9a183fb2e">get_num_operands</a>() &lt; 4 ); <span class="comment">// or need to deal with &quot;c&quot; operand / boolOp</span>
<a name="l03478"></a>03478 
<a name="l03479"></a>03479    <span class="keywordtype">unsigned</span> type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03480"></a>03480    <span class="keywordtype">unsigned</span> cmpop = pI-&gt;<a class="code" href="classptx__instruction.html#a405f6a45098dae921e4174dd4a412edc">get_cmpop</a>();
<a name="l03481"></a>03481    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, type, thread, 1);
<a name="l03482"></a>03482    b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, type, thread, 1);
<a name="l03483"></a>03483 
<a name="l03484"></a>03484    t = <a class="code" href="instructions_8cc.html#ae378cfe87ac58885790b4124ab60b632">CmpOp</a>(type,a,b,cmpop);
<a name="l03485"></a>03485 
<a name="l03486"></a>03486    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l03487"></a>03487 
<a name="l03488"></a>03488    <span class="comment">//the way ptxplus handles the zero flag, 1 = false and 0 = true</span>
<a name="l03489"></a>03489    data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = (t==0); <span class="comment">//inverting predicate since ptxplus uses &quot;1&quot; for a set zero flag</span>
<a name="l03490"></a>03490 
<a name="l03491"></a>03491    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, PRED_TYPE, thread, pI);
<a name="l03492"></a>03492 }
<a name="l03493"></a>03493 
<a name="l03494"></a><a class="code" href="instructions_8cc.html#afe108464af34dbd60145758765232039">03494</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#afe108464af34dbd60145758765232039">set_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03495"></a>03495 { 
<a name="l03496"></a>03496    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b;
<a name="l03497"></a>03497 
<a name="l03498"></a>03498    <span class="keywordtype">int</span> t=0;
<a name="l03499"></a>03499    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03500"></a>03500    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03501"></a>03501    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03502"></a>03502 
<a name="l03503"></a>03503    assert( pI-&gt;<a class="code" href="classptx__instruction.html#a8c20877db07add4aacd26ce9a183fb2e">get_num_operands</a>() &lt; 4 ); <span class="comment">// or need to deal with &quot;c&quot; operand / boolOp</span>
<a name="l03504"></a>03504 
<a name="l03505"></a>03505    <span class="keywordtype">unsigned</span> src_type = pI-&gt;<a class="code" href="classptx__instruction.html#a65ccc3829d2356648a9865c42bc91409">get_type2</a>();
<a name="l03506"></a>03506    <span class="keywordtype">unsigned</span> cmpop = pI-&gt;<a class="code" href="classptx__instruction.html#a405f6a45098dae921e4174dd4a412edc">get_cmpop</a>();
<a name="l03507"></a>03507 
<a name="l03508"></a>03508    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, src_type, thread, 1);
<a name="l03509"></a>03509    b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, src_type, thread, 1);
<a name="l03510"></a>03510 
<a name="l03511"></a>03511    <span class="comment">// Take abs of first operand if needed</span>
<a name="l03512"></a>03512    <span class="keywordflow">if</span>(pI-&gt;<a class="code" href="classptx__instruction.html#a44329c131a2de7a39220dea44434b1c2">is_abs</a>()) {
<a name="l03513"></a>03513       <span class="keywordflow">switch</span> ( src_type ) {
<a name="l03514"></a>03514       <span class="keywordflow">case</span> S16_TYPE: a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>); <span class="keywordflow">break</span>;
<a name="l03515"></a>03515       <span class="keywordflow">case</span> S32_TYPE: a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>); <span class="keywordflow">break</span>;
<a name="l03516"></a>03516       <span class="keywordflow">case</span> S64_TYPE: a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>); <span class="keywordflow">break</span>;
<a name="l03517"></a>03517       <span class="keywordflow">case</span> U16_TYPE: a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>; <span class="keywordflow">break</span>;
<a name="l03518"></a>03518       <span class="keywordflow">case</span> U32_TYPE: a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>); <span class="keywordflow">break</span>;
<a name="l03519"></a>03519       <span class="keywordflow">case</span> U64_TYPE: a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); <span class="keywordflow">break</span>;
<a name="l03520"></a>03520       <span class="keywordflow">case</span> F32_TYPE: a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03521"></a>03521       <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = my_abs(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03522"></a>03522       <span class="keywordflow">default</span>:
<a name="l03523"></a>03523          printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l03524"></a>03524          assert(0);
<a name="l03525"></a>03525          <span class="keywordflow">break</span>;
<a name="l03526"></a>03526       }
<a name="l03527"></a>03527    }
<a name="l03528"></a>03528 
<a name="l03529"></a>03529    t = <a class="code" href="instructions_8cc.html#ae378cfe87ac58885790b4124ab60b632">CmpOp</a>(src_type,a,b,cmpop);
<a name="l03530"></a>03530 
<a name="l03531"></a>03531    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l03532"></a>03532    <span class="keywordflow">if</span> ( <a class="code" href="instructions_8cc.html#a9a2d46977c5427129056f3184af9142e">isFloat</a>(pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>()) ) {
<a name="l03533"></a>03533       data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = (t!=0)?1.0f:0.0f;
<a name="l03534"></a>03534    } <span class="keywordflow">else</span> {
<a name="l03535"></a>03535       data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = (t!=0)?0xFFFFFFFF:0;
<a name="l03536"></a>03536    }
<a name="l03537"></a>03537 
<a name="l03538"></a>03538    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, data, pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>(), thread, pI);
<a name="l03539"></a>03539 
<a name="l03540"></a>03540 }
<a name="l03541"></a>03541 
<a name="l03542"></a><a class="code" href="instructions_8cc.html#a2757784e7002d200fc6caf67a6d985e3">03542</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a2757784e7002d200fc6caf67a6d985e3">shfl_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classcore__t.html">core_t</a> *core, <a class="code" href="classwarp__inst__t.html">warp_inst_t</a> inst )
<a name="l03543"></a>03543 {
<a name="l03544"></a>03544     <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03545"></a>03545     <span class="keywordtype">int</span> tid = inst.<a class="code" href="classwarp__inst__t.html#ab1dd215e5b3d4083cdb473d4f8bf8bf2">warp_id</a>() * core-&gt;<a class="code" href="classcore__t.html#adc93c7c27d376c9b2fc667fef27647d0">get_warp_size</a>();
<a name="l03546"></a>03546     <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread = core-&gt;<a class="code" href="classcore__t.html#afc25ee515c386a8b965f09020a8b49c2">get_thread_info</a>()[tid];
<a name="l03547"></a>03547     <a class="code" href="classptx__warp__info.html">ptx_warp_info</a> *warp_info = thread-&gt;<a class="code" href="classptx__thread__info.html#a2c1803a0c8c6e846715290e52bb6b5b0">m_warp_info</a>;
<a name="l03548"></a>03548     <span class="keywordtype">int</span> lane = warp_info-&gt;<a class="code" href="classptx__warp__info.html#af0617c781c25cd651401d3b772af7efb">get_done_threads</a>();
<a name="l03549"></a>03549     thread = core-&gt;<a class="code" href="classcore__t.html#afc25ee515c386a8b965f09020a8b49c2">get_thread_info</a>()[tid + lane];
<a name="l03550"></a>03550 
<a name="l03551"></a>03551     <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03552"></a>03552     <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03553"></a>03553     <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03554"></a>03554     <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src3 = pI-&gt;<a class="code" href="classptx__instruction.html#ad3166c06dcaaba2b7e6187126d3a07ed">src3</a>();
<a name="l03555"></a>03555     <span class="keywordtype">int</span> bval = (thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1)).u32;
<a name="l03556"></a>03556     <span class="keywordtype">int</span> cval = (thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src3, dst, i_type, thread, 1)).u32;
<a name="l03557"></a>03557     <span class="keywordtype">int</span> mask = cval &gt;&gt; 8;
<a name="l03558"></a>03558     bval &amp;= 0x1F;
<a name="l03559"></a>03559     cval &amp;= 0x1F;
<a name="l03560"></a>03560 
<a name="l03561"></a>03561     <span class="keywordtype">int</span> maxLane = (lane &amp; mask) | (cval &amp; ~mask);
<a name="l03562"></a>03562     <span class="keywordtype">int</span> minLane = lane &amp; mask;
<a name="l03563"></a>03563 
<a name="l03564"></a>03564     <span class="keywordtype">int</span> src_idx;
<a name="l03565"></a>03565     <span class="keywordtype">unsigned</span> p;
<a name="l03566"></a>03566     <span class="keywordflow">switch</span>(pI-&gt;<a class="code" href="classptx__instruction.html#a5387a65d6d083eb2a5ab2585402c8992">shfl_op</a>()) {
<a name="l03567"></a>03567     <span class="keywordflow">case</span> UP_OPTION:
<a name="l03568"></a>03568         src_idx = lane - bval;
<a name="l03569"></a>03569         p = (src_idx &gt;= maxLane);
<a name="l03570"></a>03570         <span class="keywordflow">break</span>;
<a name="l03571"></a>03571     <span class="keywordflow">case</span> DOWN_OPTION:
<a name="l03572"></a>03572         src_idx = lane + bval;
<a name="l03573"></a>03573         p = (src_idx &lt;= maxLane);
<a name="l03574"></a>03574         <span class="keywordflow">break</span>;
<a name="l03575"></a>03575     <span class="keywordflow">case</span> BFLY_OPTION:
<a name="l03576"></a>03576         src_idx = lane ^ bval;
<a name="l03577"></a>03577         p = (src_idx &lt;= maxLane);
<a name="l03578"></a>03578         <span class="keywordflow">break</span>;
<a name="l03579"></a>03579     <span class="keywordflow">case</span> IDX_OPTION:
<a name="l03580"></a>03580         src_idx = minLane | (bval &amp; ~mask);
<a name="l03581"></a>03581         p = (src_idx &lt;= maxLane);
<a name="l03582"></a>03582         <span class="keywordflow">break</span>;
<a name="l03583"></a>03583     <span class="keywordflow">default</span>:
<a name="l03584"></a>03584         printf(<span class="stringliteral">&quot;GPGPU-Sim PTX: ERROR: Invalid shfl option\n&quot;</span>);
<a name="l03585"></a>03585         assert(0);
<a name="l03586"></a>03586         <span class="keywordflow">break</span>;
<a name="l03587"></a>03587     }
<a name="l03588"></a>03588     <span class="comment">// copy from own lane</span>
<a name="l03589"></a>03589     <span class="keywordflow">if</span> (!p) src_idx = lane;
<a name="l03590"></a>03590 
<a name="l03591"></a>03591     <span class="comment">// copy input from lane src_idx</span>
<a name="l03592"></a>03592     <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l03593"></a>03593     <span class="keywordflow">if</span> (inst.<a class="code" href="classwarp__inst__t.html#ae44d8d3d283dc0ecf16db55f57f3c03d">active</a>(src_idx)) {
<a name="l03594"></a>03594         <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *source = core-&gt;<a class="code" href="classcore__t.html#afc25ee515c386a8b965f09020a8b49c2">get_thread_info</a>()[tid + src_idx];
<a name="l03595"></a>03595         data = source-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, source, 1);
<a name="l03596"></a>03596     } <span class="keywordflow">else</span> {
<a name="l03597"></a>03597         printf(<span class="stringliteral">&quot;GPGPU-Sim PTX: WARNING: shfl input value unpredictable for inactive threads in a warp\n&quot;</span>);
<a name="l03598"></a>03598         data.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0;
<a name="l03599"></a>03599     }
<a name="l03600"></a>03600     thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, data, i_type, thread, pI);
<a name="l03601"></a>03601 
<a name="l03602"></a>03602     <span class="comment">/*</span>
<a name="l03603"></a>03603 <span class="comment">    TODO: deal with predicates appropriately using the following pseudocode:</span>
<a name="l03604"></a>03604 <span class="comment">    if (!isGuardPredicateTrue(src_idx)) {</span>
<a name="l03605"></a>03605 <span class="comment">        printf(&quot;GPGPU-Sim PTX: WARNING: shfl input value unpredictable for predicated-off threads in a warp\n&quot;);</span>
<a name="l03606"></a>03606 <span class="comment">    }</span>
<a name="l03607"></a>03607 <span class="comment">    if (dest predicate selected) data.pred = p;</span>
<a name="l03608"></a>03608 <span class="comment">    */</span>
<a name="l03609"></a>03609 
<a name="l03610"></a>03610     <span class="comment">// keep track of the number of threads that have executed in the warp</span>
<a name="l03611"></a>03611     warp_info-&gt;<a class="code" href="classptx__warp__info.html#a0be9ba3200447259ef3f8a40fd9552fa">inc_done_threads</a>();
<a name="l03612"></a>03612     <span class="keywordflow">if</span> (warp_info-&gt;<a class="code" href="classptx__warp__info.html#af0617c781c25cd651401d3b772af7efb">get_done_threads</a>() == inst.<a class="code" href="classwarp__inst__t.html#ae2478f41ed1d4ce60ceec0fa5a85623a">active_count</a>()) {
<a name="l03613"></a>03613         warp_info-&gt;<a class="code" href="classptx__warp__info.html#aef2270dd3de1ed1b5824215d494fd7ba">reset_done_threads</a>();
<a name="l03614"></a>03614     }
<a name="l03615"></a>03615 }
<a name="l03616"></a>03616 
<a name="l03617"></a><a class="code" href="instructions_8cc.html#a584dff14212323d8efd63a978f23c483">03617</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a584dff14212323d8efd63a978f23c483">shl_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03618"></a>03618 {
<a name="l03619"></a>03619    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b, d;
<a name="l03620"></a>03620    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03621"></a>03621    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03622"></a>03622    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03623"></a>03623 
<a name="l03624"></a>03624    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03625"></a>03625    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03626"></a>03626    b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l03627"></a>03627 
<a name="l03628"></a>03628    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03629"></a>03629    <span class="keywordflow">case</span> B16_TYPE:
<a name="l03630"></a>03630    <span class="keywordflow">case</span> U16_TYPE:
<a name="l03631"></a>03631       <span class="keywordflow">if</span> ( b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &gt;= 16 )
<a name="l03632"></a>03632          d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = 0;
<a name="l03633"></a>03633       <span class="keywordflow">else</span>
<a name="l03634"></a>03634          d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = (<span class="keywordtype">unsigned</span> short) ((a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &lt;&lt; b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>) &amp; 0xFFFF); 
<a name="l03635"></a>03635       <span class="keywordflow">break</span>;
<a name="l03636"></a>03636    <span class="keywordflow">case</span> B32_TYPE: 
<a name="l03637"></a>03637    <span class="keywordflow">case</span> U32_TYPE: 
<a name="l03638"></a>03638       <span class="keywordflow">if</span> ( b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &gt;= 32 )
<a name="l03639"></a>03639          d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0;
<a name="l03640"></a>03640       <span class="keywordflow">else</span>
<a name="l03641"></a>03641          d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = (unsigned) ((a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &lt;&lt; b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>) &amp; 0xFFFFFFFF); 
<a name="l03642"></a>03642       <span class="keywordflow">break</span>;
<a name="l03643"></a>03643    <span class="keywordflow">case</span> B64_TYPE: 
<a name="l03644"></a>03644    <span class="keywordflow">case</span> U64_TYPE: 
<a name="l03645"></a>03645       <span class="keywordflow">if</span> ( b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &gt;= 64 )
<a name="l03646"></a>03646          d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l03647"></a>03647       <span class="keywordflow">else</span>
<a name="l03648"></a>03648          d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &lt;&lt; b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>); 
<a name="l03649"></a>03649       <span class="keywordflow">break</span>;
<a name="l03650"></a>03650    <span class="keywordflow">default</span>:
<a name="l03651"></a>03651       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l03652"></a>03652       assert(0); 
<a name="l03653"></a>03653       <span class="keywordflow">break</span>;
<a name="l03654"></a>03654    }
<a name="l03655"></a>03655 
<a name="l03656"></a>03656    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst, d, i_type, thread, pI);
<a name="l03657"></a>03657 }
<a name="l03658"></a>03658 
<a name="l03659"></a><a class="code" href="instructions_8cc.html#ab31aff106f92676c54d959208540ce3b">03659</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ab31aff106f92676c54d959208540ce3b">shr_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread )
<a name="l03660"></a>03660 {
<a name="l03661"></a>03661    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b, d;
<a name="l03662"></a>03662    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03663"></a>03663    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03664"></a>03664    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03665"></a>03665 
<a name="l03666"></a>03666    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03667"></a>03667    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03668"></a>03668    b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l03669"></a>03669 
<a name="l03670"></a>03670 
<a name="l03671"></a>03671    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03672"></a>03672    <span class="keywordflow">case</span> U16_TYPE:
<a name="l03673"></a>03673    <span class="keywordflow">case</span> B16_TYPE: 
<a name="l03674"></a>03674       <span class="keywordflow">if</span> ( b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &lt; 16 )
<a name="l03675"></a>03675          d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = (<span class="keywordtype">unsigned</span> short) ((a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &gt;&gt; b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>) &amp; 0xFFFF);
<a name="l03676"></a>03676       <span class="keywordflow">else</span>
<a name="l03677"></a>03677          d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = 0;
<a name="l03678"></a>03678       <span class="keywordflow">break</span>;
<a name="l03679"></a>03679    <span class="keywordflow">case</span> U32_TYPE:
<a name="l03680"></a>03680    <span class="keywordflow">case</span> B32_TYPE: 
<a name="l03681"></a>03681       <span class="keywordflow">if</span> ( b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &lt; 32 )
<a name="l03682"></a>03682          d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = (unsigned) ((a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &gt;&gt; b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>) &amp; 0xFFFFFFFF);
<a name="l03683"></a>03683       <span class="keywordflow">else</span>
<a name="l03684"></a>03684          d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = 0;
<a name="l03685"></a>03685       <span class="keywordflow">break</span>;
<a name="l03686"></a>03686    <span class="keywordflow">case</span> U64_TYPE:
<a name="l03687"></a>03687    <span class="keywordflow">case</span> B64_TYPE: 
<a name="l03688"></a>03688       <span class="keywordflow">if</span> ( b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &lt; 64 )
<a name="l03689"></a>03689          d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &gt;&gt; b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l03690"></a>03690       <span class="keywordflow">else</span>
<a name="l03691"></a>03691          d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = 0;
<a name="l03692"></a>03692       <span class="keywordflow">break</span>;
<a name="l03693"></a>03693    <span class="keywordflow">case</span> S16_TYPE: 
<a name="l03694"></a>03694       <span class="keywordflow">if</span> ( b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> &lt; 16 )
<a name="l03695"></a>03695          d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> &gt;&gt; b.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a>);
<a name="l03696"></a>03696       <span class="keywordflow">else</span> {
<a name="l03697"></a>03697          <span class="keywordflow">if</span> ( a.<a class="code" href="unionptx__reg__t.html#a90de0d1f597395e1ffaa24a726d24575">s16</a> &lt; 0 ) {
<a name="l03698"></a>03698             d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = -1;
<a name="l03699"></a>03699          } <span class="keywordflow">else</span> {
<a name="l03700"></a>03700             d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = 0;
<a name="l03701"></a>03701          }
<a name="l03702"></a>03702       }
<a name="l03703"></a>03703       <span class="keywordflow">break</span>;
<a name="l03704"></a>03704    <span class="keywordflow">case</span> S32_TYPE: 
<a name="l03705"></a>03705       <span class="keywordflow">if</span> ( b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> &lt; 32 )
<a name="l03706"></a>03706          d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &gt;&gt; b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>);
<a name="l03707"></a>03707       <span class="keywordflow">else</span> {
<a name="l03708"></a>03708          <span class="keywordflow">if</span> ( a.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &lt; 0 ) {
<a name="l03709"></a>03709             d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = -1;
<a name="l03710"></a>03710          } <span class="keywordflow">else</span> {
<a name="l03711"></a>03711             d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = 0;
<a name="l03712"></a>03712          }
<a name="l03713"></a>03713       }
<a name="l03714"></a>03714       <span class="keywordflow">break</span>;
<a name="l03715"></a>03715    <span class="keywordflow">case</span> S64_TYPE: 
<a name="l03716"></a>03716       <span class="keywordflow">if</span> ( b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &lt; 64 )
<a name="l03717"></a>03717          d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &gt;&gt; b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l03718"></a>03718       <span class="keywordflow">else</span> {
<a name="l03719"></a>03719          <span class="keywordflow">if</span> ( a.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &lt; 0 ) {
<a name="l03720"></a>03720             <span class="keywordflow">if</span> ( b.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &lt; 0 ) {
<a name="l03721"></a>03721                d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = -1;
<a name="l03722"></a>03722                d.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> = 0;
<a name="l03723"></a>03723             } <span class="keywordflow">else</span> {
<a name="l03724"></a>03724                d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = -1;
<a name="l03725"></a>03725             }
<a name="l03726"></a>03726          } <span class="keywordflow">else</span> {
<a name="l03727"></a>03727             d.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = 0;
<a name="l03728"></a>03728          }
<a name="l03729"></a>03729       }
<a name="l03730"></a>03730       <span class="keywordflow">break</span>;
<a name="l03731"></a>03731    <span class="keywordflow">default</span>:
<a name="l03732"></a>03732       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l03733"></a>03733       assert(0); 
<a name="l03734"></a>03734       <span class="keywordflow">break</span>;
<a name="l03735"></a>03735    }
<a name="l03736"></a>03736 
<a name="l03737"></a>03737    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l03738"></a>03738 }
<a name="l03739"></a>03739 
<a name="l03740"></a><a class="code" href="instructions_8cc.html#a6b55b7649e639ff78690d0b40f95b2d2">03740</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a6b55b7649e639ff78690d0b40f95b2d2">sin_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03741"></a>03741 {
<a name="l03742"></a>03742    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, d;
<a name="l03743"></a>03743    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03744"></a>03744    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03745"></a>03745 
<a name="l03746"></a>03746    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03747"></a>03747    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03748"></a>03748 
<a name="l03749"></a>03749 
<a name="l03750"></a>03750    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03751"></a>03751    <span class="keywordflow">case</span> F32_TYPE: 
<a name="l03752"></a>03752       d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = sin(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>);
<a name="l03753"></a>03753       <span class="keywordflow">break</span>;
<a name="l03754"></a>03754    <span class="keywordflow">default</span>:
<a name="l03755"></a>03755       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l03756"></a>03756       assert(0); 
<a name="l03757"></a>03757       <span class="keywordflow">break</span>;
<a name="l03758"></a>03758    }
<a name="l03759"></a>03759 
<a name="l03760"></a>03760    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l03761"></a>03761 }
<a name="l03762"></a>03762 
<a name="l03763"></a><a class="code" href="instructions_8cc.html#a32baf1c2ec90ac01716768bb3623b901">03763</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a32baf1c2ec90ac01716768bb3623b901">slct_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03764"></a>03764 { 
<a name="l03765"></a>03765    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03766"></a>03766    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03767"></a>03767    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03768"></a>03768    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src3 = pI-&gt;<a class="code" href="classptx__instruction.html#ad3166c06dcaaba2b7e6187126d3a07ed">src3</a>();
<a name="l03769"></a>03769 
<a name="l03770"></a>03770    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, b, c, d;
<a name="l03771"></a>03771 
<a name="l03772"></a>03772    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03773"></a>03773    <span class="keywordtype">unsigned</span> c_type = pI-&gt;<a class="code" href="classptx__instruction.html#a65ccc3829d2356648a9865c42bc91409">get_type2</a>();
<a name="l03774"></a>03774    <span class="keywordtype">bool</span> t = <span class="keyword">false</span>;
<a name="l03775"></a>03775    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03776"></a>03776    b = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l03777"></a>03777    c = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src3, dst, c_type, thread, 1);
<a name="l03778"></a>03778 
<a name="l03779"></a>03779    <span class="keywordflow">switch</span> ( c_type ) {
<a name="l03780"></a>03780    <span class="keywordflow">case</span> S32_TYPE: t = c.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &gt;= 0; <span class="keywordflow">break</span>;
<a name="l03781"></a>03781    <span class="keywordflow">case</span> F32_TYPE: t = c.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &gt;= 0; <span class="keywordflow">break</span>;
<a name="l03782"></a>03782    <span class="keywordflow">default</span>: assert(0);
<a name="l03783"></a>03783    }
<a name="l03784"></a>03784 
<a name="l03785"></a>03785    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03786"></a>03786    <span class="keywordflow">case</span> B16_TYPE:
<a name="l03787"></a>03787    <span class="keywordflow">case</span> S16_TYPE:
<a name="l03788"></a>03788    <span class="keywordflow">case</span> U16_TYPE: d.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a> = t?a.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>:b.<a class="code" href="unionptx__reg__t.html#abb059206511485a86069cef1b7c0b2da">u16</a>; <span class="keywordflow">break</span>;
<a name="l03789"></a>03789    <span class="keywordflow">case</span> F32_TYPE:
<a name="l03790"></a>03790    <span class="keywordflow">case</span> B32_TYPE:
<a name="l03791"></a>03791    <span class="keywordflow">case</span> S32_TYPE:
<a name="l03792"></a>03792    <span class="keywordflow">case</span> U32_TYPE: d.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> = t?a.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>:b.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>; <span class="keywordflow">break</span>;
<a name="l03793"></a>03793    <span class="keywordflow">case</span> F64_TYPE:
<a name="l03794"></a>03794    <span class="keywordflow">case</span> FF64_TYPE:
<a name="l03795"></a>03795    <span class="keywordflow">case</span> B64_TYPE:
<a name="l03796"></a>03796    <span class="keywordflow">case</span> S64_TYPE:
<a name="l03797"></a>03797    <span class="keywordflow">case</span> U64_TYPE: d.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = t?a.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>:b.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>; <span class="keywordflow">break</span>;
<a name="l03798"></a>03798    <span class="keywordflow">default</span>: assert(0);
<a name="l03799"></a>03799    }
<a name="l03800"></a>03800 
<a name="l03801"></a>03801    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l03802"></a>03802 }
<a name="l03803"></a>03803 
<a name="l03804"></a><a class="code" href="instructions_8cc.html#ab38fd7aad82e552f52abbbcb97b96e36">03804</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ab38fd7aad82e552f52abbbcb97b96e36">sqrt_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03805"></a>03805 { 
<a name="l03806"></a>03806    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> a, d;
<a name="l03807"></a>03807    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03808"></a>03808    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03809"></a>03809 
<a name="l03810"></a>03810    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03811"></a>03811    a = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03812"></a>03812 
<a name="l03813"></a>03813 
<a name="l03814"></a>03814    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03815"></a>03815    <span class="keywordflow">case</span> F32_TYPE: 
<a name="l03816"></a>03816       <span class="keywordflow">if</span> ( a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> &lt; 0 )
<a name="l03817"></a>03817          d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = nanf(<span class="stringliteral">&quot;&quot;</span>);
<a name="l03818"></a>03818       <span class="keywordflow">else</span>
<a name="l03819"></a>03819          d.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = sqrt(a.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>); <span class="keywordflow">break</span>;
<a name="l03820"></a>03820    <span class="keywordflow">case</span> F64_TYPE: 
<a name="l03821"></a>03821    <span class="keywordflow">case</span> FF64_TYPE:
<a name="l03822"></a>03822       <span class="keywordflow">if</span> ( a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> &lt; 0 )
<a name="l03823"></a>03823          d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = nan(<span class="stringliteral">&quot;&quot;</span>);
<a name="l03824"></a>03824       <span class="keywordflow">else</span>
<a name="l03825"></a>03825          d.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = sqrt(a.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>); <span class="keywordflow">break</span>;
<a name="l03826"></a>03826    <span class="keywordflow">default</span>:
<a name="l03827"></a>03827       printf(<span class="stringliteral">&quot;Execution error: type mismatch with instruction\n&quot;</span>);
<a name="l03828"></a>03828       assert(0);
<a name="l03829"></a>03829       <span class="keywordflow">break</span>;
<a name="l03830"></a>03830    }
<a name="l03831"></a>03831 
<a name="l03832"></a>03832    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,d, i_type, thread, pI);
<a name="l03833"></a>03833 }
<a name="l03834"></a>03834 
<a name="l03835"></a><a class="code" href="instructions_8cc.html#a4832acf44bd4bddec9f12ab8a1edc420">03835</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a4832acf44bd4bddec9f12ab8a1edc420">ssy_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03836"></a>03836 {
<a name="l03837"></a>03837    <span class="comment">//printf(&quot;Execution Warning: unimplemented ssy instruction is treated as a nop\n&quot;);</span>
<a name="l03838"></a>03838    <span class="comment">// TODO: add implementation</span>
<a name="l03839"></a>03839 }
<a name="l03840"></a>03840 
<a name="l03841"></a><a class="code" href="instructions_8cc.html#a95da9a1b623cc7e8e6d0ecd59aff3b3e">03841</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a95da9a1b623cc7e8e6d0ecd59aff3b3e">st_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03842"></a>03842 {
<a name="l03843"></a>03843    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03844"></a>03844    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>(); <span class="comment">//may be scalar or vector of regs</span>
<a name="l03845"></a>03845    <span class="keywordtype">unsigned</span> type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03846"></a>03846    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> addr_reg = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(dst, dst, type, thread, 1);
<a name="l03847"></a>03847    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l03848"></a>03848    <a class="code" href="classmemory__space__t.html">memory_space_t</a> space = pI-&gt;<a class="code" href="classptx__instruction.html#a93c8cf0ec080e4e0b0672e9e2ff8328e">get_space</a>();
<a name="l03849"></a>03849    <span class="keywordtype">unsigned</span> vector_spec = pI-&gt;<a class="code" href="classptx__instruction.html#aeedec39ded36b742e6fa59a3a4b83b3c">get_vector</a>();
<a name="l03850"></a>03850 
<a name="l03851"></a>03851    <a class="code" href="classmemory__space.html">memory_space</a> *mem = NULL;
<a name="l03852"></a>03852    <a class="code" href="abstract__hardware__model_8h.html#a92b0c0d30c36a95c916f27a55784ca33">addr_t</a> addr = addr_reg.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>;
<a name="l03853"></a>03853 
<a name="l03854"></a>03854    <a class="code" href="cuda__device__printf_8cc.html#aba16c3439b22dd0d69d4502beac6e7c6">decode_space</a>(space,thread,dst,mem,addr);
<a name="l03855"></a>03855 
<a name="l03856"></a>03856    <span class="keywordtype">size_t</span> size;
<a name="l03857"></a>03857    <span class="keywordtype">int</span> t;
<a name="l03858"></a>03858    <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(type,size,t);
<a name="l03859"></a>03859 
<a name="l03860"></a>03860    <span class="keywordflow">if</span> (!vector_spec) {
<a name="l03861"></a>03861       data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, type, thread, 1);
<a name="l03862"></a>03862       mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(addr,size/8,&amp;data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>,thread,pI);
<a name="l03863"></a>03863    } <span class="keywordflow">else</span> {
<a name="l03864"></a>03864       <span class="keywordflow">if</span> (vector_spec == V2_TYPE) {
<a name="l03865"></a>03865          <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>* ptx_regs = <span class="keyword">new</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>[2]; 
<a name="l03866"></a>03866          thread-&gt;<a class="code" href="classptx__thread__info.html#a4e9d2673a65c55339ae395075cdba6cd">get_vector_operand_values</a>(src1, ptx_regs, 2); 
<a name="l03867"></a>03867          mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(addr,size/8,&amp;ptx_regs[0].s64,thread,pI);
<a name="l03868"></a>03868          mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(addr+size/8,size/8,&amp;ptx_regs[1].s64,thread,pI);
<a name="l03869"></a>03869          <span class="keyword">delete</span> [] ptx_regs;
<a name="l03870"></a>03870       }
<a name="l03871"></a>03871       <span class="keywordflow">if</span> (vector_spec == V3_TYPE) {
<a name="l03872"></a>03872          <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>* ptx_regs = <span class="keyword">new</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>[3]; 
<a name="l03873"></a>03873          thread-&gt;<a class="code" href="classptx__thread__info.html#a4e9d2673a65c55339ae395075cdba6cd">get_vector_operand_values</a>(src1, ptx_regs, 3); 
<a name="l03874"></a>03874          mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(addr,size/8,&amp;ptx_regs[0].s64,thread,pI);
<a name="l03875"></a>03875          mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(addr+size/8,size/8,&amp;ptx_regs[1].s64,thread,pI);
<a name="l03876"></a>03876          mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(addr+2*size/8,size/8,&amp;ptx_regs[2].s64,thread,pI);
<a name="l03877"></a>03877          <span class="keyword">delete</span> [] ptx_regs;
<a name="l03878"></a>03878       }
<a name="l03879"></a>03879       <span class="keywordflow">if</span> (vector_spec == V4_TYPE) {
<a name="l03880"></a>03880          <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>* ptx_regs = <span class="keyword">new</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>[4]; 
<a name="l03881"></a>03881          thread-&gt;<a class="code" href="classptx__thread__info.html#a4e9d2673a65c55339ae395075cdba6cd">get_vector_operand_values</a>(src1, ptx_regs, 4); 
<a name="l03882"></a>03882          mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(addr,size/8,&amp;ptx_regs[0].s64,thread,pI);
<a name="l03883"></a>03883          mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(addr+size/8,size/8,&amp;ptx_regs[1].s64,thread,pI);
<a name="l03884"></a>03884          mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(addr+2*size/8,size/8,&amp;ptx_regs[2].s64,thread,pI);
<a name="l03885"></a>03885          mem-&gt;<a class="code" href="classmemory__space.html#acc4d70cea1a6c55b70c527b6c80d62a5">write</a>(addr+3*size/8,size/8,&amp;ptx_regs[3].s64,thread,pI);
<a name="l03886"></a>03886          <span class="keyword">delete</span> [] ptx_regs;
<a name="l03887"></a>03887       }
<a name="l03888"></a>03888    }
<a name="l03889"></a>03889    thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = addr;
<a name="l03890"></a>03890    thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = space; 
<a name="l03891"></a>03891 }
<a name="l03892"></a>03892 
<a name="l03893"></a><a class="code" href="instructions_8cc.html#a820dfd6a066492bba915013a90a01c34">03893</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a820dfd6a066492bba915013a90a01c34">sub_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03894"></a>03894 {
<a name="l03895"></a>03895    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l03896"></a>03896    <span class="keywordtype">int</span> overflow = 0;
<a name="l03897"></a>03897    <span class="keywordtype">int</span> carry = 0;
<a name="l03898"></a>03898 
<a name="l03899"></a>03899    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l03900"></a>03900    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l03901"></a>03901    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l03902"></a>03902 
<a name="l03903"></a>03903    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l03904"></a>03904    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l03905"></a>03905    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l03906"></a>03906 
<a name="l03907"></a>03907    <span class="comment">//performs addition. Sets carry and overflow if needed.</span>
<a name="l03908"></a>03908    <span class="comment">//the constant is added in during subtraction so the carry bit is set properly.</span>
<a name="l03909"></a>03909    <span class="keywordflow">switch</span> ( i_type ) {
<a name="l03910"></a>03910    <span class="keywordflow">case</span> S8_TYPE:
<a name="l03911"></a>03911       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0xFF) - (src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0xFF) + 0x100;
<a name="l03912"></a>03912       <span class="keywordflow">if</span>(((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80)-(src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80)) != 0) {overflow=((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80)-(data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80))==0?0:1; }
<a name="l03913"></a>03913       carry = (data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &amp; 0x100)&gt;&gt;8;
<a name="l03914"></a>03914       <span class="keywordflow">break</span>;
<a name="l03915"></a>03915    <span class="keywordflow">case</span> S16_TYPE:
<a name="l03916"></a>03916       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0xFFFF) - (src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0xFFFF) + 0x10000;
<a name="l03917"></a>03917       <span class="keywordflow">if</span>(((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000)-(src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000)) != 0) {overflow=((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000)-(data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x8000))==0?0:1; }
<a name="l03918"></a>03918       carry = (data.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a> &amp; 0x10000)&gt;&gt;16;
<a name="l03919"></a>03919       <span class="keywordflow">break</span>;
<a name="l03920"></a>03920    <span class="keywordflow">case</span> S32_TYPE:
<a name="l03921"></a>03921       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0xFFFFFFFF) - (src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0xFFFFFFFF) + 0x100000000;
<a name="l03922"></a>03922       <span class="keywordflow">if</span>(((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000)-(src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000)) != 0) {overflow=((src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000)-(data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> &amp; 0x80000000))==0?0:1; }
<a name="l03923"></a>03923       carry = ((data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>)&gt;&gt;32) &amp; 0x0001;
<a name="l03924"></a>03924       <span class="keywordflow">break</span>;
<a name="l03925"></a>03925    <span class="keywordflow">case</span> S64_TYPE: 
<a name="l03926"></a>03926       data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a> - src2_data.<a class="code" href="unionptx__reg__t.html#ad641012de7aec646bb59a71ee6f4289d">s64</a>; <span class="keywordflow">break</span>;
<a name="l03927"></a>03927    <span class="keywordflow">case</span> B8_TYPE:
<a name="l03928"></a>03928    <span class="keywordflow">case</span> U8_TYPE:
<a name="l03929"></a>03929       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFF) - (src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFF) + 0x100;
<a name="l03930"></a>03930       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x100)&gt;&gt;8;
<a name="l03931"></a>03931       <span class="keywordflow">break</span>;
<a name="l03932"></a>03932    <span class="keywordflow">case</span> B16_TYPE:
<a name="l03933"></a>03933    <span class="keywordflow">case</span> U16_TYPE:
<a name="l03934"></a>03934       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF) - (src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF) + 0x10000;
<a name="l03935"></a>03935       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x10000)&gt;&gt;16;
<a name="l03936"></a>03936       <span class="keywordflow">break</span>;
<a name="l03937"></a>03937    <span class="keywordflow">case</span> B32_TYPE:
<a name="l03938"></a>03938    <span class="keywordflow">case</span> U32_TYPE:
<a name="l03939"></a>03939       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFFFFFF) - (src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFFFFFF) + 0x100000000;
<a name="l03940"></a>03940       carry = (data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0x100000000)&gt;&gt;32;
<a name="l03941"></a>03941       <span class="keywordflow">break</span>;
<a name="l03942"></a>03942    <span class="keywordflow">case</span> B64_TYPE:
<a name="l03943"></a>03943    <span class="keywordflow">case</span> U64_TYPE: 
<a name="l03944"></a>03944       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> - src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>; <span class="keywordflow">break</span>;
<a name="l03945"></a>03945    <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l03946"></a>03946    <span class="keywordflow">case</span> F32_TYPE: data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = src1_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> - src2_data.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>; <span class="keywordflow">break</span>;
<a name="l03947"></a>03947    <span class="keywordflow">case</span> F64_TYPE: <span class="keywordflow">case</span> FF64_TYPE: data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a> - src2_data.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>; <span class="keywordflow">break</span>;
<a name="l03948"></a>03948    <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l03949"></a>03949    }
<a name="l03950"></a>03950 
<a name="l03951"></a>03951    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI, overflow, carry);
<a name="l03952"></a>03952 }
<a name="l03953"></a>03953 
<a name="l03954"></a><a class="code" href="instructions_8cc.html#a9443fb222e3b7f9f162ec70a22649794">03954</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a9443fb222e3b7f9f162ec70a22649794">nop_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l03955"></a>03955 {
<a name="l03956"></a>03956    <span class="comment">// Do nothing</span>
<a name="l03957"></a>03957 }
<a name="l03958"></a>03958 
<a name="l03959"></a><a class="code" href="instructions_8cc.html#a5f30b84be4563bda00e37709f04115bc">03959</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a5f30b84be4563bda00e37709f04115bc">subc_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l03960"></a><a class="code" href="instructions_8cc.html#acc845e406d3bfc2ee1b4cb1cbb93e9d3">03960</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#acc845e406d3bfc2ee1b4cb1cbb93e9d3">suld_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l03961"></a><a class="code" href="instructions_8cc.html#aa8479b0a7839c54302db053da19b45d7">03961</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aa8479b0a7839c54302db053da19b45d7">sured_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l03962"></a><a class="code" href="instructions_8cc.html#acd00344fad81dd6b928c74b9d9aa1b64">03962</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#acd00344fad81dd6b928c74b9d9aa1b64">sust_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l03963"></a><a class="code" href="instructions_8cc.html#a30aa99bff8fb181980de9e253c086815">03963</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a30aa99bff8fb181980de9e253c086815">suq_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l03964"></a>03964 
<a name="l03965"></a><a class="code" href="instructions_8cc.html#a5c30e1b831c1eea1ed513bff829d1e2c">03965</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>* <a class="code" href="instructions_8cc.html#a5c30e1b831c1eea1ed513bff829d1e2c">ptx_tex_regs</a> = NULL;
<a name="l03966"></a>03966 
<a name="l03967"></a><a class="code" href="unionintfloat.html">03967</a> <span class="keyword">union </span><a class="code" href="unionintfloat.html">intfloat</a> {
<a name="l03968"></a><a class="code" href="unionintfloat.html#ab8e61ca8f949268b5fedfdf4addf770e">03968</a>    <span class="keywordtype">int</span> <a class="code" href="unionintfloat.html#ab8e61ca8f949268b5fedfdf4addf770e">a</a>;
<a name="l03969"></a><a class="code" href="unionintfloat.html#a9a8e277a11633a885e514640396cd9d5">03969</a>    <span class="keywordtype">float</span> <a class="code" href="unionintfloat.html#a9a8e277a11633a885e514640396cd9d5">b</a>;
<a name="l03970"></a>03970 };
<a name="l03971"></a>03971 
<a name="l03972"></a><a class="code" href="instructions_8cc.html#aa290629e37a07b1c197574bf8b6818f9">03972</a> <span class="keywordtype">float</span> <a class="code" href="instructions_8cc.html#aa290629e37a07b1c197574bf8b6818f9">reduce_precision</a>( <span class="keywordtype">float</span> x, <span class="keywordtype">unsigned</span> bits )
<a name="l03973"></a>03973 {
<a name="l03974"></a>03974    <a class="code" href="unionintfloat.html">intfloat</a> tmp;
<a name="l03975"></a>03975    tmp.<a class="code" href="unionintfloat.html#a9a8e277a11633a885e514640396cd9d5">b</a> = x;
<a name="l03976"></a>03976    <span class="keywordtype">int</span> v = tmp.<a class="code" href="unionintfloat.html#ab8e61ca8f949268b5fedfdf4addf770e">a</a>;
<a name="l03977"></a>03977    <span class="keywordtype">int</span> man = v &amp; ((1&lt;&lt;23)-1);
<a name="l03978"></a>03978    <span class="keywordtype">int</span> mask =  ((1&lt;&lt;bits)-1) &lt;&lt; (23-bits);
<a name="l03979"></a>03979    <span class="keywordtype">int</span> nv = (v &amp; ((-1)-((1&lt;&lt;23)-1))) | (mask&amp;man);
<a name="l03980"></a>03980    tmp.<a class="code" href="unionintfloat.html#ab8e61ca8f949268b5fedfdf4addf770e">a</a> = nv;
<a name="l03981"></a>03981    <span class="keywordtype">float</span> result = tmp.<a class="code" href="unionintfloat.html#a9a8e277a11633a885e514640396cd9d5">b</a>;
<a name="l03982"></a>03982    <span class="keywordflow">return</span> result;
<a name="l03983"></a>03983 }
<a name="l03984"></a>03984 
<a name="l03985"></a><a class="code" href="instructions_8cc.html#a3910b254f644f4f25331af4accd2db88">03985</a> <span class="keywordtype">unsigned</span> <a class="code" href="instructions_8cc.html#a3910b254f644f4f25331af4accd2db88">wrap</a>( <span class="keywordtype">unsigned</span> x, <span class="keywordtype">unsigned</span> y, <span class="keywordtype">unsigned</span> mx, <span class="keywordtype">unsigned</span> my, <span class="keywordtype">size_t</span> elem_size )
<a name="l03986"></a>03986 {
<a name="l03987"></a>03987    <span class="keywordtype">unsigned</span> nx = (mx+x)%mx;
<a name="l03988"></a>03988    <span class="keywordtype">unsigned</span> ny = (my+y)%my;
<a name="l03989"></a>03989    <span class="keywordflow">return</span> nx + mx*ny;
<a name="l03990"></a>03990 }
<a name="l03991"></a>03991 
<a name="l03992"></a><a class="code" href="instructions_8cc.html#abeea293d99bd5e55b1f4c3c60e4b6321">03992</a> <span class="keywordtype">unsigned</span> <a class="code" href="instructions_8cc.html#abeea293d99bd5e55b1f4c3c60e4b6321">clamp</a>( <span class="keywordtype">unsigned</span> x, <span class="keywordtype">unsigned</span> y, <span class="keywordtype">unsigned</span> mx, <span class="keywordtype">unsigned</span> my, <span class="keywordtype">size_t</span> elem_size )
<a name="l03993"></a>03993 {
<a name="l03994"></a>03994    <span class="keywordtype">unsigned</span> nx = x;
<a name="l03995"></a>03995    <span class="keywordflow">while</span> (nx &gt;= mx) nx -= elem_size;
<a name="l03996"></a>03996    <span class="keywordtype">unsigned</span> ny = (y &gt;= my)? my - 1 : y;
<a name="l03997"></a>03997    <span class="keywordflow">return</span> nx + mx*ny;
<a name="l03998"></a>03998 }
<a name="l03999"></a>03999 
<a name="l04000"></a><a class="code" href="instructions_8cc.html#a2b1f6446f9ca8f8c27e0867bc4034c57">04000</a> <span class="keyword">typedef</span> unsigned (*<a class="code" href="instructions_8cc.html#a2b1f6446f9ca8f8c27e0867bc4034c57">texAddr_t</a>) (<span class="keywordtype">unsigned</span> x, <span class="keywordtype">unsigned</span> y, <span class="keywordtype">unsigned</span> mx, <span class="keywordtype">unsigned</span> my, <span class="keywordtype">size_t</span> elem_size);
<a name="l04001"></a><a class="code" href="instructions_8cc.html#aa9b90411e6cec6e0ace362d3fc09dbb6">04001</a> <span class="keywordtype">float</span> <a class="code" href="instructions_8cc.html#aa9b90411e6cec6e0ace362d3fc09dbb6">tex_linf_sampling</a>(<a class="code" href="classmemory__space.html">memory_space</a>* mem, <span class="keywordtype">unsigned</span> tex_array_base, 
<a name="l04002"></a>04002                         <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> width, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> height, <span class="keywordtype">size_t</span> elem_size,
<a name="l04003"></a>04003                         <span class="keywordtype">float</span> alpha, <span class="keywordtype">float</span> beta, <a class="code" href="instructions_8cc.html#a2b1f6446f9ca8f8c27e0867bc4034c57">texAddr_t</a> b_lim)
<a name="l04004"></a>04004 {
<a name="l04005"></a>04005    <span class="keywordtype">float</span> Tij;
<a name="l04006"></a>04006    <span class="keywordtype">float</span> Ti1j;
<a name="l04007"></a>04007    <span class="keywordtype">float</span> Tij1;
<a name="l04008"></a>04008    <span class="keywordtype">float</span> Ti1j1;
<a name="l04009"></a>04009 
<a name="l04010"></a>04010    mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(tex_array_base + b_lim(x,y,width,height,elem_size), 4, &amp;Tij);
<a name="l04011"></a>04011    mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(tex_array_base + b_lim(x+elem_size,y,width,height,elem_size), 4, &amp;Ti1j);
<a name="l04012"></a>04012    mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(tex_array_base + b_lim(x,y+1,width,height,elem_size), 4, &amp;Tij1);
<a name="l04013"></a>04013    mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(tex_array_base + b_lim(x+elem_size,y+1,width,height,elem_size), 4, &amp;Ti1j1);
<a name="l04014"></a>04014 
<a name="l04015"></a>04015    <span class="keywordtype">float</span> sample = (1-alpha)*(1-beta)*Tij + 
<a name="l04016"></a>04016                    alpha*(1-beta)*Ti1j +
<a name="l04017"></a>04017                    (1-alpha)*beta*Tij1 +
<a name="l04018"></a>04018                    alpha*beta*Ti1j1;
<a name="l04019"></a>04019    
<a name="l04020"></a>04020    <span class="keywordflow">return</span> sample;
<a name="l04021"></a>04021 }
<a name="l04022"></a>04022 
<a name="l04023"></a><a class="code" href="instructions_8cc.html#a64189dcc0789240e500e20534d00f7ca">04023</a> <span class="keywordtype">float</span> <a class="code" href="instructions_8cc.html#a64189dcc0789240e500e20534d00f7ca">textureNormalizeElementSigned</a>(<span class="keywordtype">int</span> element, <span class="keywordtype">int</span> bits)
<a name="l04024"></a>04024 {
<a name="l04025"></a>04025    <span class="keywordflow">if</span> (bits) {
<a name="l04026"></a>04026       <span class="keywordtype">int</span> maxN = (1 &lt;&lt; bits) - 1; 
<a name="l04027"></a>04027       <span class="comment">// removing upper bits </span>
<a name="l04028"></a>04028       element &amp;= maxN;
<a name="l04029"></a>04029       <span class="comment">// normalizing the number to [-1.0,1.0]</span>
<a name="l04030"></a>04030       maxN &gt;&gt;= 1;
<a name="l04031"></a>04031       <span class="keywordtype">float</span> <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> = (float) element / maxN;  
<a name="l04032"></a>04032       <span class="keywordflow">if</span> (output &lt; -1.0f) output = -1.0f; 
<a name="l04033"></a>04033       <span class="keywordflow">return</span> output; 
<a name="l04034"></a>04034    } <span class="keywordflow">else</span> {
<a name="l04035"></a>04035       <span class="keywordflow">return</span> 0.0f; 
<a name="l04036"></a>04036    }
<a name="l04037"></a>04037 }
<a name="l04038"></a>04038 
<a name="l04039"></a><a class="code" href="instructions_8cc.html#a05b3a762d67253b2abeb00bd79c5a282">04039</a> <span class="keywordtype">float</span> <a class="code" href="instructions_8cc.html#a05b3a762d67253b2abeb00bd79c5a282">textureNormalizeElementUnsigned</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> element, <span class="keywordtype">int</span> bits)
<a name="l04040"></a>04040 {
<a name="l04041"></a>04041    <span class="keywordflow">if</span> (bits) {
<a name="l04042"></a>04042       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxN = (1 &lt;&lt; bits) - 1; 
<a name="l04043"></a>04043       <span class="comment">// removing upper bits and normalizing the number to [0.0,1.0]</span>
<a name="l04044"></a>04044       <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)(element &amp; maxN) / maxN;  
<a name="l04045"></a>04045    } <span class="keywordflow">else</span> {
<a name="l04046"></a>04046       <span class="keywordflow">return</span> 0.0f; 
<a name="l04047"></a>04047    }
<a name="l04048"></a>04048 }
<a name="l04049"></a>04049 
<a name="l04050"></a><a class="code" href="instructions_8cc.html#a737540540268c4d385ca59d90b6547c4">04050</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a737540540268c4d385ca59d90b6547c4">textureNormalizeOutput</a>( <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcudaChannelFormatDesc.html">cudaChannelFormatDesc</a>&amp; desc, <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>&amp; datax, <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>&amp; datay, <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>&amp; dataz, <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>&amp; dataw ) 
<a name="l04051"></a>04051 {
<a name="l04052"></a>04052    <span class="keywordflow">if</span> (desc.<a class="code" href="structcudaChannelFormatDesc.html#a7d561d361936688eeae79c3184698278">f</a> == <a class="code" href="abstract__hardware__model_8h.html#a8085eac5cb54b4228f3619a60f235119a943e8b95cd113175ac55c56d90b40ae0">cudaChannelFormatKindSigned</a>) {
<a name="l04053"></a>04053       datax.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#a64189dcc0789240e500e20534d00f7ca">textureNormalizeElementSigned</a>( datax.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>, desc.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a> ); 
<a name="l04054"></a>04054       datay.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#a64189dcc0789240e500e20534d00f7ca">textureNormalizeElementSigned</a>( datay.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>, desc.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a> ); 
<a name="l04055"></a>04055       dataz.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#a64189dcc0789240e500e20534d00f7ca">textureNormalizeElementSigned</a>( dataz.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>, desc.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a> ); 
<a name="l04056"></a>04056       dataw.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#a64189dcc0789240e500e20534d00f7ca">textureNormalizeElementSigned</a>( dataw.<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>, desc.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a> ); 
<a name="l04057"></a>04057    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (desc.<a class="code" href="structcudaChannelFormatDesc.html#a7d561d361936688eeae79c3184698278">f</a> == <a class="code" href="abstract__hardware__model_8h.html#a8085eac5cb54b4228f3619a60f235119a240d73fa2dc05cbaa58f093f169ab3d4">cudaChannelFormatKindUnsigned</a>) {
<a name="l04058"></a>04058       datax.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#a05b3a762d67253b2abeb00bd79c5a282">textureNormalizeElementUnsigned</a>( datax.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, desc.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a> ); 
<a name="l04059"></a>04059       datay.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#a05b3a762d67253b2abeb00bd79c5a282">textureNormalizeElementUnsigned</a>( datay.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, desc.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a> ); 
<a name="l04060"></a>04060       dataz.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#a05b3a762d67253b2abeb00bd79c5a282">textureNormalizeElementUnsigned</a>( dataz.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, desc.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a> ); 
<a name="l04061"></a>04061       dataw.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#a05b3a762d67253b2abeb00bd79c5a282">textureNormalizeElementUnsigned</a>( dataw.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>, desc.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a> ); 
<a name="l04062"></a>04062    } <span class="keywordflow">else</span> {
<a name="l04063"></a>04063       assert(0 &amp;&amp; <span class="stringliteral">&quot;Undefined texture read mode: cudaReadModeNormalizedFloat expect integer elements&quot;</span>); 
<a name="l04064"></a>04064    }
<a name="l04065"></a>04065 }
<a name="l04066"></a>04066 
<a name="l04067"></a><a class="code" href="instructions_8cc.html#a3fd6ce3c8a69117ea7909e465ee99e36">04067</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a3fd6ce3c8a69117ea7909e465ee99e36">tex_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l04068"></a>04068 {
<a name="l04069"></a>04069    <span class="keywordtype">unsigned</span> dimension = pI-&gt;<a class="code" href="classptx__instruction.html#aa78ca0ce3f120215f1ed97b5f4f280a2">dimension</a>();
<a name="l04070"></a>04070    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>(); <span class="comment">//the registers to which fetched texel will be placed</span>
<a name="l04071"></a>04071    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>(); <span class="comment">//the name of the texture</span>
<a name="l04072"></a>04072    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>(); <span class="comment">//the vector registers containing coordinates of the texel to be fetched</span>
<a name="l04073"></a>04073 
<a name="l04074"></a>04074    std::string texname = src1.<a class="code" href="classoperand__info.html#ae508fadcabd47ef0a361b1120a6e160d">name</a>();
<a name="l04075"></a>04075    <span class="keywordtype">unsigned</span> to_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l04076"></a>04076    <span class="keywordtype">unsigned</span> c_type = pI-&gt;<a class="code" href="classptx__instruction.html#a65ccc3829d2356648a9865c42bc91409">get_type2</a>();
<a name="l04077"></a>04077    fflush(stdout);
<a name="l04078"></a>04078    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data1, data2, data3, data4;
<a name="l04079"></a>04079    <span class="keywordflow">if</span> (!ptx_tex_regs) ptx_tex_regs = <span class="keyword">new</span> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a>[4];
<a name="l04080"></a>04080    <span class="keywordtype">unsigned</span> nelem = src2.<a class="code" href="classoperand__info.html#ac45793fc8d4cad1dfe18a3c165c9e18f">get_vect_nelem</a>();
<a name="l04081"></a>04081    thread-&gt;<a class="code" href="classptx__thread__info.html#a4e9d2673a65c55339ae395075cdba6cd">get_vector_operand_values</a>(src2, ptx_tex_regs, nelem); <span class="comment">//ptx_reg should be 4 entry vector type...coordinates into texture</span>
<a name="l04082"></a>04082 
<a name="l04083"></a>04083    <a class="code" href="classgpgpu__t.html">gpgpu_t</a> *gpu = thread-&gt;<a class="code" href="classptx__thread__info.html#a6682377bc58576547b58b9e529721509">get_gpu</a>();
<a name="l04084"></a>04084    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtextureReference.html">textureReference</a>* texref = gpu-&gt;<a class="code" href="classgpgpu__t.html#a73920547c697d229269ef178baa4744d">get_texref</a>(texname);
<a name="l04085"></a>04085    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcudaArray.html">cudaArray</a>* cuArray = gpu-&gt;<a class="code" href="classgpgpu__t.html#a2f9ec8499769c78d18ea5012f9ee7076">get_texarray</a>(texref); 
<a name="l04086"></a>04086    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtextureInfo.html">textureInfo</a>* texInfo = gpu-&gt;<a class="code" href="classgpgpu__t.html#a6297c45dc05c73905d76b4b2cdd0f0a4">get_texinfo</a>(texref);
<a name="l04087"></a>04087    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtextureReferenceAttr.html">textureReferenceAttr</a>* texAttr = gpu-&gt;<a class="code" href="classgpgpu__t.html#aa36b78f5cb3db67fc9158a4a0f64d8ba">get_texattr</a>(texref);
<a name="l04088"></a>04088 
<a name="l04089"></a>04089    <span class="comment">//assume always 2D f32 input</span>
<a name="l04090"></a>04090    <span class="comment">//access array with src2 coordinates</span>
<a name="l04091"></a>04091    <a class="code" href="classmemory__space.html">memory_space</a> *mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab2b214414769f3a7422e2e7a1642bf74">get_global_memory</a>();
<a name="l04092"></a>04092    <span class="keywordtype">float</span> x_f32,  y_f32;
<a name="l04093"></a>04093    <span class="keywordtype">size_t</span> size;
<a name="l04094"></a>04094    <span class="keywordtype">int</span> t;
<a name="l04095"></a>04095    <span class="keywordtype">unsigned</span> tex_array_base;
<a name="l04096"></a>04096    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> width = 0, height = 0;
<a name="l04097"></a>04097    <span class="keywordtype">int</span> x = 0;
<a name="l04098"></a>04098    <span class="keywordtype">int</span> y = 0;
<a name="l04099"></a>04099    <span class="keywordtype">unsigned</span> tex_array_index;
<a name="l04100"></a>04100    <span class="keywordtype">float</span> alpha=0, beta=0;
<a name="l04101"></a>04101 
<a name="l04102"></a>04102    <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(to_type,size,t);
<a name="l04103"></a>04103    tex_array_base = cuArray-&gt;<a class="code" href="structcudaArray.html#a1f79cf1367c9c8958d435e0970771ccb">devPtr32</a>;
<a name="l04104"></a>04104 
<a name="l04105"></a>04105    <span class="keywordflow">switch</span> (dimension) {
<a name="l04106"></a>04106    <span class="keywordflow">case</span> GEOM_MODIFIER_1D:
<a name="l04107"></a>04107       width = cuArray-&gt;<a class="code" href="structcudaArray.html#a3b6311a43ce03da889a70982b1349891">width</a>;
<a name="l04108"></a>04108       height = cuArray-&gt;<a class="code" href="structcudaArray.html#a3699186b6e89d647a43fc8db19e8eacd">height</a>;
<a name="l04109"></a>04109       <span class="keywordflow">if</span> (texref-&gt;<a class="code" href="structtextureReference.html#a7d2636ed684123f1eb107a7b96f5aee7">normalized</a>) {
<a name="l04110"></a>04110          assert(c_type == F32_TYPE); 
<a name="l04111"></a>04111          x_f32 = ptx_tex_regs[0].<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>;
<a name="l04112"></a>04112          <span class="keywordflow">if</span> (texref-&gt;<a class="code" href="structtextureReference.html#ade42b21b7e4fa51ceb22a63361bc9234">addressMode</a>[0] == <a class="code" href="abstract__hardware__model_8h.html#a03e1bbd2c491d809279c7a47e2cd0351aaef7d489e6752d5e132f45d2d48c7b19">cudaAddressModeClamp</a>) {
<a name="l04113"></a>04113             x_f32 = (x_f32 &gt; 1.0)? 1.0 : x_f32;
<a name="l04114"></a>04114             x_f32 = (x_f32 &lt; 0.0)? 0.0 : x_f32;
<a name="l04115"></a>04115          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (texref-&gt;<a class="code" href="structtextureReference.html#ade42b21b7e4fa51ceb22a63361bc9234">addressMode</a>[0] == <a class="code" href="abstract__hardware__model_8h.html#a03e1bbd2c491d809279c7a47e2cd0351ab1cc30b475318b336b3cdf44aecba1d4">cudaAddressModeWrap</a>) {
<a name="l04116"></a>04116             x_f32 = x_f32 - floor(x_f32);
<a name="l04117"></a>04117          }
<a name="l04118"></a>04118 
<a name="l04119"></a>04119          <span class="keywordflow">if</span>( texref-&gt;<a class="code" href="structtextureReference.html#a3c864a737142c3c62350c03cea63aa1c">filterMode</a> == <a class="code" href="abstract__hardware__model_8h.html#aee4adb3d1b062cf05374de09325a82d5a5bab9bd668bf4bb2e16f7919f5e0caa0">cudaFilterModeLinear</a> ) {
<a name="l04120"></a>04120             <span class="keywordtype">float</span> xb = x_f32 * width - 0.5;
<a name="l04121"></a>04121             alpha = xb - floor(xb);
<a name="l04122"></a>04122             alpha = <a class="code" href="instructions_8cc.html#aa290629e37a07b1c197574bf8b6818f9">reduce_precision</a>(alpha,9);
<a name="l04123"></a>04123             beta = 0.0;
<a name="l04124"></a>04124 
<a name="l04125"></a>04125             x = (<a class="code" href="classint.html">int</a>)floor(xb);
<a name="l04126"></a>04126             y = 0;
<a name="l04127"></a>04127          } <span class="keywordflow">else</span> {
<a name="l04128"></a>04128             x = (<a class="code" href="classint.html">int</a>) floor(x_f32 * width);
<a name="l04129"></a>04129             y = 0;
<a name="l04130"></a>04130          }
<a name="l04131"></a>04131       } <span class="keywordflow">else</span> {
<a name="l04132"></a>04132          <span class="keywordflow">switch</span> ( c_type ) {
<a name="l04133"></a>04133          <span class="keywordflow">case</span> S32_TYPE: 
<a name="l04134"></a>04134             x = ptx_tex_regs[0].<a class="code" href="unionptx__reg__t.html#a5060cdbdd7b4488e39f610f35e225818">s32</a>; 
<a name="l04135"></a>04135             assert(texref-&gt;<a class="code" href="structtextureReference.html#a3c864a737142c3c62350c03cea63aa1c">filterMode</a> == <a class="code" href="abstract__hardware__model_8h.html#aee4adb3d1b062cf05374de09325a82d5ae07c310cc7ac5c14106fbb8dc7a27d11">cudaFilterModePoint</a>); 
<a name="l04136"></a>04136             <span class="keywordflow">break</span>; 
<a name="l04137"></a>04137          <span class="keywordflow">case</span> F32_TYPE: 
<a name="l04138"></a>04138             x_f32 = ptx_tex_regs[0].<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>; 
<a name="l04139"></a>04139             alpha = x_f32 - floor(x_f32); <span class="comment">// offset into subtexel (for linear sampling)</span>
<a name="l04140"></a>04140             x = (<a class="code" href="classint.html">int</a>) x_f32; 
<a name="l04141"></a>04141             <span class="keywordflow">break</span>; 
<a name="l04142"></a>04142          <span class="keywordflow">default</span>: assert(0 &amp;&amp; <span class="stringliteral">&quot;Unsupported texture coordinate type.&quot;</span>); 
<a name="l04143"></a>04143          }
<a name="l04144"></a>04144          <span class="comment">// handle texture fetch that exceeded boundaries</span>
<a name="l04145"></a>04145          <span class="keywordflow">if</span> (texref-&gt;<a class="code" href="structtextureReference.html#ade42b21b7e4fa51ceb22a63361bc9234">addressMode</a>[0] == <a class="code" href="abstract__hardware__model_8h.html#a03e1bbd2c491d809279c7a47e2cd0351aaef7d489e6752d5e132f45d2d48c7b19">cudaAddressModeClamp</a>) {
<a name="l04146"></a>04146             x = (x &gt; width - 1)? (width - 1) : x;
<a name="l04147"></a>04147             x = (x &lt; 0)? 0 : x;
<a name="l04148"></a>04148          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (texref-&gt;<a class="code" href="structtextureReference.html#ade42b21b7e4fa51ceb22a63361bc9234">addressMode</a>[0] == <a class="code" href="abstract__hardware__model_8h.html#a03e1bbd2c491d809279c7a47e2cd0351ab1cc30b475318b336b3cdf44aecba1d4">cudaAddressModeWrap</a>) {
<a name="l04149"></a>04149             x = x % width;
<a name="l04150"></a>04150          }
<a name="l04151"></a>04151       }
<a name="l04152"></a>04152       width *= (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>)/8;
<a name="l04153"></a>04153       x *= (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>)/8;
<a name="l04154"></a>04154       tex_array_index = tex_array_base + x;
<a name="l04155"></a>04155 
<a name="l04156"></a>04156       <span class="keywordflow">break</span>;
<a name="l04157"></a>04157    <span class="keywordflow">case</span> GEOM_MODIFIER_2D:
<a name="l04158"></a>04158       width = cuArray-&gt;<a class="code" href="structcudaArray.html#a3b6311a43ce03da889a70982b1349891">width</a>;
<a name="l04159"></a>04159       height = cuArray-&gt;<a class="code" href="structcudaArray.html#a3699186b6e89d647a43fc8db19e8eacd">height</a>;
<a name="l04160"></a>04160       <span class="keywordflow">if</span> (texref-&gt;<a class="code" href="structtextureReference.html#a7d2636ed684123f1eb107a7b96f5aee7">normalized</a>) {
<a name="l04161"></a>04161          x_f32 = <a class="code" href="instructions_8cc.html#aa290629e37a07b1c197574bf8b6818f9">reduce_precision</a>(ptx_tex_regs[0].f32,16);
<a name="l04162"></a>04162          y_f32 = <a class="code" href="instructions_8cc.html#aa290629e37a07b1c197574bf8b6818f9">reduce_precision</a>(ptx_tex_regs[1].f32,15);
<a name="l04163"></a>04163 
<a name="l04164"></a>04164          <span class="keywordflow">if</span> (texref-&gt;<a class="code" href="structtextureReference.html#ade42b21b7e4fa51ceb22a63361bc9234">addressMode</a>[0]) {<span class="comment">//clamp</span>
<a name="l04165"></a>04165             <span class="keywordflow">if</span> (x_f32&lt;0) x_f32 = 0;
<a name="l04166"></a>04166             <span class="keywordflow">if</span> (x_f32&gt;=1) x_f32 = 1 - 1/x_f32;
<a name="l04167"></a>04167          } <span class="keywordflow">else</span> {<span class="comment">//wrap</span>
<a name="l04168"></a>04168             x_f32 = x_f32 - floor(x_f32);
<a name="l04169"></a>04169          }
<a name="l04170"></a>04170          <span class="keywordflow">if</span> (texref-&gt;<a class="code" href="structtextureReference.html#ade42b21b7e4fa51ceb22a63361bc9234">addressMode</a>[1]) {<span class="comment">//clamp</span>
<a name="l04171"></a>04171             <span class="keywordflow">if</span> (y_f32&lt;0) y_f32 = 0;
<a name="l04172"></a>04172             <span class="keywordflow">if</span> (y_f32&gt;=1) y_f32 = 1 - 1/y_f32;
<a name="l04173"></a>04173          } <span class="keywordflow">else</span> {<span class="comment">//wrap</span>
<a name="l04174"></a>04174             y_f32 = y_f32 - floor(y_f32);
<a name="l04175"></a>04175          }
<a name="l04176"></a>04176 
<a name="l04177"></a>04177          <span class="keywordflow">if</span>( texref-&gt;<a class="code" href="structtextureReference.html#a3c864a737142c3c62350c03cea63aa1c">filterMode</a> == <a class="code" href="abstract__hardware__model_8h.html#aee4adb3d1b062cf05374de09325a82d5a5bab9bd668bf4bb2e16f7919f5e0caa0">cudaFilterModeLinear</a> ) {
<a name="l04178"></a>04178             <span class="keywordtype">float</span> xb = x_f32 * width - 0.5;
<a name="l04179"></a>04179             <span class="keywordtype">float</span> yb = y_f32 * height - 0.5;
<a name="l04180"></a>04180             alpha = xb - floor(xb);
<a name="l04181"></a>04181             beta = yb - floor(yb);
<a name="l04182"></a>04182             alpha = <a class="code" href="instructions_8cc.html#aa290629e37a07b1c197574bf8b6818f9">reduce_precision</a>(alpha,9);
<a name="l04183"></a>04183             beta = <a class="code" href="instructions_8cc.html#aa290629e37a07b1c197574bf8b6818f9">reduce_precision</a>(beta,9);
<a name="l04184"></a>04184 
<a name="l04185"></a>04185             x = (<a class="code" href="classint.html">int</a>)floor(xb);
<a name="l04186"></a>04186             y = (<a class="code" href="classint.html">int</a>)floor(yb);
<a name="l04187"></a>04187          } <span class="keywordflow">else</span> {
<a name="l04188"></a>04188             x = (<a class="code" href="classint.html">int</a>) floor(x_f32 * width);
<a name="l04189"></a>04189             y = (<a class="code" href="classint.html">int</a>) floor(y_f32 * height);
<a name="l04190"></a>04190          }
<a name="l04191"></a>04191       } <span class="keywordflow">else</span> {
<a name="l04192"></a>04192          x_f32 = ptx_tex_regs[0].<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>;
<a name="l04193"></a>04193          y_f32 = ptx_tex_regs[1].<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>;
<a name="l04194"></a>04194 
<a name="l04195"></a>04195          alpha = x_f32 - floor(x_f32);
<a name="l04196"></a>04196          beta = y_f32 - floor(y_f32);
<a name="l04197"></a>04197 
<a name="l04198"></a>04198          x = (<a class="code" href="classint.html">int</a>) x_f32;
<a name="l04199"></a>04199          y = (<a class="code" href="classint.html">int</a>) y_f32;
<a name="l04200"></a>04200          <span class="keywordflow">if</span> (texref-&gt;<a class="code" href="structtextureReference.html#ade42b21b7e4fa51ceb22a63361bc9234">addressMode</a>[0]) {<span class="comment">//clamp</span>
<a name="l04201"></a>04201             <span class="keywordflow">if</span> (x&lt;0) x = 0;
<a name="l04202"></a>04202             <span class="keywordflow">if</span> (x&gt;= (<span class="keywordtype">int</span>)width) x = width-1;
<a name="l04203"></a>04203          } <span class="keywordflow">else</span> {<span class="comment">//wrap</span>
<a name="l04204"></a>04204             x = x % width;
<a name="l04205"></a>04205             <span class="keywordflow">if</span> (x &lt; 0) x*= -1;
<a name="l04206"></a>04206          }
<a name="l04207"></a>04207          <span class="keywordflow">if</span> (texref-&gt;<a class="code" href="structtextureReference.html#ade42b21b7e4fa51ceb22a63361bc9234">addressMode</a>[1]) {<span class="comment">//clamp</span>
<a name="l04208"></a>04208             <span class="keywordflow">if</span> (y&lt;0) y = 0;
<a name="l04209"></a>04209             <span class="keywordflow">if</span> (y&gt;= (<span class="keywordtype">int</span>)height) y = height -1;
<a name="l04210"></a>04210          } <span class="keywordflow">else</span> {<span class="comment">//wrap</span>
<a name="l04211"></a>04211             y = y % height;
<a name="l04212"></a>04212             <span class="keywordflow">if</span> (y &lt; 0) y *= -1;
<a name="l04213"></a>04213          }
<a name="l04214"></a>04214       }
<a name="l04215"></a>04215 
<a name="l04216"></a>04216       width *= (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>)/8;
<a name="l04217"></a>04217       x *= (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>+cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>)/8;
<a name="l04218"></a>04218       tex_array_index = tex_array_base + (x + width*y);
<a name="l04219"></a>04219       <span class="keywordflow">break</span>;
<a name="l04220"></a>04220    <span class="keywordflow">default</span>:
<a name="l04221"></a>04221       assert(0); <span class="keywordflow">break</span>;
<a name="l04222"></a>04222    }
<a name="l04223"></a>04223    <span class="keywordflow">switch</span> ( to_type ) {
<a name="l04224"></a>04224    <span class="keywordflow">case</span> U8_TYPE:
<a name="l04225"></a>04225    <span class="keywordflow">case</span> U16_TYPE:
<a name="l04226"></a>04226    <span class="keywordflow">case</span> U32_TYPE: 
<a name="l04227"></a>04227    <span class="keywordflow">case</span> B8_TYPE:
<a name="l04228"></a>04228    <span class="keywordflow">case</span> B16_TYPE:
<a name="l04229"></a>04229    <span class="keywordflow">case</span> B32_TYPE: 
<a name="l04230"></a>04230    <span class="keywordflow">case</span> S8_TYPE:
<a name="l04231"></a>04231    <span class="keywordflow">case</span> S16_TYPE:
<a name="l04232"></a>04232    <span class="keywordflow">case</span> S32_TYPE: {
<a name="l04233"></a>04233       <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> elementOffset = 0; <span class="comment">// offset into the next element </span>
<a name="l04234"></a>04234       mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index, cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a>/8, &amp;data1.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l04235"></a>04235       elementOffset += cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a>/8;  
<a name="l04236"></a>04236       <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>) {
<a name="l04237"></a>04237          mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index + elementOffset, cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>/8, &amp;data2.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l04238"></a>04238          elementOffset += cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>/8; 
<a name="l04239"></a>04239          <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>) {
<a name="l04240"></a>04240             mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index + elementOffset, cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>/8, &amp;data3.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l04241"></a>04241             elementOffset += cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>/8; 
<a name="l04242"></a>04242             <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>) 
<a name="l04243"></a>04243                mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index + elementOffset, cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>/8, &amp;data4.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>);
<a name="l04244"></a>04244          }
<a name="l04245"></a>04245       }
<a name="l04246"></a>04246       <span class="keywordflow">break</span>;
<a name="l04247"></a>04247    }
<a name="l04248"></a>04248    <span class="keywordflow">case</span> B64_TYPE:
<a name="l04249"></a>04249    <span class="keywordflow">case</span> U64_TYPE:
<a name="l04250"></a>04250    <span class="keywordflow">case</span> S64_TYPE:
<a name="l04251"></a>04251       mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index, 8, &amp;data1.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l04252"></a>04252       <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>) {
<a name="l04253"></a>04253          mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index+8, 8, &amp;data2.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l04254"></a>04254          <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>) {
<a name="l04255"></a>04255             mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index+16, 8, &amp;data3.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l04256"></a>04256             <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>) 
<a name="l04257"></a>04257                mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index+24, 8, &amp;data4.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l04258"></a>04258          }
<a name="l04259"></a>04259       }
<a name="l04260"></a>04260       <span class="keywordflow">break</span>;
<a name="l04261"></a>04261    <span class="keywordflow">case</span> F16_TYPE: assert(0); <span class="keywordflow">break</span>;
<a name="l04262"></a>04262    <span class="keywordflow">case</span> F32_TYPE:  {
<a name="l04263"></a>04263       <span class="keywordflow">if</span>( texref-&gt;<a class="code" href="structtextureReference.html#a3c864a737142c3c62350c03cea63aa1c">filterMode</a> == <a class="code" href="abstract__hardware__model_8h.html#aee4adb3d1b062cf05374de09325a82d5a5bab9bd668bf4bb2e16f7919f5e0caa0">cudaFilterModeLinear</a> ) {
<a name="l04264"></a>04264          <a class="code" href="instructions_8cc.html#a2b1f6446f9ca8f8c27e0867bc4034c57">texAddr_t</a> b_lim = <a class="code" href="instructions_8cc.html#a3910b254f644f4f25331af4accd2db88">wrap</a>;
<a name="l04265"></a>04265          <span class="keywordflow">if</span> ( texref-&gt;<a class="code" href="structtextureReference.html#ade42b21b7e4fa51ceb22a63361bc9234">addressMode</a>[0] == <a class="code" href="abstract__hardware__model_8h.html#a03e1bbd2c491d809279c7a47e2cd0351aaef7d489e6752d5e132f45d2d48c7b19">cudaAddressModeClamp</a> ) {
<a name="l04266"></a>04266             b_lim = <a class="code" href="instructions_8cc.html#abeea293d99bd5e55b1f4c3c60e4b6321">clamp</a>;
<a name="l04267"></a>04267          }
<a name="l04268"></a>04268          <span class="keywordtype">size_t</span> elem_size = (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a> + cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a> + cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a> + cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>) / 8;
<a name="l04269"></a>04269          <span class="keywordtype">size_t</span> elem_ofst = 0;
<a name="l04270"></a>04270 
<a name="l04271"></a>04271          data1.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#aa9b90411e6cec6e0ace362d3fc09dbb6">tex_linf_sampling</a>(mem, tex_array_base, x + elem_ofst, y, width, height, elem_size, alpha, beta, b_lim);
<a name="l04272"></a>04272          elem_ofst += cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a> / 8; 
<a name="l04273"></a>04273          <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>) {
<a name="l04274"></a>04274             data2.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#aa9b90411e6cec6e0ace362d3fc09dbb6">tex_linf_sampling</a>(mem, tex_array_base, x + elem_ofst, y, width, height, elem_size, alpha, beta, b_lim);
<a name="l04275"></a>04275             elem_ofst += cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a> / 8; 
<a name="l04276"></a>04276             <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>) {
<a name="l04277"></a>04277                data3.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#aa9b90411e6cec6e0ace362d3fc09dbb6">tex_linf_sampling</a>(mem, tex_array_base, x + elem_ofst, y, width, height, elem_size, alpha, beta, b_lim);
<a name="l04278"></a>04278                elem_ofst += cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a> / 8; 
<a name="l04279"></a>04279                <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>) 
<a name="l04280"></a>04280                   data4.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = <a class="code" href="instructions_8cc.html#aa9b90411e6cec6e0ace362d3fc09dbb6">tex_linf_sampling</a>(mem, tex_array_base, x + elem_ofst, y, width, height, elem_size, alpha, beta, b_lim);
<a name="l04281"></a>04281             }
<a name="l04282"></a>04282          }
<a name="l04283"></a>04283       } <span class="keywordflow">else</span> {
<a name="l04284"></a>04284          mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index, cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a70dede802100e2acd9f334326e9d7926">x</a>/8, &amp;data1.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>);
<a name="l04285"></a>04285          <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>) {
<a name="l04286"></a>04286             mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index+4, cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>/8, &amp;data2.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>);
<a name="l04287"></a>04287             <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>) {
<a name="l04288"></a>04288                mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index+8, cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>/8, &amp;data3.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>);
<a name="l04289"></a>04289                <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>) 
<a name="l04290"></a>04290                   mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index+12, cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>/8, &amp;data4.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>);
<a name="l04291"></a>04291             }
<a name="l04292"></a>04292          }
<a name="l04293"></a>04293       }
<a name="l04294"></a>04294    } <span class="keywordflow">break</span>;
<a name="l04295"></a>04295    <span class="keywordflow">case</span> F64_TYPE: 
<a name="l04296"></a>04296    <span class="keywordflow">case</span> FF64_TYPE:
<a name="l04297"></a>04297       mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index, 8, &amp;data1.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>);
<a name="l04298"></a>04298       <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a6570793c6567d0c704e8e8943ccaec43">y</a>) {
<a name="l04299"></a>04299          mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index+8, 8, &amp;data2.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>);
<a name="l04300"></a>04300          <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#ae371d37d940d2397139b0a3b7302f51a">z</a>) {
<a name="l04301"></a>04301             mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index+16, 8, &amp;data3.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>);
<a name="l04302"></a>04302             <span class="keywordflow">if</span> (cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>.<a class="code" href="structcudaChannelFormatDesc.html#a06089c5a407a2cbd6ea05e5a39b19d69">w</a>) 
<a name="l04303"></a>04303                mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>( tex_array_index+24, 8, &amp;data4.<a class="code" href="unionptx__reg__t.html#ae251e48e3c49db0c8b4ecb13a3fe0934">f64</a>);
<a name="l04304"></a>04304          }
<a name="l04305"></a>04305       }
<a name="l04306"></a>04306       <span class="keywordflow">break</span>;
<a name="l04307"></a>04307    <span class="keywordflow">default</span>: assert(0); <span class="keywordflow">break</span>;
<a name="l04308"></a>04308    }
<a name="l04309"></a>04309    <span class="keywordtype">int</span> x_block_coord, y_block_coord, memreqindex, blockoffset;
<a name="l04310"></a>04310 
<a name="l04311"></a>04311    <span class="keywordflow">switch</span> (dimension) {
<a name="l04312"></a>04312    <span class="keywordflow">case</span> GEOM_MODIFIER_1D:
<a name="l04313"></a>04313       thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = tex_array_index;
<a name="l04314"></a>04314       <span class="keywordflow">break</span>;
<a name="l04315"></a>04315    <span class="keywordflow">case</span> GEOM_MODIFIER_2D: 
<a name="l04316"></a>04316       x_block_coord = x &gt;&gt; (texInfo-&gt;<a class="code" href="structtextureInfo.html#af07ad29cd8de973a2e56b59ef3349acf">Tx_numbits</a> + texInfo-&gt;<a class="code" href="structtextureInfo.html#a2821d0fc73bb86924987039a3c2b0724">texel_size_numbits</a>);
<a name="l04317"></a>04317       y_block_coord = y &gt;&gt; texInfo-&gt;<a class="code" href="structtextureInfo.html#afe2bcb32945ed4186e4025623ef9fcc0">Ty_numbits</a>;
<a name="l04318"></a>04318 
<a name="l04319"></a>04319       memreqindex = ((y_block_coord*cuArray-&gt;<a class="code" href="structcudaArray.html#a3b6311a43ce03da889a70982b1349891">width</a>/texInfo-&gt;<a class="code" href="structtextureInfo.html#a0aa8b1c9cc415635b36df921ca69aed2">Tx</a>)+x_block_coord)&lt;&lt;6;
<a name="l04320"></a>04320 
<a name="l04321"></a>04321       blockoffset = (x%(texInfo-&gt;<a class="code" href="structtextureInfo.html#a0aa8b1c9cc415635b36df921ca69aed2">Tx</a>*texInfo-&gt;<a class="code" href="structtextureInfo.html#a4b70a38adb71dec17257c00c5d03f01d">texel_size</a>) + (y%(texInfo-&gt;<a class="code" href="structtextureInfo.html#a5a66ebbeca4dfa2e6c64705aaab7ca73">Ty</a>)&lt;&lt;(texInfo-&gt;<a class="code" href="structtextureInfo.html#af07ad29cd8de973a2e56b59ef3349acf">Tx_numbits</a> + texInfo-&gt;<a class="code" href="structtextureInfo.html#a2821d0fc73bb86924987039a3c2b0724">texel_size_numbits</a>)));
<a name="l04322"></a>04322       memreqindex += blockoffset;
<a name="l04323"></a>04323       thread-&gt;<a class="code" href="classptx__thread__info.html#a8388976854db01c5ca1bfb1b3b282976">m_last_effective_address</a> = tex_array_base + memreqindex;<span class="comment">//tex_array_index;</span>
<a name="l04324"></a>04324       <span class="keywordflow">break</span>;
<a name="l04325"></a>04325    <span class="keywordflow">default</span>:
<a name="l04326"></a>04326       assert(0);
<a name="l04327"></a>04327    }
<a name="l04328"></a>04328    thread-&gt;<a class="code" href="classptx__thread__info.html#aaaa73cc49f09d644c2f3ef5dc01fc29a">m_last_memory_space</a> = <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cadc0c390c9425eb280596cbf66b5d4d4f">tex_space</a>; 
<a name="l04329"></a>04329 
<a name="l04330"></a>04330    <span class="comment">// normalize output into floating point numbers according to the texture read mode</span>
<a name="l04331"></a>04331    <span class="keywordflow">if</span> (texAttr-&gt;<a class="code" href="structtextureReferenceAttr.html#ad71b2766bd0b8741c102b5b0e80e44bd">m_readmode</a> == <a class="code" href="abstract__hardware__model_8h.html#ad9266d02be93809558036ec4f3d5f43da4f26f2afcd260d6e19df4cea6d87d697">cudaReadModeNormalizedFloat</a>) {
<a name="l04332"></a>04332       <a class="code" href="instructions_8cc.html#a737540540268c4d385ca59d90b6547c4">textureNormalizeOutput</a>(cuArray-&gt;<a class="code" href="structcudaArray.html#ae0c894d6366539846b6551c2f2a3d155">desc</a>, data1, data2, data3, data4); 
<a name="l04333"></a>04333    } <span class="keywordflow">else</span> {
<a name="l04334"></a>04334       assert(texAttr-&gt;<a class="code" href="structtextureReferenceAttr.html#ad71b2766bd0b8741c102b5b0e80e44bd">m_readmode</a> == <a class="code" href="abstract__hardware__model_8h.html#ad9266d02be93809558036ec4f3d5f43dacbd5c83aac88965511fc33675738ba63">cudaReadModeElementType</a>); 
<a name="l04335"></a>04335    }
<a name="l04336"></a>04336 
<a name="l04337"></a>04337    thread-&gt;<a class="code" href="classptx__thread__info.html#a63c1ce9a7e644923b52c8dcbbd58d6fc">set_vector_operand_values</a>(dst,data1,data2,data3,data4);
<a name="l04338"></a>04338 }
<a name="l04339"></a>04339 
<a name="l04340"></a><a class="code" href="instructions_8cc.html#a8e5d718b549ba3ed8b1265b9a6684cd9">04340</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a8e5d718b549ba3ed8b1265b9a6684cd9">txq_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04341"></a><a class="code" href="instructions_8cc.html#acf192bc5d400ffa4bf166095b748803c">04341</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#acf192bc5d400ffa4bf166095b748803c">trap_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04342"></a><a class="code" href="instructions_8cc.html#a972a2bd72c7bfba6566b376eabc96f4f">04342</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a972a2bd72c7bfba6566b376eabc96f4f">vabsdiff_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04343"></a><a class="code" href="instructions_8cc.html#abba9d25d3551ec78341bb0bdb54d0cc3">04343</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#abba9d25d3551ec78341bb0bdb54d0cc3">vadd_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04344"></a><a class="code" href="instructions_8cc.html#a244c23177f20edb5abd826446f433a6b">04344</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a244c23177f20edb5abd826446f433a6b">vmad_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04345"></a><a class="code" href="instructions_8cc.html#a759252e42e78d05c6eb8fd35f31837ed">04345</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a759252e42e78d05c6eb8fd35f31837ed">vmax_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04346"></a><a class="code" href="instructions_8cc.html#a50cfbf2a0f117076227441288a0b3432">04346</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a50cfbf2a0f117076227441288a0b3432">vmin_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04347"></a><a class="code" href="instructions_8cc.html#a259ac459a750034f4a8f338fa5767540">04347</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a259ac459a750034f4a8f338fa5767540">vset_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04348"></a><a class="code" href="instructions_8cc.html#a9c059feac6ecd14b8dd9080726a05caa">04348</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a9c059feac6ecd14b8dd9080726a05caa">vshl_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04349"></a><a class="code" href="instructions_8cc.html#ab1d6f6f7fde68e903599b4b7947e8209">04349</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#ab1d6f6f7fde68e903599b4b7947e8209">vshr_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04350"></a><a class="code" href="instructions_8cc.html#abb0eea796835ab95767ac2654758bae9">04350</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#abb0eea796835ab95767ac2654758bae9">vsub_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) { <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>(pI); }
<a name="l04351"></a>04351 
<a name="l04352"></a><a class="code" href="instructions_8cc.html#a000d06f316fffd5ee45419d16472ece4">04352</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a000d06f316fffd5ee45419d16472ece4">vote_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l04353"></a>04353 {
<a name="l04354"></a>04354    <span class="keyword">static</span> <span class="keywordtype">bool</span> first_in_warp = <span class="keyword">true</span>;
<a name="l04355"></a>04355    <span class="keyword">static</span> <span class="keywordtype">bool</span> and_all;
<a name="l04356"></a>04356    <span class="keyword">static</span> <span class="keywordtype">bool</span> or_all;
<a name="l04357"></a>04357    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ballot_result;
<a name="l04358"></a>04358    <span class="keyword">static</span> std::list&lt;ptx_thread_info*&gt; threads_in_warp;
<a name="l04359"></a>04359    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> last_tid;
<a name="l04360"></a>04360 
<a name="l04361"></a>04361    <span class="keywordflow">if</span>( first_in_warp ) {
<a name="l04362"></a>04362       first_in_warp = <span class="keyword">false</span>;
<a name="l04363"></a>04363       threads_in_warp.clear();
<a name="l04364"></a>04364       and_all = <span class="keyword">true</span>;
<a name="l04365"></a>04365       or_all = <span class="keyword">false</span>;
<a name="l04366"></a>04366       ballot_result = 0;
<a name="l04367"></a>04367       <span class="keywordtype">int</span> offset=31;
<a name="l04368"></a>04368       <span class="keywordflow">while</span>( (offset&gt;=0) &amp;&amp; !pI-&gt;<a class="code" href="classwarp__inst__t.html#ae44d8d3d283dc0ecf16db55f57f3c03d">active</a>(offset) ) 
<a name="l04369"></a>04369          offset--;
<a name="l04370"></a>04370       assert( offset &gt;= 0 );
<a name="l04371"></a>04371       last_tid = (thread-&gt;<a class="code" href="classptx__thread__info.html#ab29aab67515d40473c131e4d9e475acb">get_hw_tid</a>() - (thread-&gt;<a class="code" href="classptx__thread__info.html#ab29aab67515d40473c131e4d9e475acb">get_hw_tid</a>()%pI-&gt;<a class="code" href="classwarp__inst__t.html#ad9026d2383a0365bd123f309534b5fb1">warp_size</a>())) + offset;
<a name="l04372"></a>04372    }
<a name="l04373"></a>04373 
<a name="l04374"></a>04374    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data;
<a name="l04375"></a>04375    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l04376"></a>04376    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>(), PRED_TYPE, thread, 1);
<a name="l04377"></a>04377 
<a name="l04378"></a>04378    <span class="comment">//predicate value was changed so the lowest bit being set means the zero flag is set.</span>
<a name="l04379"></a>04379    <span class="comment">//As a result, the value of src1_data.pred must be inverted to get proper behavior</span>
<a name="l04380"></a>04380    <span class="keywordtype">bool</span> pred_value = !(src1_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> &amp; 0x0001);
<a name="l04381"></a>04381    <span class="keywordtype">bool</span> invert = src1.<a class="code" href="classoperand__info.html#a9f1f65757a74d479a60204745d690b43">is_neg_pred</a>();
<a name="l04382"></a>04382 
<a name="l04383"></a>04383    threads_in_warp.push_back(thread);
<a name="l04384"></a>04384    and_all &amp;= (invert ^ pred_value);
<a name="l04385"></a>04385    or_all |= (invert ^ pred_value);
<a name="l04386"></a>04386 
<a name="l04387"></a>04387    <span class="comment">// vote.ballot</span>
<a name="l04388"></a>04388    <span class="keywordflow">if</span> (invert ^ pred_value) {
<a name="l04389"></a>04389       <span class="keywordtype">int</span> lane_id = thread-&gt;get_hw_tid() % pI-&gt;<a class="code" href="classwarp__inst__t.html#ad9026d2383a0365bd123f309534b5fb1">warp_size</a>(); 
<a name="l04390"></a>04390       ballot_result |= (1 &lt;&lt; lane_id); 
<a name="l04391"></a>04391    }
<a name="l04392"></a>04392 
<a name="l04393"></a>04393    <span class="keywordflow">if</span>( thread-&gt;get_hw_tid() == last_tid ) {
<a name="l04394"></a>04394       <span class="keywordflow">if</span> (pI-&gt;<a class="code" href="classptx__instruction.html#a9820795591c895772b5893a1273c3fad">vote_mode</a>() == <a class="code" href="classptx__instruction.html#ae7bc871159737be95bb8f6f487c96574a84403d6d093a4cec586aeee0c3308c10">ptx_instruction::vote_ballot</a>) {
<a name="l04395"></a>04395          <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data = ballot_result; 
<a name="l04396"></a>04396          <span class="keywordflow">for</span>( std::list&lt;ptx_thread_info*&gt;::iterator t=threads_in_warp.begin(); t!=threads_in_warp.end(); ++t ) {
<a name="l04397"></a>04397             <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l04398"></a>04398             (*t)-&gt;set_operand_value(dst,data, pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>(), (*t), pI);
<a name="l04399"></a>04399          }
<a name="l04400"></a>04400       } <span class="keywordflow">else</span> {
<a name="l04401"></a>04401          <span class="keywordtype">bool</span> pred_value = <span class="keyword">false</span>; 
<a name="l04402"></a>04402 
<a name="l04403"></a>04403          <span class="keywordflow">switch</span>( pI-&gt;<a class="code" href="classptx__instruction.html#a9820795591c895772b5893a1273c3fad">vote_mode</a>() ) {
<a name="l04404"></a>04404          <span class="keywordflow">case</span> <a class="code" href="classptx__instruction.html#ae7bc871159737be95bb8f6f487c96574a72c5dcdee280fb20e99bab0c0143af3a">ptx_instruction::vote_any</a>: pred_value = or_all; <span class="keywordflow">break</span>;
<a name="l04405"></a>04405          <span class="keywordflow">case</span> <a class="code" href="classptx__instruction.html#ae7bc871159737be95bb8f6f487c96574aec08379cf6d308ee03f41817d02c4b4d">ptx_instruction::vote_all</a>: pred_value = and_all; <span class="keywordflow">break</span>;
<a name="l04406"></a>04406          <span class="keywordflow">case</span> <a class="code" href="classptx__instruction.html#ae7bc871159737be95bb8f6f487c96574a3f74d05f753f1589f72e9adaef7c4ee2">ptx_instruction::vote_uni</a>: pred_value = (or_all ^ and_all); <span class="keywordflow">break</span>;
<a name="l04407"></a>04407          <span class="keywordflow">default</span>:
<a name="l04408"></a>04408             abort();
<a name="l04409"></a>04409          }
<a name="l04410"></a>04410          <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> data;
<a name="l04411"></a>04411          data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = pred_value?0:1; <span class="comment">//the way ptxplus handles the zero flag, 1 = false and 0 = true</span>
<a name="l04412"></a>04412 
<a name="l04413"></a>04413          <span class="keywordflow">for</span>( std::list&lt;ptx_thread_info*&gt;::iterator t=threads_in_warp.begin(); t!=threads_in_warp.end(); ++t ) {
<a name="l04414"></a>04414             <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l04415"></a>04415             (*t)-&gt;set_operand_value(dst,data, PRED_TYPE, (*t), pI);
<a name="l04416"></a>04416          }
<a name="l04417"></a>04417       }
<a name="l04418"></a>04418       first_in_warp = <span class="keyword">true</span>;
<a name="l04419"></a>04419    }
<a name="l04420"></a>04420 }
<a name="l04421"></a>04421 
<a name="l04422"></a><a class="code" href="instructions_8cc.html#aa13f002f0c0b7eecbdc1e8567c844c5a">04422</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#aa13f002f0c0b7eecbdc1e8567c844c5a">xor_impl</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> *pI, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread ) 
<a name="l04423"></a>04423 { 
<a name="l04424"></a>04424    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> src1_data, src2_data, data;
<a name="l04425"></a>04425 
<a name="l04426"></a>04426    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;dst  = pI-&gt;<a class="code" href="classptx__instruction.html#a4cc1761a7c6d58c43e86f3266f42da43">dst</a>();
<a name="l04427"></a>04427    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src1 = pI-&gt;<a class="code" href="classptx__instruction.html#a9f4f1af4e2dbebd08549c518a1749ab0">src1</a>();
<a name="l04428"></a>04428    <span class="keyword">const</span> <a class="code" href="classoperand__info.html">operand_info</a> &amp;src2 = pI-&gt;<a class="code" href="classptx__instruction.html#af1abcd41d119a1fa6c3d6187237d9e4d">src2</a>();
<a name="l04429"></a>04429 
<a name="l04430"></a>04430    <span class="keywordtype">unsigned</span> i_type = pI-&gt;<a class="code" href="classptx__instruction.html#a7266fb6774c9f05108fe9f128c56d7ab">get_type</a>();
<a name="l04431"></a>04431    src1_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src1, dst, i_type, thread, 1);
<a name="l04432"></a>04432    src2_data = thread-&gt;<a class="code" href="classptx__thread__info.html#a47ef4d5d837085d62079c8da39212c2c">get_operand_value</a>(src2, dst, i_type, thread, 1);
<a name="l04433"></a>04433 
<a name="l04434"></a>04434    <span class="comment">//the way ptxplus handles predicates: 1 = false and 0 = true</span>
<a name="l04435"></a>04435    <span class="keywordflow">if</span>(i_type == PRED_TYPE)
<a name="l04436"></a>04436       data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a> = ~(~(src1_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>) ^ ~(src2_data.<a class="code" href="unionptx__reg__t.html#afdb1e82430060531691f1fec6855ca28">pred</a>));
<a name="l04437"></a>04437    <span class="keywordflow">else</span>
<a name="l04438"></a>04438       data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = src1_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> ^ src2_data.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>;
<a name="l04439"></a>04439 
<a name="l04440"></a>04440    thread-&gt;<a class="code" href="classptx__thread__info.html#a6c63d090bd0c17b507379f847bd487fe">set_operand_value</a>(dst,data, i_type, thread, pI);
<a name="l04441"></a>04441 }
<a name="l04442"></a>04442 
<a name="l04443"></a><a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">04443</a> <span class="keywordtype">void</span> <a class="code" href="instructions_8cc.html#a74cd5432caa8143d83fa77d211eb4359">inst_not_implemented</a>( <span class="keyword">const</span> <a class="code" href="classptx__instruction.html">ptx_instruction</a> * pI ) 
<a name="l04444"></a>04444 {
<a name="l04445"></a>04445    printf(<span class="stringliteral">&quot;GPGPU-Sim PTX: ERROR (%s:%u) instruction \&quot;%s\&quot; not (yet) implemented\n&quot;</span>,
<a name="l04446"></a>04446           pI-&gt;<a class="code" href="classptx__instruction.html#a6c318383901e62008f98e8f370f7e202">source_file</a>(), 
<a name="l04447"></a>04447           pI-&gt;<a class="code" href="classptx__instruction.html#aa7417e4758e1dfc4fb5a92030071a040">source_line</a>(), 
<a name="l04448"></a>04448           pI-&gt;<a class="code" href="classptx__instruction.html#a9860d06fab0fb973656387b24bbcd9e5">get_opcode_cstr</a>() );
<a name="l04449"></a>04449    abort();
<a name="l04450"></a>04450 }
<a name="l04451"></a>04451 
<a name="l04452"></a><a class="code" href="instructions_8cc.html#a6e3b760edf8ec3a5a7cf73c66d9e8e38">04452</a> <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> <a class="code" href="instructions_8cc.html#a6e3b760edf8ec3a5a7cf73c66d9e8e38">srcOperandModifiers</a>(<a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> opData, <a class="code" href="classoperand__info.html">operand_info</a> opInfo, <a class="code" href="classoperand__info.html">operand_info</a> dstInfo, <span class="keywordtype">unsigned</span> type, <a class="code" href="classptx__thread__info.html">ptx_thread_info</a> *thread)
<a name="l04453"></a>04453 {
<a name="l04454"></a>04454    <a class="code" href="unionptx__reg__t.html">ptx_reg_t</a> result;
<a name="l04455"></a>04455    <a class="code" href="classmemory__space.html">memory_space</a> *mem = NULL;
<a name="l04456"></a>04456    <span class="keywordtype">size_t</span> size;
<a name="l04457"></a>04457    <span class="keywordtype">int</span> t;
<a name="l04458"></a>04458    result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>=0;
<a name="l04459"></a>04459 
<a name="l04460"></a>04460    <span class="comment">//complete other cases for reading from memory, such as reading from other const memory</span>
<a name="l04461"></a>04461    <span class="keywordflow">if</span>(opInfo.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cade54d01d283e68c3e9c5b8d75b85e49e">global_space</a>)
<a name="l04462"></a>04462    {
<a name="l04463"></a>04463        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab2b214414769f3a7422e2e7a1642bf74">get_global_memory</a>();
<a name="l04464"></a>04464        <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(type,size,t);
<a name="l04465"></a>04465        mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(opData.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,size/8,&amp;result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l04466"></a>04466        <span class="keywordflow">if</span>( type == S16_TYPE || type == S32_TYPE ) 
<a name="l04467"></a>04467          <a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">sign_extend</a>(result,size,dstInfo);
<a name="l04468"></a>04468    }
<a name="l04469"></a>04469    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(opInfo.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58cae27eca92c2d1dbb9adb9010e3fb7991c">shared_space</a>)
<a name="l04470"></a>04470    {
<a name="l04471"></a>04471        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#a7c4af02df5c97e1e2d89f2475bf8df8f">m_shared_mem</a>;
<a name="l04472"></a>04472        <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(type,size,t);
<a name="l04473"></a>04473        mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>(opData.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a>,size/8,&amp;result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l04474"></a>04474 
<a name="l04475"></a>04475        <span class="keywordflow">if</span>( type == S16_TYPE || type == S32_TYPE ) 
<a name="l04476"></a>04476          <a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">sign_extend</a>(result,size,dstInfo);
<a name="l04477"></a>04477 
<a name="l04478"></a>04478    }
<a name="l04479"></a>04479    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(opInfo.<a class="code" href="classoperand__info.html#a568af0c2f1e4af887aca4bcdca868bd3">get_addr_space</a>() == <a class="code" href="abstract__hardware__model_8h.html#a1ad2169aaa8924fcc552447f38a5b58ca445236c52ac314c07392ad430f155071">const_space</a>)
<a name="l04480"></a>04480    {
<a name="l04481"></a>04481        mem = thread-&gt;<a class="code" href="classptx__thread__info.html#ab2b214414769f3a7422e2e7a1642bf74">get_global_memory</a>();
<a name="l04482"></a>04482        <a class="code" href="classtype__info__key.html#a92d2640bdd38c080581f06f8d723426d">type_info_key::type_decode</a>(type,size,t);
<a name="l04483"></a>04483 
<a name="l04484"></a>04484        mem-&gt;<a class="code" href="classmemory__space.html#ae1b293a67d5cebb90d3df4482c83f3a1">read</a>((opData.<a class="code" href="unionptx__reg__t.html#a7a2f884106878710cd8de0dfcf44ae3c">u32</a> + opInfo.<a class="code" href="classoperand__info.html#ab0ba78d0b43f839d41a6081ee897d171">get_const_mem_offset</a>()),size/8,&amp;result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>);
<a name="l04485"></a>04485 
<a name="l04486"></a>04486        <span class="keywordflow">if</span>( type == S16_TYPE || type == S32_TYPE ) 
<a name="l04487"></a>04487          <a class="code" href="instructions_8cc.html#ab19c69c588b054da5f8d01b350d1b07c">sign_extend</a>(result,size,dstInfo);
<a name="l04488"></a>04488    }
<a name="l04489"></a>04489    <span class="keywordflow">else</span>
<a name="l04490"></a>04490    {
<a name="l04491"></a>04491        result = opData;
<a name="l04492"></a>04492    }
<a name="l04493"></a>04493 
<a name="l04494"></a>04494    <span class="keywordflow">if</span>(opInfo.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 1)
<a name="l04495"></a>04495    {
<a name="l04496"></a>04496         result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> &amp; 0xFFFF;
<a name="l04497"></a>04497    }
<a name="l04498"></a>04498    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(opInfo.<a class="code" href="classoperand__info.html#af9cd63b1fe30695c26d86c9bd917c161">get_operand_lohi</a>() == 2)
<a name="l04499"></a>04499    {
<a name="l04500"></a>04500         result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a> = (result.<a class="code" href="unionptx__reg__t.html#a1e1ac1da13de4bf7a6eefef4982df7ce">u64</a>&gt;&gt;16) &amp; 0xFFFF;
<a name="l04501"></a>04501    }
<a name="l04502"></a>04502 
<a name="l04503"></a>04503    <span class="keywordflow">if</span>(opInfo.<a class="code" href="classoperand__info.html#a11558a2e5432782a641096c3d7fcb68a">get_operand_neg</a>() == <span class="keyword">true</span>) {
<a name="l04504"></a>04504       result.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a> = -result.<a class="code" href="unionptx__reg__t.html#aaa798a0847a16631f560bbab97eceb2f">f32</a>;
<a name="l04505"></a>04505    }
<a name="l04506"></a>04506 
<a name="l04507"></a>04507    <span class="keywordflow">return</span> result;
<a name="l04508"></a>04508 }
<a name="l04509"></a>04509 
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 8 Apr 2018 for GPGPU-Sim by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
